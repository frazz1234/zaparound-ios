{
  "functions": {
    "api/*.js": {
      "memory": 1024,
      "maxDuration": 10
    }
  },
  "redirects": [
    {
      "source": "/(.*)",
      "has": [
        {
          "type": "host",
          "value": "www.zaparound.com"
        }
      ],
      "permanent": true,
      "destination": "https://zaparound.com/$1"
    }
  ],
  "rewrites": [
    { "source": "/api/:path*", "destination": "/api/:path*.js" },
    { "source": "/manifest.webmanifest", "destination": "/manifest.webmanifest" },
    { "source": "/sw.js", "destination": "/sw.js" },
    { "source": "/:key.txt", "destination": "/api/indexnow-key.js" },

    { "source": "/en/booking/flight-travel.html", "destination": "/en/booking/flight-travel.html" },
    { "source": "/fr/booking/flight-travel.html", "destination": "/fr/booking/flight-travel.html" },
    { "source": "/es/booking/flight-travel.html", "destination": "/es/booking/flight-travel.html" },
    { "source": "/blog", "destination": "/index.html" },
    { "source": "/blog/:slug*", "destination": "/index.html" },
    { "source": "/robots.txt", "destination": "/robots.txt" },
    { "source": "/(.*)", "destination": "/index.html" }
  ],
  "headers": [
    {
      "source": "/:key.txt",
      "headers": [
        {
          "key": "Content-Type",
          "value": "text/plain"
        },
        {
          "key": "Cache-Control",
          "value": "no-cache"
        }
      ]
    },
    {
      "source": "/service-worker.js",
      "headers": [
        {
          "key": "Cache-Control",
          "value": "public, max-age=0, must-revalidate"
        }
      ]
    },

    {
      "source": "/robots.txt",
      "headers": [
        {
          "key": "Content-Type",
          "value": "text/plain"
        },
        {
          "key": "Cache-Control",
          "value": "public, max-age=86400"
        }
      ]
    },
    {
      "source": "/(.*)",
      "headers": [
        {
          "key": "X-Content-Type-Options",
          "value": "nosniff"
        },
        {
          "key": "X-Frame-Options",
          "value": "DENY"
        },
        {
          "key": "X-XSS-Protection",
          "value": "1; mode=block"
        },
        {
          "key": "Referrer-Policy",
          "value": "strict-origin-when-cross-origin"
        },
        {
          "key": "Permissions-Policy",
          "value": "camera=(), microphone=(), geolocation=()"
        },
        {
          "key": "Content-Security-Policy",
          "value": "default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://www.googletagmanager.com https://www.google-analytics.com https://js.hcaptcha.com https://hcaptcha.com https://api.mapbox.com https://events.mapbox.com https://*.emrldtp.com https://emrldtp.com https://www.google.com https://www.gstatic.com https://va.vercel-scripts.com https://sentry.avs.io https://cdn.jsdelivr.net https://widgets.aviasales.com https://*.aviasales.com https://www.aviasales.ru https://*.aviasales.ru https://tpwgts.com https://*.avsplow.com https://avsplow.com http://*.avsplow.com http://avsplow.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://api.mapbox.com https://cdn.jsdelivr.net; font-src 'self' https://fonts.gstatic.com; img-src 'self' data: blob: https:; connect-src 'self' https: wss: https://ynvnzmkpifwteyuxondc.supabase.co https://api.mapbox.com https://events.mapbox.com https://open.er-api.com https://www.google.com https://www.gstatic.com https://*.emrldtp.com https://emrldtp.com https://va.vercel-scripts.com https://sentry.avs.io https://zaparound.app.n8n.cloud https://widgets.aviasales.com https://*.aviasales.com https://www.aviasales.ru https://*.aviasales.ru https://tpwgts.com https://*.avsplow.com https://avsplow.com http://*.avsplow.com http://avsplow.com; frame-src 'self' https://hcaptcha.com https://*.hcaptcha.com https://www.google.com https://widgets.aviasales.com https://*.aviasales.com https://www.aviasales.ru https://*.aviasales.ru https://tpwgts.com https://*.avsplow.com https://avsplow.com http://*.avsplow.com http://avsplow.com; worker-src 'self' blob:; object-src 'none'; base-uri 'self'; form-action 'self';"
        },
        {
          "key": "Alt-Svc",
          "value": "h3=\":443\"; ma=86400"
        },
        {
          "key": "Server-Timing",
          "value": "edge; dur=0"
        }
      ]
    },
    {
      "source": "/index.html",
      "headers": [
        {
          "key": "Cache-Control",
          "value": "public, max-age=0, must-revalidate"
        },
        {
          "key": "Link",
          "value": "</zaparound-uploads/transparentnoliner.webp>; rel=preload; as=image, </assets/css/index.css>; rel=preload; as=style"
        }
      ]
    },
    {
      "source": "/assets/(.*)",
      "headers": [
        {
          "key": "Cache-Control",
          "value": "public, max-age=31536000, immutable"
        },
        {
          "key": "Accept-Encoding",
          "value": "gzip, deflate, br"
        }
      ]
    },
    {
      "source": "/(.*\\.html)",
      "headers": [
        {
          "key": "Cache-Control",
          "value": "public, max-age=0, must-revalidate"
        }
      ]
    },
    {
      "source": "/zaparound-uploads/(.*)",
      "headers": [
        {
          "key": "Cache-Control",
          "value": "public, max-age=31536000, stale-while-revalidate=86400"
        },
        {
          "key": "Accept-Encoding",
          "value": "gzip, deflate, br"
        }
      ]
    },
    {
      "source": "/public/icons/(.*)",
      "headers": [
        {
          "key": "Cache-Control",
          "value": "public, max-age=2592000, immutable"
        }
      ]
    },
    {
      "source": "/api/(.*)",
      "headers": [
        {
          "key": "Cache-Control",
          "value": "public, max-age=300, stale-while-revalidate=600"
        }
      ]
    },
    {
      "source": "/manifest.webmanifest",
      "headers": [
        {
          "key": "Content-Type",
          "value": "application/manifest+json"
        },
        {
          "key": "Cache-Control",
          "value": "public, max-age=3600, stale-while-revalidate=600"
        }
      ]
    }
  ],
  "images": {
    "sizes": [640, 750, 828, 1080, 1200, 1920, 2048, 3840],
    "domains": ["zaparound.com", "www.zaparound.com"],
    "formats": ["image/webp", "image/avif"],
    "minimumCacheTTL": 86400
  }
}
