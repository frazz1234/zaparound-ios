import{_ as t,a as e}from"./vendor---babel-runtime.29jaxZcp.js";import{r as a}from"./vendor-react-core.D1hcyiwY.js";import{x as i}from"./vendor---hcaptcha-loader.BERPTLmz.js";function n(t){var e=t&&t.ownerDocument||document;return{document:e,window:e.defaultView||e.parentWindow||window}}function h(t){return t||document.head}var s=function(s){function r(t){var i;return(i=s.call(this,t)||this)._hcaptcha=void 0,i.renderCaptcha=i.renderCaptcha.bind(e(i)),i.resetCaptcha=i.resetCaptcha.bind(e(i)),i.removeCaptcha=i.removeCaptcha.bind(e(i)),i.isReady=i.isReady.bind(e(i)),i._onReady=null,i.loadCaptcha=i.loadCaptcha.bind(e(i)),i.handleOnLoad=i.handleOnLoad.bind(e(i)),i.handleSubmit=i.handleSubmit.bind(e(i)),i.handleExpire=i.handleExpire.bind(e(i)),i.handleError=i.handleError.bind(e(i)),i.handleOpen=i.handleOpen.bind(e(i)),i.handleClose=i.handleClose.bind(e(i)),i.handleChallengeExpired=i.handleChallengeExpired.bind(e(i)),i.ref=a.createRef(),i.apiScriptRequested=!1,i.sentryHub=null,i.captchaId="",i.state={isApiReady:!1,isRemoved:!1,elementId:t.id},i}t(r,s);var c=r.prototype;return c.componentDidMount=function(){var t=this,e=n(h(this.props.scriptLocation));this._hcaptcha=e.window.hcaptcha||void 0,void 0!==this._hcaptcha?this.setState({isApiReady:!0},(function(){t.renderCaptcha()})):this.loadCaptcha()},c.componentWillUnmount=function(){var t=this._hcaptcha,e=this.captchaId;this.isReady()&&(t.reset(e),t.remove(e))},c.shouldComponentUpdate=function(t,e){return this.state.isApiReady===e.isApiReady&&this.state.isRemoved===e.isRemoved},c.componentDidUpdate=function(t){var e=this;["sitekey","size","theme","tabindex","languageOverride","endpoint"].every((function(a){return t[a]===e.props[a]}))||this.removeCaptcha((function(){e.renderCaptcha()}))},c.loadCaptcha=function(){if(!this.apiScriptRequested){var t=this.props,e=t.apihost,a=t.assethost,n=t.endpoint,h=t.host,s=t.imghost,r=t.languageOverride,c=t.reCaptchaCompat,o=t.reportapi,p=t.sentry,d=t.custom,l=t.loadAsync,u=t.scriptLocation,v=t.scriptSource,f=t.secureApi,m=t.cleanup;i({render:"explicit",apihost:e,assethost:a,endpoint:n,hl:r,host:h,imghost:s,recaptchacompat:!1===c?"off":null,reportapi:o,sentry:p,custom:d,loadAsync:l,scriptLocation:u,scriptSource:v,secureApi:f,cleanup:void 0===m||m}).then(this.handleOnLoad,this.handleError).catch(this.handleError),this.apiScriptRequested=!0}},c.renderCaptcha=function(t){var e=this,a=this.props.onReady,i=this.state.isApiReady,n=this.captchaId;if(i&&!n){var h=Object.assign({"open-callback":this.handleOpen,"close-callback":this.handleClose,"error-callback":this.handleError,"chalexpired-callback":this.handleChallengeExpired,"expired-callback":this.handleExpire,callback:this.handleSubmit},this.props,{hl:this.props.hl||this.props.languageOverride,languageOverride:void 0}),s=this._hcaptcha.render(this.ref.current,h);this.captchaId=s,this.setState({isRemoved:!1},(function(){t&&t(),a&&a(),e._onReady&&e._onReady(s)}))}},c.resetCaptcha=function(){var t=this._hcaptcha,e=this.captchaId;this.isReady()&&t.reset(e)},c.removeCaptcha=function(t){var e=this,a=this._hcaptcha,i=this.captchaId;this.isReady()&&this.setState({isRemoved:!0},(function(){e.captchaId="",a.remove(i),t&&t()}))},c.handleOnLoad=function(){var t=this;this.setState({isApiReady:!0},(function(){var e=n(h(t.props.scriptLocation));t._hcaptcha=e.window.hcaptcha,t.renderCaptcha((function(){var e=t.props.onLoad;e&&e()}))}))},c.handleSubmit=function(t){var e=this.props.onVerify,a=this.state.isRemoved,i=this._hcaptcha,n=this.captchaId;if(void 0!==i&&!a){var h=i.getResponse(n),s=i.getRespKey(n);e&&e(h,s)}},c.handleExpire=function(){var t=this.props.onExpire,e=this._hcaptcha,a=this.captchaId;this.isReady()&&(e.reset(a),t&&t())},c.handleError=function(t){var e=this.props.onError,a=this._hcaptcha,i=this.captchaId;this.isReady()&&a.reset(i),e&&e(t)},c.isReady=function(){var t=this.state,e=t.isApiReady,a=t.isRemoved;return e&&!a},c.handleOpen=function(){this.isReady()&&this.props.onOpen&&this.props.onOpen()},c.handleClose=function(){this.isReady()&&this.props.onClose&&this.props.onClose()},c.handleChallengeExpired=function(){this.isReady()&&this.props.onChalExpired&&this.props.onChalExpired()},c.execute=function(t){var e=this;void 0===t&&(t=null),t="object"==typeof t?t:null;try{var a=this._hcaptcha,i=this.captchaId;if(!this.isReady()){var n,h=new Promise((function(a,i){e._onReady=function(n){try{var h=e._hcaptcha;t&&t.async?h.execute(n,t).then(a).catch(i):a(h.execute(n,t))}catch(s){i(s)}}}));return null!=(n=t)&&n.async?h:null}return a.execute(i,t)}catch(s){return t&&t.async?Promise.reject(s):null}},c.close=function(){var t=this._hcaptcha,e=this.captchaId;if(this.isReady())return t.close(e)},c.setData=function(t){var e=this._hcaptcha,a=this.captchaId;this.isReady()&&(t&&"object"!=typeof t&&(t=null),e.setData(a,t))},c.getResponse=function(){return this._hcaptcha.getResponse(this.captchaId)},c.getRespKey=function(){return this._hcaptcha.getRespKey(this.captchaId)},c.render=function(){var t=this.state.elementId;return a.createElement("div",{ref:this.ref,id:t})},r}(a.Component);export{s as H};
//# sourceMappingURL=vendor---hcaptcha-react-hcaptcha.BYNRmVb_.js.map
