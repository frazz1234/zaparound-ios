import{r as e,j as s}from"../vendor/vendor-react-core.D1hcyiwY.js";import{s as a}from"../components/components-admin.CiIAoamg.js";import{B as t,C as i,m as n,V as l,a3 as c,k as r,l as o,R as m}from"../components/components-ui.C8hnNhgu.js";import{u as d}from"../hooks/hooks-use-toast.ts.Dg8obzHg.js";import{u as x}from"../vendor/vendor--react-i18next.DhHVfoav.js";import{P as h,M as g,A as j,aw as f,f as N,at as b,u,j as p,z as y,h as v,ax as k}from"../vendor/vendor--lucide-react.DRw9PYsu.js";import{u as w,a as _}from"../vendor/vendor--react-router.Gdfmkz0l.js";import{f as D}from"../vendor/vendor--date-fns.BbAlDtqN.js";import{E as F}from"../components/components-bookings.q58dYAlO.js";function C(){const{t:c,i18n:r}=x("zapbooking"),o=w(),{toast:m}=d(),[b,u]=e.useState([]),[p,y]=e.useState(!0);e.useEffect((()=>{v()}),[]);const v=async()=>{try{y(!0);const{data:e,error:s}=await a.from("bookings").select("*").order("created_at",{ascending:!1});if(s)throw s;u(e||[])}catch(e){m({title:c("error"),description:c("failedToLoadBookings"),variant:"destructive"})}finally{y(!1)}},k=e=>{try{const s=new Date(e);return isNaN(s.getTime())?"N/A":D(s,"MMM d, yyyy")}catch(s){return"N/A"}};return p?s.jsx("div",{className:"container mx-auto px-4 py-8",children:s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#72ba87]"})})}):s.jsx("div",{className:"container mx-auto px-4 py-8",children:s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsxs("div",{className:"flex justify-between items-center mb-8",children:[s.jsx("h1",{className:"text-3xl font-bold",children:c("myBookings")}),s.jsx(t,{className:"bg-[#72ba87] hover:bg-[#61936f] text-white",onClick:()=>o(`/${r.language}/booking/internal-flights`),children:c("bookNewFlight")})]}),0===b.length?s.jsx(i,{children:s.jsxs(n,{className:"flex flex-col items-center justify-center py-12",children:[s.jsx(h,{className:"w-12 h-12 text-gray-400 mb-4"}),s.jsx("h3",{className:"text-xl font-semibold mb-2",children:c("noBookingsFound")}),s.jsx("p",{className:"text-gray-500 mb-4",children:c("noBookingsMessage")}),s.jsx(t,{className:"bg-[#72ba87] hover:bg-[#61936f] text-white",onClick:()=>o(`/${r.language}/booking/internal-flights`),children:c("bookFirstFlight")})]})}):s.jsx("div",{className:"space-y-4",children:b.map((e=>s.jsx(i,{className:"hover:shadow-md transition-shadow cursor-pointer",onClick:()=>o(`/${r.language}/bookings/${e.booking_reference}`),children:s.jsx(n,{className:"p-6",children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[s.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:s.jsx(h,{className:"w-5 h-5 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-semibold text-lg",children:e.booking_reference}),s.jsxs("p",{className:"text-sm text-gray-500",children:[c("bookedOn")," ",k(e.created_at)]})]})]}),e.flight_data?.slices?.[0]&&s.jsxs("div",{className:"flex items-center space-x-4 mb-3",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(g,{className:"w-4 h-4 text-gray-400"}),s.jsx("span",{className:"font-medium",children:e.flight_data.slices[0].origin?.iata_code}),s.jsx(j,{className:"w-4 h-4 text-gray-400"}),s.jsx("span",{className:"font-medium",children:e.flight_data.slices[0].destination?.iata_code})]}),s.jsx("span",{className:"text-sm text-gray-500",children:k(e.flight_data.slices[0].segments[0]?.departing_at)})]}),s.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(f,{className:"w-4 h-4"}),s.jsxs("span",{children:[e.passengers.length," ",1===e.passengers.length?c("passenger"):c("passengers")]})]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(N,{className:"w-4 h-4"}),s.jsx("span",{children:c(`bookingTypes.${e.booking_type}`)})]})]})]}),s.jsxs("div",{className:"flex flex-col items-end space-y-2",children:[s.jsx(l,{variant:"confirmed"===e.status?"default":"secondary",className:"confirmed"===e.status?"bg-[#72ba87] text-white":"",children:c(`bookingStatus.${e.status}`)}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"text-lg font-semibold",children:[e.total_amount," ",e.currency]}),s.jsx("p",{className:"text-sm text-gray-500",children:c("total")})]}),s.jsx(j,{className:"w-4 h-4 text-gray-400"})]})]})})},e.id)))})]})})}function T(){const{t:j,i18n:N}=x("zapbooking"),C=w(),{bookingReference:T}=_(),{toast:B}=d(),[$,A]=e.useState(null),[M,S]=e.useState(!0),[z,E]=e.useState(!1);e.useEffect((()=>{T&&L()}),[T]);const L=async()=>{try{S(!0);const{data:e,error:s}=await a.from("bookings").select("*").eq("booking_reference",T).single();if(s)throw s;A(e)}catch(e){B({title:j("error"),description:j("failedToLoadBookings"),variant:"destructive"})}finally{S(!1)}},O=e=>{try{const s=new Date(e);return isNaN(s.getTime())?"N/A":D(s,"HH:mm")}catch(s){return"N/A"}},R=e=>{try{const s=new Date(e);return isNaN(s.getTime())?"N/A":D(s,"MMM d, yyyy")}catch(s){return"N/A"}};return M?s.jsx("div",{className:"container mx-auto px-4 py-8",children:s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#72ba87]"})})}):$?s.jsxs("div",{className:"container mx-auto px-4 py-8",children:[s.jsxs("div",{className:"max-w-4xl mx-auto",children:[s.jsxs("div",{className:"flex items-center justify-between mb-8",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs(t,{variant:"ghost",size:"sm",onClick:()=>C(`/${N.language}/bookings`),className:"text-[#1d1d1e] hover:text-[#61936f]",children:[s.jsx(u,{className:"h-4 w-4 mr-2"}),j("bookingDetails.backToBookings")]}),s.jsx(c,{orientation:"vertical",className:"h-6"}),s.jsx("h1",{className:"text-3xl font-bold",children:j("bookingDetails.bookingDetails")})]}),s.jsxs("div",{className:"flex space-x-2",children:[s.jsxs(t,{variant:"outline",onClick:()=>E(!0),children:[s.jsx(p,{className:"w-4 h-4 mr-2"}),j("bookingDetails.sendByEmail")]}),s.jsxs(t,{variant:"outline",onClick:async()=>{try{B({title:j("comingSoonTitle"),description:j("pdfDownloadComingSoon")})}catch(e){B({title:j("error"),description:j("failedToDownloadConfirmation"),variant:"destructive"})}},children:[s.jsx(y,{className:"w-4 h-4 mr-2"}),j("bookingDetails.downloadConfirmation")]})]})]}),s.jsx(i,{className:"mb-6",children:s.jsx(r,{children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsx(o,{className:"text-2xl",children:$.booking_reference}),s.jsxs(m,{children:[j("bookingDetails.bookedOn")," ",R($.created_at)," • ",j(`bookingTypes.${$.booking_type}`)," ",j("bookingDetails.bookingType")]})]}),s.jsxs("div",{className:"flex flex-col items-end space-y-2",children:[s.jsx(l,{variant:"confirmed"===$.status?"default":"secondary",className:"confirmed"===$.status?"bg-[#72ba87] text-white":"",children:j(`bookingStatus.${$.status}`)}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"text-2xl font-bold",children:[$.total_amount," ",$.currency]}),s.jsx("p",{className:"text-sm text-gray-500",children:j("bookingDetails.totalAmountLabel")})]})]})]})})}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsx("div",{className:"lg:col-span-2",children:s.jsxs(i,{children:[s.jsx(r,{children:s.jsxs(o,{className:"flex items-center",children:[s.jsx(h,{className:"w-5 h-5 mr-2"}),j("bookingDetails.flightDetails")]})}),s.jsx(n,{children:$.flight_data?.slices?.map(((e,a)=>s.jsxs("div",{children:[a>0&&s.jsx(c,{className:"my-6"}),s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3",children:s.jsx(h,{className:"w-4 h-4 text-blue-600"})}),s.jsxs("div",{children:[s.jsxs("p",{className:"font-medium text-lg",children:[e.origin?.iata_code," → ",e.destination?.iata_code]}),s.jsx("p",{className:"text-sm text-gray-500",children:R(e.segments[0]?.departing_at)})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"font-medium",children:e.segments[0]?.marketing_carrier?.name}),s.jsxs("p",{className:"text-sm text-gray-500",children:["Flight ",e.segments[0]?.marketing_carrier?.iata_code]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[s.jsxs("div",{className:"flex items-center mb-2",children:[s.jsx(v,{className:"w-4 h-4 mr-2 text-gray-500"}),s.jsx("p",{className:"text-sm font-medium text-gray-700",children:j("bookingDetails.departure")})]}),s.jsx("p",{className:"text-lg font-semibold",children:O(e.segments[0]?.departing_at)}),s.jsx("p",{className:"text-sm",children:e.origin?.name}),e.segments[0]?.origin_terminal&&s.jsxs("p",{className:"text-sm text-gray-500",children:[j("bookingDetails.terminal")," ",e.segments[0].origin_terminal]})]}),s.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[s.jsxs("div",{className:"flex items-center mb-2",children:[s.jsx(g,{className:"w-4 h-4 mr-2 text-gray-500"}),s.jsx("p",{className:"text-sm font-medium text-gray-700",children:j("bookingDetails.arrival")})]}),s.jsx("p",{className:"text-lg font-semibold",children:O(e.segments[0]?.arriving_at)}),s.jsx("p",{className:"text-sm",children:e.destination?.name}),e.segments[0]?.destination_terminal&&s.jsxs("p",{className:"text-sm text-gray-500",children:[j("bookingDetails.terminal")," ",e.segments[0].destination_terminal]})]})]})]},a)))})]})}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs(i,{children:[s.jsx(r,{children:s.jsxs(o,{className:"flex items-center",children:[s.jsx(f,{className:"w-5 h-5 mr-2"}),j("bookingDetails.passengers")," (",$.passengers.length,")"]})}),s.jsx(n,{children:s.jsx("div",{className:"space-y-3",children:$.passengers.map(((e,a)=>s.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[s.jsxs("p",{className:"font-medium",children:[e.title," ",e.given_name," ",e.family_name]}),s.jsx("p",{className:"text-sm text-gray-500",children:e.email}),s.jsx("p",{className:"text-sm text-gray-500",children:e.phone_number}),s.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[s.jsxs("span",{children:[j("bookingDetails.gender"),": ","m"===e.gender?j("bookingDetails.male"):j("bookingDetails.female")]}),s.jsxs("span",{children:[j("bookingDetails.born"),": ",R(e.born_on)]})]})]},a)))})})]}),s.jsxs(i,{children:[s.jsx(r,{children:s.jsxs(o,{className:"flex items-center",children:[s.jsx(k,{className:"w-5 h-5 mr-2"}),j("bookingDetails.financialDetails")]})}),s.jsx(n,{children:s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:j("bookingDetails.baseFare")}),s.jsxs("span",{className:"font-medium",children:[$.base_amount.toFixed(2)," ",$.currency]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:j("bookingDetails.taxesFees")}),s.jsxs("span",{className:"font-medium",children:[($.total_amount-$.base_amount-$.luggage_fees-$.ancillaries_fees).toFixed(2)," ",$.currency]})]}),$.luggage_fees>0&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:j("bookingDetails.luggageFees")}),s.jsxs("span",{className:"font-medium",children:[$.luggage_fees," ",$.currency]})]}),$.ancillaries_fees>0&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-gray-600",children:j("bookingDetails.ancillariesFees")}),s.jsxs("span",{className:"font-medium",children:[$.ancillaries_fees," ",$.currency]})]}),s.jsx(c,{}),s.jsxs("div",{className:"flex justify-between text-lg font-semibold",children:[s.jsx("span",{children:j("bookingDetails.totalAmount")}),s.jsxs("span",{children:[$.total_amount," ",$.currency]})]})]})})]}),$.duffel_booking_reference&&s.jsxs(i,{children:[s.jsx(r,{children:s.jsxs(o,{className:"flex items-center",children:[s.jsx(b,{className:"w-5 h-5 mr-2"}),j("bookingDetails.bookingReferences")]})}),s.jsx(n,{children:s.jsx("div",{className:"space-y-3",children:s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-gray-500",children:j("reference")}),s.jsx("p",{className:"font-medium text-sm",children:$.duffel_booking_reference})]})})})]})]})]})]}),$&&s.jsx(F,{isOpen:z,onClose:()=>E(!1),bookingData:$})]}):s.jsx("div",{className:"container mx-auto px-4 py-8",children:s.jsx("div",{className:"max-w-4xl mx-auto",children:s.jsx(i,{children:s.jsxs(n,{className:"flex flex-col items-center justify-center py-12",children:[s.jsx(b,{className:"w-12 h-12 text-gray-400 mb-4"}),s.jsx("h3",{className:"text-xl font-semibold mb-2",children:j("bookingDetails.bookingNotFound")}),s.jsx("p",{className:"text-gray-500 mb-4",children:j("bookingDetails.bookingNotFoundMessage")}),s.jsx(t,{className:"bg-[#72ba87] hover:bg-[#61936f] text-white",onClick:()=>C(`/${N.language}/bookings`),children:j("bookingDetails.backToBookings")})]})})})})}export{C as B,T as a};
//# sourceMappingURL=page-bookings.8IdCr-gn.js.map
