import{r as e,j as t}from"../vendor/vendor-react-core.D1hcyiwY.js";import{L as s,P as r,G as a,M as i,a as o,b as n}from"../components/components-community.DdS-HWu3.js";import{B as l,aT as d,D as c,f as m,g as p,j as u,G as h,J as v,K as x,M as g,z as j,aj as f}from"../components/components-ui.C8hnNhgu.js";import{s as y}from"../components/components-admin.CiIAoamg.js";import{u as b}from"../hooks/hooks-use-toast.ts.Dg8obzHg.js";import{c as w}from"../components/components-blog.C3TFiFB1.js";import{c as _}from"../utils/utils-placeutils.ts.vo-R8UHO.js";import{F as N}from"../utils/utils-feedalgorithm.ts.MbBzcL8m.js";import{u as k}from"../vendor/vendor--react-i18next.DhHVfoav.js";import{m as C,A as S}from"../vendor/vendor--framer-motion.Dpgjd5L1.js";import{ae as $,C as P,bp as U,$ as F,L as q,M,a8 as z,U as T,i as L,ac as B,bq as E,br as R,T as D,bs as A,H as I,bt as W,Y,bd as H,bu as O}from"../vendor/vendor--lucide-react.DRw9PYsu.js";import{u as Z}from"../vendor/vendor--react-router.Gdfmkz0l.js";import"../vendor/vendor--cookie.D-6orQ43.js";import"../vendor/vendor--date-fns.BbAlDtqN.js";import"../vendor/vendor-ui-toast.CyvsGWN1.js";import"../vendor/vendor-react-dom.BnDkh-2X.js";import"../vendor/vendor-react-scheduler.B5Ht9ZB3.js";import"../vendor/vendor-ui-core.CPnW5LH0.js";import"../vendor/vendor--aria-hidden.BHUiN-rI.js";import"../vendor/vendor--react-remove-scroll.DR6iVcCg.js";import"../vendor/vendor--tslib.Bc9CN1Ef.js";import"../vendor/vendor--react-remove-scroll-bar.Dz-JErv0.js";import"../vendor/vendor--react-style-singleton.ER5nEGYx.js";import"../vendor/vendor--get-nonce.BYiZHLe3.js";import"../vendor/vendor--use-sidecar.svB0tWl8.js";import"../vendor/vendor--use-callback-ref.Dt9orvWx.js";import"../vendor/vendor---floating-ui-react-dom.gDT63CuY.js";import"../vendor/vendor---floating-ui-dom.CdGDzP9A.js";import"../vendor/vendor---floating-ui-core.D6mclMLM.js";import"../vendor/vendor---floating-ui-utils.D9HCu73I.js";import"../vendor/vendor-ui-dialog.CY7OxuK6.js";import"../vendor/vendor-ui-utils.CjDQ2U02.js";import"../vendor/vendor-ui-tooltip.n7I39vTs.js";import"../vendor/vendor--embla-carousel-react.Bc6nB0ya.js";import"../vendor/vendor--embla-carousel-reactive-utils.BIRN7lq8.js";import"../vendor/vendor--embla-carousel.clUl8sxa.js";import"../vendor/vendor--cmdk.q6oiTfmV.js";import"../vendor/vendor--react-day-picker.D6HWAs9M.js";import"../vendor/vendor--react-hook-form.C68mK_Ba.js";import"../vendor/vendor---hookform-resolvers.CwYzTTZs.js";import"../vendor/vendor--zod.Cebk8UiH.js";import"../vendor/vendor-supabase-client.BJD0U0P8.js";import"../vendor/vendor-supabase-other.BhmW1H_P.js";import"../components/components-mobilenavigation.tsx.DtMtI5i3.js";import"../components/components-languagerouter.tsx.CHVsY7fH.js";import"../vendor/vendor--i18next.CHTa0CEF.js";import"../vendor/vendor--i18next-browser-languagedetector.h4x3AYwK.js";import"../vendor/vendor--i18next-http-backend.DjHzioAf.js";import"../hooks/hooks-useuserrole.ts.BKHSjdY6.js";import"../components/components-languageselector.tsx.x8buceJ0.js";import"../components/components-navigation.CB-8LlfF.js";import"../components/components-theme-toggle.tsx.CfzjOSrj.js";import"../components/components-theme-provider.tsx.Cd7zUHTE.js";import"../vendor/vendor-supabase-realtime.PMyDaGD3.js";import"../vendor/vendor--sonner.ECaEf7Ie.js";import"../hooks/hooks-useadminauth.ts.BJ7uhFTt.js";import"../utils/utils-blogutils.ts.CpQs8y27.js";import"../utils/utils-cache.ts.BtmNadnX.js";import"../vendor/vendor--lru-cache.CYB7PIxo.js";import"../components/components-optimizedimage.tsx.DVN-Ynzu.js";import"../hooks/hooks-useblogs.ts.B-jKAetY.js";import"../vendor/vendor-query-main.DFU6mXji.js";import"../vendor/vendor---tanstack-query-core.CIZi0Zbo.js";import"../vendor/vendor--lodash.D80NHDHN.js";import"../vendor/vendor--react-markdown.C_e4o-CH.js";import"../vendor/vendor--devlop.Cl3hj7Sz.js";import"../vendor/vendor--unified.ti5-l0IV.js";import"../vendor/vendor--bail.gCPcOVbC.js";import"../vendor/vendor--extend.BFvm699q.js";import"../vendor/vendor--is-plain-obj.DeEdtHJQ.js";import"../vendor/vendor--trough.zzWXwSIo.js";import"../vendor/vendor--vfile.Cn6Vy3Ir.js";import"../vendor/vendor--vfile-message.Re42m5o3.js";import"../vendor/vendor--unist-util-stringify-position.CvSG9YTx.js";import"../vendor/vendor--remark-parse.DdoJrvcY.js";import"../vendor/vendor--mdast-util-from-markdown.DI8nvaYJ.js";import"../vendor/vendor--micromark-util-decode-numeric-character-reference.DA7xEauU.js";import"../vendor/vendor--micromark-util-decode-string.BCF2SQ7o.js";import"../vendor/vendor--decode-named-character-reference.C-EXV6yX.js";import"../vendor/vendor--micromark-util-normalize-identifier.CzKtq1sx.js";import"../vendor/vendor--micromark.aJPyxAJv.js";import"../vendor/vendor--micromark-util-combine-extensions.CQDa_SAq.js";import"../vendor/vendor--micromark-util-chunked.3k3e5hER.js";import"../vendor/vendor--micromark-factory-space.CZc9TqN4.js";import"../vendor/vendor--micromark-util-character.DUwsRT9L.js";import"../vendor/vendor--micromark-core-commonmark.yO25BTZZ.js";import"../vendor/vendor--micromark-util-classify-character.x6FlXUUS.js";import"../vendor/vendor--micromark-util-resolve-all.U8fstr8o.js";import"../vendor/vendor--micromark-util-subtokenize.BfHYzAYP.js";import"../vendor/vendor--micromark-factory-destination.pZKs7oL9.js";import"../vendor/vendor--micromark-factory-label.BbusvwMx.js";import"../vendor/vendor--micromark-factory-title.BBtcOUHM.js";import"../vendor/vendor--micromark-factory-whitespace.BhZ6YKME.js";import"../vendor/vendor--micromark-util-html-tag-name.DbKNfynz.js";import"../vendor/vendor--mdast-util-to-string.Ck87fAyN.js";import"../vendor/vendor--remark-rehype.B9Xnklpv.js";import"../vendor/vendor--mdast-util-to-hast.C2F2cLDR.js";import"../vendor/vendor---ungap-structured-clone.DadG6O39.js";import"../vendor/vendor--micromark-util-sanitize-uri.BXHzaaAi.js";import"../vendor/vendor--unist-util-position.CVUg9P9R.js";import"../vendor/vendor--trim-lines.C03Dth7Y.js";import"../vendor/vendor--unist-util-visit.41WSH7so.js";import"../vendor/vendor--unist-util-visit-parents.DAGCrDnu.js";import"../vendor/vendor--unist-util-is.C5Jwnfs7.js";import"../vendor/vendor--hast-util-to-jsx-runtime.BOWXXjuU.js";import"../vendor/vendor--comma-separated-tokens.DIu3lqJt.js";import"../vendor/vendor--property-information.Dc64tFtG.js";import"../vendor/vendor--space-separated-tokens.C97BfSlU.js";import"../vendor/vendor--style-to-js.DQsO4XA8.js";import"../vendor/vendor--style-to-object.DGZeIPGP.js";import"../vendor/vendor--inline-style-parser.BFz9PO4J.js";import"../vendor/vendor--hast-util-whitespace.DlJMGLAz.js";import"../vendor/vendor--estree-util-is-identifier-name.0h9-8Xae.js";import"../vendor/vendor--html-url-attributes.BA_i5Yxb.js";import"../vendor/vendor--react-helmet-async.BMUx00aU.js";import"../vendor/vendor--react-fast-compare.4d-J074I.js";import"../vendor/vendor--invariant.D6mx6rc7.js";import"../vendor/vendor--shallowequal.BwnEDCFe.js";import"../vendor/vendor--web-vitals.C1BoAgs7.js";import"../vendor/vendor--motion-dom.C5KZPrWP.js";import"../vendor/vendor--motion-utils.DAP8mxSY.js";const G=15,J=()=>{const{t:J,i18n:K}=k("community"),Q=Z(),V=K.language,[X,ee]=e.useState("feed"),[te,se]=e.useState("activity"),[re,ae]=e.useState(""),[ie,oe]=e.useState(0),[ne,le]=e.useState([]),[de,ce]=e.useState(null),[me,pe]=e.useState(!0),[ue,he]=e.useState({}),[ve,xe]=e.useState(null),[ge,je]=e.useState(null),[fe,ye]=e.useState(""),[be,we]=e.useState([]),[_e,Ne]=e.useState(""),[ke,Ce]=e.useState(null),[Se,$e]=e.useState(!1),[Pe,Ue]=e.useState(0),[Fe,qe]=e.useState(0),[Me,ze]=e.useState([]),[Te,Le]=e.useState(!1),[Be,Ee]=e.useState(""),[Re,De]=e.useState(null),[Ae,Ie]=e.useState(null),[We,Ye]=e.useState(0),[He,Oe]=e.useState(0),{toast:Ze}=b(),[Ge,Je]=e.useState(1),[Ke,Qe]=e.useState(!0),[Ve,Xe]=e.useState(!1),[et,tt]=e.useState(0),[st,rt]=e.useState(!1),[at,it]=e.useState(new Set),[ot,nt]=e.useState(!1),[lt,dt]=e.useState([]),[ct,mt]=e.useState(!1),[pt,ut]=e.useState(new Set),[ht,vt]=e.useState({}),[xt,gt]=e.useState({}),[jt,ft]=e.useState({}),[yt,bt]=e.useState({}),[wt,_t]=e.useState({}),[Nt,kt]=e.useState([]),[Ct,St]=e.useState(!1),[$t,Pt]=e.useState(!1),Ut=()=>{const e=document.querySelector(".post-creator-section");if(e){const t=e.getBoundingClientRect().top+window.scrollY-80;window.scrollTo({top:t,behavior:"smooth"})}};e.useEffect((()=>{Bt(),Mt(),qt(),zt(),Tt(),Ft(),st&&Lt()}),[st]),e.useEffect((()=>{if(Ae){const e=new N({lat:Ae.lat,lng:Ae.lng});ce(e)}}),[Ae]),e.useEffect((()=>{Ae&&At()}),[Ae]),e.useEffect((()=>{Bt()}),[X]),e.useEffect((()=>{const e=()=>{const e=document.querySelector(".post-creator-section");if(e){const t=e.getBoundingClientRect();Pt(t.bottom<0)}};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)}),[]),e.useEffect((()=>{const e=new IntersectionObserver((e=>{e[0].isIntersecting&&Ke&&!Ve&&Dt()}),{threshold:.1}),t=document.getElementById("load-more-trigger");return t&&e.observe(t),()=>{t&&e.unobserve(t)}}),[Ke,Ve]),e.useEffect((()=>{Se||(je(null),ye(""),we([]),Ne(""),Ce(null))}),[Se]);const Ft=()=>{"geolocation"in navigator&&navigator.geolocation.getCurrentPosition((e=>{Ie({lat:e.coords.latitude,lng:e.coords.longitude})}),(e=>{}),{enableHighAccuracy:!0,timeout:5e3,maximumAge:0})},qt=async()=>{const{data:{user:e}}=await y.auth.getUser();xe(e)},Mt=async()=>{try{const{data:{user:e}}=await y.auth.getUser();if(!e)return;const{data:t,error:s}=await y.from("post_likes").select("post_id").eq("user_id",e.id);if(s)throw s;const r={};t.forEach((e=>{r[e.post_id]=!0})),he(r)}catch(e){}},zt=async()=>{try{const{data:{user:e}}=await y.auth.getUser();if(!e)return;const{data:t,error:s}=await y.from("user_roles").select("role, role2").eq("user_id",e.id).single();if(s)return;rt("admin"===t?.role||"moderator"===t?.role2)}catch(e){}},Tt=async()=>{try{const{data:{user:e}}=await y.auth.getUser();if(!e)return;const{data:t}=await y.from("blocked_users").select("blocked_user_id").eq("blocked_by_id",e.id);t&&it(new Set(t.map((e=>e.blocked_user_id))))}catch(e){}},Lt=async()=>{try{const{data:e,error:t}=await y.from("blocked_users").select("\n          *,\n          blocked_user:profiles!blocked_user_id (\n            username,\n            first_name,\n            last_name,\n            avatar_url\n          ),\n          blocked_by:profiles!blocked_by_id (\n            username,\n            first_name,\n            last_name\n          )\n        ").order("created_at",{ascending:!1});if(t)throw t;dt(e||[])}catch(e){Ze({title:J("errors.general"),description:J("errors.fetchBlockedUsers"),variant:"destructive"})}},Bt=async(e=1,t=!1)=>{1===e?pe(!0):Xe(!0);try{let s=[];if(de)if("feed"===X)s=await de.getFeedPosts(e,G);else if("activities"===X){s=(await de.getFeedPosts(e,30)).filter((e=>"activity"===e.post_type)).slice(0,G)}else"destinations"===X&&(s=await de.getDestinationPosts(e,G));else{let t=y.from("community_posts").select("\n            *,\n            likes:post_likes(count),\n            replies:post_replies(count),\n            profile:profiles!user_id (\n              username,\n              first_name,\n              last_name,\n              avatar_url\n            )\n          ").eq("is_published",!0).order("created_at",{ascending:!1}).range((e-1)*G,e*G-1);"activities"===X?t=t.eq("post_type","activity"):"destinations"===X&&(t=t.eq("post_type","destination"));const{data:r,error:a}=await t;if(a)throw a;s=r||[]}const r=s.filter((e=>!at.has(e.user_id)));le(t?e=>[...e,...r]:r),Qe(r.length===G),Je(e)}catch(s){Ze({title:J("errors.general"),description:J("errors.fetchPosts"),variant:"destructive"})}finally{pe(!1),Xe(!1)}},Et=async e=>{if(!e||0===e.length)return[];try{const{data:{user:t}}=await y.auth.getUser();if(!t)throw new Error("No authenticated user found");const s=[];for(const r of e){const e=r.file.name.split(".").pop(),a=`${t.id}_${Date.now()}_${Math.random().toString(36).substr(2,9)}.${e}`,{data:i,error:o}=await y.storage.from("community-images").upload(a,r.file,{cacheControl:"3600",upsert:!1});if(o)throw o;const{data:{publicUrl:n}}=y.storage.from("community-images").getPublicUrl(a);s.push({id:r.id,url:n,type:r.type,thumbnail:"video"===r.type?r.preview:null})}return s}catch(t){return Ze({title:J("toast.error"),description:J("toast.uploadMediaFailed"),variant:"destructive"}),[]}},Rt=async e=>{try{const{error:t}=await y.from("post_likes").delete().eq("post_id",e);if(t)throw t;const{error:s}=await y.from("post_replies").delete().eq("post_id",e);if(s)throw s;const{error:r}=await y.from("community_posts").delete().eq("id",e);if(r)throw r;le((t=>t.filter((t=>t.id!==e)))),Ze({title:J("toast.success"),description:J("toast.postDeleted")})}catch(t){Ze({title:J("errors.general"),description:J("errors.deletePostFailed"),variant:"destructive"})}},Dt=async()=>{const e=Ge+1;Je(e),await Bt(e,!0)},At=async()=>{if(Ae)try{St(!0);const e=Ae.lat,t=Ae.lng,s=50,r=s/111.32,a=s/(111.32*Math.cos(e*Math.PI/180)),{data:i,error:o}=await y.from("pois").select("\n          *,\n          poi_category:poi_categories(name, image_url)\n        ").gte("lat",e-r).lte("lat",e+r).gte("lng",t-a).lte("lng",t+a).limit(10);if(o)throw o;const n=i.map((s=>{const r=It(e,t,s.lat,s.lng);return{...s,distance:r}})).filter((e=>e.distance<=50)).sort(((e,t)=>e.distance-t.distance));kt(n)}catch(e){kt([])}finally{St(!1)}else kt([])},It=(e,t,s,r)=>{const a=(s-e)*Math.PI/180,i=(r-t)*Math.PI/180,o=Math.sin(a/2)*Math.sin(a/2)+Math.cos(e*Math.PI/180)*Math.cos(s*Math.PI/180)*Math.sin(i/2)*Math.sin(i/2);return 6371*(2*Math.atan2(Math.sqrt(o),Math.sqrt(1-o)))},Wt=async e=>{try{const{data:t,error:s}=await y.from("post_replies").select("\n          *,\n          profile:profiles!post_replies_user_id_fkey (\n            username,\n            first_name,\n            last_name,\n            avatar_url\n          )\n        ").eq("post_id",e).order("created_at",{ascending:!1}).limit(3);if(s)throw s;_t((s=>({...s,[e]:t})))}catch(t){Ze({title:J("errors.general"),description:J("errors.fetchReplies"),variant:"destructive"})}},Yt=e=>{const t=window.location.origin,s=e.id,r=e.location?e.location.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,""):"",a=`/${K.language||"en"}`;return r?`${t}${a}/community/share/${s}/${r}`:`${t}${a}/community/share/${s}`},Ht=async e=>{if(ht[e]?.trim())try{bt((t=>({...t,[e]:!0})));const{data:{user:t}}=await y.auth.getUser();if(!t)return void Ze({title:J("toast.error"),description:J("toast.loginRequiredReply"),variant:"destructive"});let s=[];xt[e]&&xt[e].length>0&&(s=await(async e=>{if(!e||0===e.length)return[];try{const{data:{user:t}}=await y.auth.getUser();if(!t)throw new Error("No authenticated user found");const s=[];for(const r of e){const e=r.file.name.split(".").pop(),a=`${t.id}_${Date.now()}_${Math.random().toString(36).substr(2,9)}.${e}`,{data:i,error:o}=await y.storage.from("community-images").upload(a,r.file,{cacheControl:"3600",upsert:!1});if(o)throw o;const{data:{publicUrl:n}}=y.storage.from("community-images").getPublicUrl(a);s.push({id:r.id,url:n,type:r.type,thumbnail:"video"===r.type?r.preview:null})}return s}catch(r){return Ze({title:J("toast.error"),description:J("toast.uploadMediaFailed"),variant:"destructive"}),[]}})(xt[e]));const{error:r}=await y.from("post_replies").insert([{post_id:e,user_id:t.id,content:ht[e],media_urls:s,rating:jt[e]>0?jt[e]:null}]);if(r)throw r;vt((t=>({...t,[e]:""}))),gt((t=>({...t,[e]:[]}))),ft((t=>({...t,[e]:0}))),await Wt(e),Ze({title:J("toast.success"),description:J("toast.replyPosted")})}catch(t){Ze({title:J("errors.general"),description:J("errors.postReplyFailed"),variant:"destructive"})}finally{bt((t=>({...t,[e]:!1})))}else Ze({title:J("toast.error"),description:J("toast.replyContentEmpty"),variant:"destructive"})};return t.jsx(t.Fragment,{children:t.jsx("div",{className:"min-h-screen bg-gray-50",children:t.jsxs("div",{className:"container max-w-7xl mx-auto px-4 py-8",children:[t.jsx("div",{className:"mb-8",children:t.jsx(s,{})}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[t.jsx("div",{className:"lg:col-span-2 space-y-6",children:t.jsxs(C.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5},className:"bg-white rounded-xl shadow-sm p-6",children:[t.jsxs("h2",{className:"text-2xl font-bold mb-4 flex items-center",children:[t.jsx($,{className:"h-6 w-6 mr-2 text-blue-500"}),J("travelStories")]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"relative border-b pb-6 post-creator-section",children:[!ve&&t.jsx(r,{onConnectClick:()=>{Q(`/${V}/auth?returnTo=/community`)},onSignupClick:()=>{Q(`/${V}/auth?tab=signup&returnTo=/community`)}}),t.jsx(S,{children:ot&&t.jsx(C.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"mb-4 p-4 bg-gray-50 border border-gray-200 rounded-lg",children:t.jsxs("div",{className:"flex items-center text-gray-600",children:[t.jsx(P,{className:"h-5 w-5 mr-2 text-gray-400"}),t.jsx("p",{children:"You are unable to post at this time due to our community policies. Please contact our support team for more information."})]})})}),t.jsxs("div",{className:"mb-3 flex gap-2",children:[t.jsxs(l,{type:"button",variant:"activity"===te?"default":"outline",size:"sm",onClick:()=>se("activity"),className:w("flex items-center gap-2","activity"===te?"bg-orange-500 hover:bg-orange-600 text-white":"border-orange-200 text-orange-600 hover:bg-orange-50"),children:[t.jsx(U,{className:"h-4 w-4"}),J("postTypes.activity")]}),t.jsxs(l,{type:"button",variant:"destination"===te?"default":"outline",size:"sm",onClick:()=>se("destination"),className:w("flex items-center gap-2","destination"===te?"bg-blue-500 hover:bg-blue-600 text-white":"border-blue-200 text-blue-600 hover:bg-blue-50"),children:[t.jsx(F,{className:"h-4 w-4"}),J("postTypes.destination")]})]}),t.jsx("textarea",{value:re,onChange:e=>ae(e.target.value),placeholder:J("activity"===te?"postCreation.activityPlaceholder":"postCreation.destinationPlaceholder"),className:"w-full p-2 border rounded-md",rows:3}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("span",{className:"text-sm font-medium text-gray-700",children:J("rating.rateExperience")}),t.jsx(d,{rating:ie,onRatingChange:oe,size:"md"}),ie>0&&t.jsxs("span",{className:"text-sm text-gray-500",children:[ie," ",J(1!==ie?"rating.stars":"rating.star")]})]}),t.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[t.jsx(a,{value:Be,onChange:(e,t)=>{Ee(e),De(t)},placeholder:J("postCreation.locationPlaceholder"),className:"flex-1",currentLocation:Ae},We),t.jsx(l,{onClick:async()=>{if(re.trim())try{const{data:{user:e}}=await y.auth.getUser();if(!e)return void Ze({title:J("toast.error"),description:J("toast.loginRequired"),variant:"destructive"});const{data:t}=await y.from("blocked_users").select("id").eq("blocked_user_id",e.id).single();if(t)return nt(!0),void setTimeout((()=>nt(!1)),5e3);Le(!0);let s=[];Me.length>0&&(s=await Et(Me));const{data:r,error:a}=await y.from("community_posts").insert([{user_id:e.id,title:"New Post",content:re,media_urls:s,location:Be.trim()||null,place_id:Re?.place_id||null,place_lat:Re?.geometry?.location?.lat||null,place_lng:Re?.geometry?.location?.lng||null,place_types:Re?.types||null,place_rating:Re?.rating||null,place_user_ratings_total:Re?.user_ratings_total||null,post_type:te,rating:ie>0?ie:null,is_published:!0}]).select();if(a)throw a;Ze({title:J("toast.success"),description:J("toast.postPublished")}),ae(""),ze([]),Ee(""),De(null),oe(0),Ye((e=>e+1)),Oe((e=>e+1)),Bt()}catch(e){Ze({title:J("errors.general"),description:J("errors.postFailed"),variant:"destructive"})}finally{Le(!1)}else Ze({title:J("toast.error"),description:J("toast.postContentEmpty"),variant:"destructive"})},disabled:Te,className:w("relative px-6 py-2 bg-gradient-to-r from-[#10B981] to-[#059669] text-white border-none hover:from-[#059669] hover:to-[#047857] hover:scale-105 transition-all duration-300 shadow-lg rounded-full font-medium tracking-wide flex items-center gap-2"),children:Te?t.jsxs(t.Fragment,{children:[t.jsx(q,{className:"h-4 w-4 animate-spin"}),J("postCreation.posting")]}):J("postCreation.postButton")})]}),t.jsx("div",{className:"mt-4",children:t.jsx(i,{onMediaChange:e=>{ze(e)},maxFiles:10,disabled:Te},He)})]}),t.jsxs("div",{className:"sticky top-0 lg:top-16 z-10 bg-white border-b border-gray-200 -mx-6 px-6 py-3 flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2 sm:gap-4 overflow-x-auto whitespace-nowrap pr-2",children:[t.jsxs(l,{variant:"ghost",size:"sm",onClick:()=>ee("feed"),className:w("h-9 px-3 rounded-full text-sm flex items-center transition-all","feed"===X?"bg-[#61936f] text-white sm:bg-gradient-to-r sm:from-[#10B981] sm:to-[#059669] sm:text-white sm:border-none sm:shadow-lg sm:hover:from-[#059669] sm:hover:to-[#047857] sm:hover:scale-105":"bg-transparent text-[#1d1d1e] hover:bg-gray-100"),children:[t.jsx($,{className:"h-4 w-4 mr-1.5"}),J("postTypes.feed")]}),t.jsxs(l,{variant:"ghost",size:"sm",onClick:()=>ee("activities"),className:w("h-9 px-3 rounded-full text-sm flex items-center transition-all","activities"===X?"bg-[#61936f] text-white sm:bg-gradient-to-r sm:from-[#10B981] sm:to-[#059669] sm:text-white sm:border-none sm:shadow-lg sm:hover:from-[#059669] sm:hover:to-[#047857] sm:hover:scale-105":"bg-transparent text-[#1d1d1e] hover:bg-gray-100"),children:[t.jsx(M,{className:"h-4 w-4 mr-1.5"}),J("postTypes.activities")]}),t.jsxs(l,{variant:"ghost",size:"sm",onClick:()=>ee("destinations"),className:w("h-9 px-3 rounded-full text-sm flex items-center transition-all","destinations"===X?"bg-[#61936f] text-white sm:bg-gradient-to-r sm:from-[#10B981] sm:to-[#059669] sm:text-white sm:border-none sm:shadow-lg sm:hover:from-[#059669] sm:hover:to-[#047857] sm:hover:scale-105":"bg-transparent text-[#1d1d1e] hover:bg-gray-100"),children:[t.jsx(z,{className:"h-4 w-4 mr-1.5"}),J("postTypes.destinations")]})]}),$t&&t.jsxs(l,{onClick:Ut,className:"hidden sm:flex bg-gradient-to-r from-[#10B981] to-[#059669] text-white border-none hover:from-[#059669] hover:to-[#047857] hover:scale-105 transition-all duration-300 shadow-lg rounded-full font-medium tracking-wide items-center gap-2",children:[t.jsx($,{className:"h-4 w-4"}),J("postCreation.postButton")]})]}),$t&&t.jsx("div",{className:"sm:hidden",children:t.jsx("div",{className:"fixed right-4 z-[60]",style:{bottom:"calc(6rem + env(safe-area-inset-bottom))"},children:t.jsx(l,{onClick:Ut,disabled:Te,className:"h-12 px-5 rounded-full bg-gradient-to-r from-[#10B981] to-[#059669] text-white border-none shadow-xl hover:from-[#059669] hover:to-[#047857] active:scale-95 transition-all duration-200 flex items-center gap-2","aria-label":J("postCreation.postButton"),children:Te?t.jsxs(t.Fragment,{children:[t.jsx(q,{className:"h-5 w-5 animate-spin"}),J("postCreation.posting")]}):t.jsxs(t.Fragment,{children:[t.jsx($,{className:"h-5 w-5"}),J("postCreation.postButton")]})})})}),me&&t.jsx("div",{className:"text-center py-4",children:t.jsx("p",{children:J("loading.posts")})}),me||0!==ne.length?t.jsxs(t.Fragment,{children:[ne.map((e=>t.jsxs("div",{className:"relative bg-white rounded-2xl shadow-sm p-6 mb-6 border border-gray-100 hover:shadow-md transition-shadow duration-200",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"h-12 w-12 bg-gradient-to-br from-blue-100 to-blue-200 rounded-full flex items-center justify-center shadow-sm overflow-hidden",children:e.profile?.avatar_url?t.jsx("img",{src:y.storage.from("avatars").getPublicUrl(e.profile.avatar_url).data.publicUrl,alt:e.profile.username||`${e.profile.first_name||""} ${e.profile.last_name||""}`.trim()||"User",className:"w-full h-full object-cover",onError:e=>{e.currentTarget.style.display="none",e.currentTarget.parentElement.classList.remove("overflow-hidden")}}):t.jsx(T,{className:"h-6 w-6 text-blue-500"})}),t.jsxs("div",{className:"ml-4",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("p",{className:"font-semibold text-gray-800",children:e.profile?.username||`${e.profile?.first_name||""} ${e.profile?.last_name||""}`.trim()||J("user.anonymous")}),e.post_type&&t.jsx("span",{className:w("px-2 py-1 text-xs font-medium rounded-full","activity"===e.post_type?"bg-orange-100 text-orange-700 border border-orange-200":"bg-blue-100 text-blue-700 border border-blue-200"),children:"activity"===e.post_type?J("postTypes.activity"):J("postTypes.destination")})]}),t.jsxs("p",{className:"text-sm text-gray-500",children:[new Date(e.created_at).toLocaleString(),void 0!==e.distance&&t.jsxs("span",{className:w("ml-2 text-xs",e.distance>1e3?"text-purple-500 font-medium":"text-blue-500"),children:["• ",e.distance>1e3?J("aroundTheWorld"):`${e.distance.toFixed(1)}km`]})]}),e.rating&&t.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[t.jsx(d,{rating:e.rating,size:"sm",readonly:!0}),t.jsxs("span",{className:"text-xs text-gray-500",children:[e.rating," ",1!==e.rating?J("rating.stars"):J("rating.star")]})]})]})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsxs(c,{children:[t.jsx(m,{asChild:!0,children:t.jsx(l,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:bg-gray-100",title:J("postActions.share"),children:t.jsx(L,{className:"h-4 w-4 text-blue-500"})})}),t.jsxs(p,{align:"end",className:"w-48",children:[t.jsxs(u,{onClick:()=>(async e=>{const t=Yt(e),s=J("share.checkFound","Check what I found on ZapAround"),r=(e.content||"").trim(),a=r.length>220?r.substring(0,220)+"...":r,i=`${s}${a?`\n'${a}'`:""}${e.location?`\n${e.location}`:""}\n${t}`;if("undefined"!=typeof navigator&&navigator.share){const s={title:"ZapAround",text:i,url:t};try{if(e.media_urls&&e.media_urls.length>0){const t=e.media_urls.find((e=>"image"===e.type));if(t&&t.url){const e=await fetch(t.url),r=await e.blob(),a=r.type&&r.type.split("/")[1]||"jpg",i=new File([r],`zaparound-share.${a}`,{type:r.type||"image/jpeg"});navigator.canShare&&navigator.canShare({files:[i]})&&(s.files=[i])}}}catch(o){}try{return void(await navigator.share(s))}catch(o){}}try{await navigator.clipboard.writeText(i),Ze({title:J("toast.linkCopied"),description:J("toast.postTextLinkCopied")})}catch(o){const e=document.createElement("textarea");e.value=i,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),Ze({title:J("toast.linkCopied"),description:J("toast.postTextLinkCopied")})}})(e),className:"cursor-pointer",children:[t.jsx(L,{className:"h-4 w-4 mr-2"}),J("postActions.shareWithDevice","Share with device")]}),t.jsxs(u,{onClick:()=>(async e=>{const t=Yt(e);try{await navigator.clipboard.writeText(t),Ze({title:J("toast.linkCopied"),description:J("toast.postLinkCopied")})}catch(s){const e=document.createElement("textarea");e.value=t,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),Ze({title:J("toast.linkCopied"),description:J("toast.postLinkCopied")})}})(e),className:"cursor-pointer",children:[t.jsx(B,{className:"h-4 w-4 mr-2"}),J("postActions.copyLink","Copy link")]})]})]}),(ve?.id===e.user_id||st)&&t.jsxs(c,{children:[t.jsx(m,{asChild:!0,children:t.jsx(l,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:t.jsx(E,{className:"h-4 w-4"})})}),t.jsxs(p,{align:"end",children:[ve?.id===e.user_id&&t.jsxs(t.Fragment,{children:[t.jsxs(u,{onClick:()=>{je(e),ye(e.content),we(e.media_urls||[]),Ne(e.location||""),Ce({place_id:e.place_id,geometry:{location:{lat:e.place_lat,lng:e.place_lng}},types:e.place_types,rating:e.place_rating,user_ratings_total:e.place_user_ratings_total}),Ue((e=>e+1)),qe((e=>e+1)),$e(!0)},children:[t.jsx(R,{className:"h-4 w-4 mr-2"}),J("postActions.edit")]}),t.jsxs(u,{className:"text-red-600",onClick:()=>Rt(e.id),children:[t.jsx(D,{className:"h-4 w-4 mr-2"}),"Delete"]})]}),st&&t.jsxs(t.Fragment,{children:[ve?.id!==e.user_id&&t.jsxs(u,{className:"text-red-600",onClick:()=>Rt(e.id),children:[t.jsx(D,{className:"h-4 w-4 mr-2"}),"Delete Post"]}),ve?.id!==e.user_id&&t.jsxs(u,{className:"text-red-600",onClick:()=>(async e=>{try{const{error:t}=await y.from("blocked_users").insert({blocked_user_id:e,blocked_by_id:ve.id});if(t)throw t;it((t=>new Set([...t,e]))),Ze({title:J("toast.success"),description:J("toast.userBlocked")})}catch(t){Ze({title:J("toast.error"),description:J("toast.blockUserFailed"),variant:"destructive"})}})(e.user_id),disabled:at.has(e.user_id),children:[t.jsx(A,{className:"h-4 w-4 mr-2"}),at.has(e.user_id)?"User Blocked":"Block User"]})]})]})]})]})]}),e.location&&t.jsx(o,{location:e.location,placeId:e.place_id,placeLat:e.place_lat,placeLng:e.place_lng,placeTypes:e.place_types,placeRating:e.place_rating,placeUserRatingsTotal:e.place_user_ratings_total,className:"mb-2"}),t.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 mb-4",children:[t.jsx("p",{className:"text-gray-700 leading-relaxed",children:e.content}),e.media_urls&&e.media_urls.length>0||e.image_url?t.jsx("div",{className:"mt-4",children:t.jsx(n,{media:e.media_urls&&e.media_urls.length>0?e.media_urls:e.image_url,maxPreview:5})}):null]}),t.jsxs("div",{className:"flex gap-4 pt-2",children:[t.jsxs(l,{variant:"ghost",size:"sm",className:"flex items-center rounded-full px-4 "+(ue[e.id]?"text-red-500 hover:bg-red-50":"hover:bg-gray-100"),onClick:()=>(async e=>{try{const{data:{user:t}}=await y.auth.getUser();if(!t)return void Ze({title:J("toast.error"),description:J("toast.loginRequiredLike"),variant:"destructive"});if(ue[e]){const{error:s}=await y.from("post_likes").delete().eq("post_id",e).eq("user_id",t.id);if(s)throw s;he((t=>({...t,[e]:!1}))),le((t=>t.map((t=>t.id===e?{...t,likes:[{count:(t.likes?.[0]?.count||1)-1}]}:t))))}else{const{error:s}=await y.from("post_likes").insert([{post_id:e,user_id:t.id}]);if(s)throw s;he((t=>({...t,[e]:!0}))),le((t=>t.map((t=>t.id===e?{...t,likes:[{count:(t.likes?.[0]?.count||0)+1}]}:t))))}}catch(t){Ze({title:J("toast.error"),description:J("toast.updateLikeFailed"),variant:"destructive"})}})(e.id),children:[t.jsx(I,{className:"h-4 w-4 mr-2 "+(ue[e.id]?"fill-current":"")}),e.likes?.[0]?.count||0," Likes"]}),t.jsxs(l,{variant:"ghost",size:"sm",className:"flex items-center rounded-full px-4 hover:bg-gray-100",onClick:()=>{ut((t=>{const s=new Set(t);return s.has(e.id)?s.delete(e.id):(s.add(e.id),wt[e.id]||Wt(e.id)),s}))},children:[t.jsx(W,{className:"h-4 w-4 mr-2"}),e.replies?.[0]?.count||0," ",J("replies.title")]})]}),pt.has(e.id)&&t.jsxs("div",{className:"mt-4 space-y-4",children:[t.jsxs("div",{className:"space-y-4",children:[t.jsx("textarea",{value:ht[e.id]||"",onChange:t=>vt((s=>({...s,[e.id]:t.target.value}))),placeholder:J("replies.placeholder"),className:"w-full p-2 border rounded-md",rows:2}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("span",{className:"text-sm font-medium text-gray-700",children:J("rating.ratePost")}),t.jsx(d,{rating:jt[e.id]||0,onRatingChange:t=>ft((s=>({...s,[e.id]:t}))),size:"sm"}),(jt[e.id]||0)>0&&t.jsxs("span",{className:"text-sm text-gray-500",children:[jt[e.id]," ",1!==(jt[e.id]||0)?J("rating.stars"):J("rating.star")]})]}),t.jsx(i,{onMediaChange:t=>((e,t)=>{gt((s=>({...s,[t]:e})))})(t,e.id),maxFiles:5,disabled:yt[e.id]}),t.jsx(l,{size:"sm",onClick:()=>Ht(e.id),disabled:yt[e.id],className:w("relative px-4 py-1 bg-gradient-to-r from-[#10B981] to-[#059669] text-white border-none hover:from-[#059669] hover:to-[#047857] hover:scale-105 transition-all duration-300 shadow-lg rounded-full font-medium tracking-wide flex items-center gap-2"),children:yt[e.id]?t.jsxs(t.Fragment,{children:[t.jsx(q,{className:"h-4 w-4 animate-spin"}),"Posting..."]}):"Reply"})]}),t.jsx("div",{className:"space-y-4",children:wt[e.id]?.map((s=>t.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"h-8 w-8 bg-gradient-to-br from-blue-100 to-blue-200 rounded-full flex items-center justify-center shadow-sm overflow-hidden",children:s.profile?.avatar_url?t.jsx("img",{src:y.storage.from("avatars").getPublicUrl(s.profile.avatar_url).data.publicUrl,alt:s.profile.username||`${s.profile.first_name||""} ${s.profile.last_name||""}`.trim()||"User",className:"w-full h-full object-cover",onError:e=>{e.currentTarget.style.display="none",e.currentTarget.parentElement.classList.remove("overflow-hidden")}}):t.jsx(T,{className:"h-4 w-4 text-blue-500"})}),t.jsxs("div",{className:"ml-2",children:[t.jsx("p",{className:"font-semibold text-sm",children:s.profile?.username||`${s.profile?.first_name||""} ${s.profile?.last_name||""}`.trim()||J("user.anonymous")}),t.jsx("p",{className:"text-xs text-gray-500",children:new Date(s.created_at).toLocaleString()})]})]}),ve?.id===s.user_id&&t.jsxs(c,{children:[t.jsx(m,{asChild:!0,children:t.jsx(l,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",children:t.jsx(E,{className:"h-4 w-4"})})}),t.jsx(p,{align:"end",children:t.jsxs(u,{className:"text-red-600",onClick:()=>(async(e,t)=>{try{const{error:s}=await y.from("post_replies").delete().eq("id",e);if(s)throw s;await Wt(t),Ze({title:J("toast.success"),description:J("toast.replyDeleted")})}catch(s){Ze({title:J("errors.general"),description:J("errors.deleteReplyFailed"),variant:"destructive"})}})(s.id,e.id),children:[t.jsx(D,{className:"h-4 w-4 mr-2"}),"Delete"]})})]})]}),t.jsx("p",{className:"text-gray-700 text-sm",children:s.content}),s.rating&&t.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[t.jsx(d,{rating:s.rating,size:"sm",readonly:!0}),t.jsxs("span",{className:"text-xs text-gray-500",children:[s.rating," ",1!==s.rating?J("rating.stars"):J("rating.star")]})]}),s.media_urls&&s.media_urls.length>0||s.image_url?t.jsx("div",{className:"mt-2",children:t.jsx(n,{media:s.media_urls&&s.media_urls.length>0?s.media_urls:s.image_url,maxPreview:3})}):null]},`reply-${s.id}`)))}),e.replies?.[0]?.count>3&&t.jsx("div",{className:"flex justify-center mt-4",children:t.jsxs(l,{variant:"outline",onClick:()=>{return t=e.id,void(window.location.href=`/community/post/${t}`);var t},className:"flex items-center gap-2",children:[t.jsx($,{className:"h-4 w-4"}),J("replies.viewAll")," (",e.replies[0].count,")"]})})]})]},e.id))),t.jsx("div",{id:"load-more-trigger",className:"h-4 w-full",children:Ve&&t.jsxs("div",{className:"text-center py-4",children:[t.jsx(q,{className:"h-6 w-6 animate-spin text-gray-400 mx-auto"}),t.jsx("p",{className:"text-sm text-gray-500 mt-2",children:J("infiniteScroll.loadingMore")})]})})]}):t.jsx("div",{className:"text-center py-4",children:t.jsx("p",{children:J("errors.notFound")})}),t.jsx(h,{open:Se,onOpenChange:e=>{$e(e)},children:t.jsxs(v,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[t.jsx(x,{children:t.jsx(g,{children:J("toast.editPost")})}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Content"}),t.jsx(j,{value:fe,onChange:e=>ye(e.target.value),className:"min-h-[100px]",placeholder:"What's on your mind?"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Location"}),t.jsx(a,{value:_e,onChange:(e,t)=>{Ne(e),Ce(t)},placeholder:"Add your location (optional)",currentLocation:Ae},Pe)]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm font-medium text-gray-700 mb-2 block",children:"Media"}),t.jsx(i,{onMediaChange:we,maxFiles:10},Fe)]})]}),t.jsxs(f,{children:[t.jsx(l,{variant:"outline",onClick:()=>{$e(!1),setTimeout((()=>{je(null),ye(""),we([]),Ne(""),Ce(null),Ue((e=>e+1)),qe((e=>e+1))}),100)},children:"Cancel"}),t.jsx(l,{onClick:async()=>{if(ge&&fe.trim())try{let e=be;if(be.length>0&&be.some((e=>e.file))){const t=be.filter((e=>!e.file)),s=be.filter((e=>e.file));if(s.length>0){const r=await Et(s);e=[...t,...r]}}const t={content:fe,media_urls:e,location:_e.trim()||null,place_id:ke?.place_id||null,place_lat:ke?.geometry?.location?.lat||null,place_lng:ke?.geometry?.location?.lng||null,place_types:ke?.types||null,place_rating:ke?.rating||null,place_user_ratings_total:ke?.user_ratings_total||null},{error:s}=await y.from("community_posts").update(t).eq("id",ge.id);if(s)throw s;le((t=>t.map((t=>t.id===ge.id?{...t,content:fe,media_urls:e,location:_e.trim()||null,place_id:ke?.place_id||null,place_lat:ke?.geometry?.location?.lat||null,place_lng:ke?.geometry?.location?.lng||null,place_types:ke?.types||null,place_rating:ke?.rating||null,place_user_ratings_total:ke?.user_ratings_total||null}:t)))),$e(!1),je(null),ye(""),we([]),Ne(""),Ce(null),Ze({title:J("toast.success"),description:J("toast.postUpdated")})}catch(e){Ze({title:J("toast.error"),description:J("toast.updatePostFailed"),variant:"destructive"})}},children:"Save Changes"})]})]})})]})]})}),t.jsxs("div",{className:"space-y-6 lg:sticky lg:top-16 lg:self-start lg:max-h-[calc(100vh-6rem)] lg:overflow-y-auto lg:pr-2",children:[st&&t.jsxs(C.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.5},className:"bg-white rounded-xl shadow-sm p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("h2",{className:"text-2xl font-bold flex items-center",children:[t.jsx(Y,{className:"h-6 w-6 mr-2 text-blue-500"}),"Community Management"]}),t.jsx(l,{variant:"outline",onClick:()=>mt(!ct),className:"flex items-center gap-2",children:ct?t.jsxs(t.Fragment,{children:[t.jsx(H,{className:"h-4 w-4"}),"Hide Blocked Users"]}):t.jsxs(t.Fragment,{children:[t.jsx(O,{className:"h-4 w-4"}),"Show Blocked Users"]})})]}),ct&&t.jsx("div",{className:"space-y-4",children:0===lt.length?t.jsx("p",{className:"text-gray-500 text-center py-4",children:"No users are currently blocked."}):lt.map((e=>t.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:shadow-md transition-shadow",children:[t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx("div",{className:"h-10 w-10 bg-gradient-to-br from-blue-100 to-blue-200 rounded-full flex items-center justify-center shadow-sm overflow-hidden",children:e.blocked_user?.avatar_url?t.jsx("img",{src:y.storage.from("avatars").getPublicUrl(e.blocked_user.avatar_url).data.publicUrl,alt:e.blocked_user.username||"User",className:"w-full h-full object-cover"}):t.jsx(T,{className:"h-5 w-5 text-blue-500"})}),t.jsxs("div",{children:[t.jsx("p",{className:"font-semibold",children:`${e.blocked_user?.first_name||""} ${e.blocked_user?.last_name||""}`.trim()||e.blocked_user?.username||"Unknown User"}),t.jsxs("p",{className:"text-sm text-gray-500",children:["Blocked by ",`${e.blocked_by?.first_name||""} ${e.blocked_by?.last_name||""}`.trim()||e.blocked_by?.username||"Unknown"]}),t.jsx("p",{className:"text-xs text-gray-400",children:new Date(e.created_at).toLocaleString()})]})]}),t.jsxs(l,{variant:"outline",size:"sm",onClick:()=>(async e=>{try{const{error:t}=await y.from("blocked_users").delete().eq("blocked_user_id",e).eq("blocked_by_id",ve.id);if(t)throw t;it((t=>{const s=new Set(t);return s.delete(e),s})),Ze({title:J("toast.success"),description:J("toast.userUnblocked")})}catch(t){Ze({title:J("toast.error"),description:J("toast.unblockUserFailed"),variant:"destructive"})}})(e.blocked_user_id),className:"text-green-600 hover:text-green-700 hover:bg-green-50",children:[t.jsx(H,{className:"h-4 w-4 mr-2"}),"Unblock"]})]},e.id)))})]}),t.jsxs(C.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.5},className:"bg-white rounded-xl shadow-sm p-6",children:[t.jsxs("h2",{className:"text-2xl font-bold mb-4 flex items-center",children:[t.jsx(M,{className:"h-6 w-6 mr-2 text-red-500"}),J("nearbyPlaces.title")]}),t.jsx("div",{className:"space-y-4",children:Ae?Ct?t.jsxs("div",{className:"text-center py-8",children:[t.jsx(q,{className:"h-8 w-8 animate-spin text-gray-400 mx-auto mb-3"}),t.jsx("p",{className:"text-gray-500",children:J("nearbyPlaces.loading")})]}):0===Nt.length?t.jsxs("div",{className:"text-center py-8",children:[t.jsx(M,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),t.jsx("p",{className:"text-gray-500",children:J("nearbyPlaces.noPlaces")}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:J("nearbyPlaces.checkBackLater")})]}):Nt.map((e=>t.jsx("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer",onClick:()=>(e=>{const t=_(e.id,e.name,V);Q(t,{state:{placeId:e.id,placeDetails:{place_id:e.id,name:e.name,lat:e.lat,lng:e.lng,types:e.categories||[],rating:0,userRatingsTotal:0}}})})(e),children:t.jsxs("div",{className:"flex items-start",children:[t.jsx("div",{className:"h-12 w-12 bg-orange-100 rounded-lg flex items-center justify-center",children:e.poi_category?.image_url?t.jsx("img",{src:e.poi_category.image_url,alt:e.poi_category.name,className:"h-8 w-8 object-cover rounded"}):t.jsx(U,{className:"h-6 w-6 text-orange-500"})}),t.jsxs("div",{className:"ml-3 flex-1",children:[t.jsx("h3",{className:"font-semibold text-gray-800",children:e.name}),t.jsxs("p",{className:"text-sm text-gray-500",children:[e.distance.toFixed(1),J("nearbyPlaces.distance"),e.poi_category&&` • ${e.poi_category.name}`]}),e.description&&t.jsx("p",{className:"text-sm text-gray-600 mt-1 line-clamp-2",children:e.description}),e.address&&t.jsx("p",{className:"text-xs text-gray-400 mt-1",children:e.address})]})]})},e.id))):t.jsxs("div",{className:"text-center py-8",children:[t.jsx(M,{className:"h-12 w-12 text-gray-300 mx-auto mb-3"}),t.jsx("p",{className:"text-gray-500",children:J("nearbyPlaces.enableLocation")}),t.jsx(l,{variant:"outline",size:"sm",onClick:Ft,className:"mt-2",children:J("nearbyPlaces.enableLocation")})]})})]})]})]})]})})})};export{J as default};
//# sourceMappingURL=page-community.DMyFNU_e.js.map
