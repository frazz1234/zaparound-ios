import{r as e,j as t}from"../vendor/vendor-react-core.D1hcyiwY.js";import{m as r}from"../vendor/vendor--mapbox-gl.CIg18VY7.js";import{s as n}from"../components/components-admin.CiIAoamg.js";import{B as s,aU as o,aV as a,aW as i,aX as l}from"../components/components-ui.C8hnNhgu.js";import{c}from"../components/components-blog.C3TFiFB1.js";import{t as d}from"../hooks/hooks-use-toast.ts.Dg8obzHg.js";import{M as p}from"../components/components-mapsearch.tsx.BOhv1nby.js";import{u as m}from"../hooks/hooks-useuserrole.ts.BKHSjdY6.js";import{u}from"../hooks/hooks-usepois.ts.lA82ceWk.js";import{P as x}from"../components/components-poireviewdialog.tsx.BVvjfDHP.js";import{s as h}from"../vendor/vendor-react-dom.BnDkh-2X.js";import{u as g}from"../hooks/hooks-usemapdata.ts.F4WF97GX.js";import{u as v}from"../hooks/hooks-usecheckpointcache.ts.Dsm_z7AN.js";import{u as y}from"../hooks/hooks-usemapcache.ts.CTfbvRaB.js";import{u as f}from"../hooks/hooks-usemarkercache.ts.BptiR-wV.js";import{c as b,C as j,a as w}from"../utils/utils-cache.ts.BtmNadnX.js";import{a as k}from"../utils/utils-placeutils.ts.vo-R8UHO.js";import{u as N}from"../vendor/vendor--react-i18next.DhHVfoav.js";import{a3 as z,a2 as L,a1 as C,L as _,bb as E,bz as S,a7 as $,H as M,$ as T,o as P,X as A,M as I,am as V,aj as B,aS as R,al as D,ai as F,ah as W,ak as O,ag as H}from"../vendor/vendor--lucide-react.DRw9PYsu.js";import{A as q,m as Z}from"../vendor/vendor--framer-motion.Dpgjd5L1.js";import{u as U,b as X,a as G}from"../vendor/vendor--react-router.Gdfmkz0l.js";import"../vendor/vendor--cookie.D-6orQ43.js";import"../vendor/vendor--react-hook-form.C68mK_Ba.js";import"../vendor/vendor---hookform-resolvers.CwYzTTZs.js";import"../vendor/vendor--zod.Cebk8UiH.js";import"../vendor/vendor-supabase-client.BJD0U0P8.js";import"../vendor/vendor-supabase-other.BhmW1H_P.js";import"../components/components-mobilenavigation.tsx.DtMtI5i3.js";import"../components/components-languagerouter.tsx.CHVsY7fH.js";import"../vendor/vendor--i18next.CHTa0CEF.js";import"../vendor/vendor--i18next-browser-languagedetector.h4x3AYwK.js";import"../vendor/vendor--i18next-http-backend.DjHzioAf.js";import"../components/components-languageselector.tsx.x8buceJ0.js";import"../components/components-navigation.CB-8LlfF.js";import"../components/components-theme-toggle.tsx.CfzjOSrj.js";import"../components/components-theme-provider.tsx.Cd7zUHTE.js";import"../vendor/vendor-supabase-realtime.PMyDaGD3.js";import"../vendor/vendor--sonner.ECaEf7Ie.js";import"../hooks/hooks-useadminauth.ts.BJ7uhFTt.js";import"../vendor/vendor-ui-toast.CyvsGWN1.js";import"../vendor/vendor-ui-core.CPnW5LH0.js";import"../vendor/vendor--aria-hidden.BHUiN-rI.js";import"../vendor/vendor--react-remove-scroll.DR6iVcCg.js";import"../vendor/vendor--tslib.Bc9CN1Ef.js";import"../vendor/vendor--react-remove-scroll-bar.Dz-JErv0.js";import"../vendor/vendor--react-style-singleton.ER5nEGYx.js";import"../vendor/vendor--get-nonce.BYiZHLe3.js";import"../vendor/vendor--use-sidecar.svB0tWl8.js";import"../vendor/vendor--use-callback-ref.Dt9orvWx.js";import"../vendor/vendor---floating-ui-react-dom.gDT63CuY.js";import"../vendor/vendor---floating-ui-dom.CdGDzP9A.js";import"../vendor/vendor---floating-ui-core.D6mclMLM.js";import"../vendor/vendor---floating-ui-utils.D9HCu73I.js";import"../vendor/vendor-ui-dialog.CY7OxuK6.js";import"../vendor/vendor-ui-utils.CjDQ2U02.js";import"../vendor/vendor-ui-tooltip.n7I39vTs.js";import"../vendor/vendor--embla-carousel-react.Bc6nB0ya.js";import"../vendor/vendor--embla-carousel-reactive-utils.BIRN7lq8.js";import"../vendor/vendor--embla-carousel.clUl8sxa.js";import"../vendor/vendor--cmdk.q6oiTfmV.js";import"../vendor/vendor--react-day-picker.D6HWAs9M.js";import"../vendor/vendor--date-fns.BbAlDtqN.js";import"../utils/utils-blogutils.ts.CpQs8y27.js";import"../components/components-optimizedimage.tsx.DVN-Ynzu.js";import"../hooks/hooks-useblogs.ts.B-jKAetY.js";import"../vendor/vendor-query-main.DFU6mXji.js";import"../vendor/vendor---tanstack-query-core.CIZi0Zbo.js";import"../vendor/vendor--lodash.D80NHDHN.js";import"../vendor/vendor--react-markdown.C_e4o-CH.js";import"../vendor/vendor--devlop.Cl3hj7Sz.js";import"../vendor/vendor--unified.ti5-l0IV.js";import"../vendor/vendor--bail.gCPcOVbC.js";import"../vendor/vendor--extend.BFvm699q.js";import"../vendor/vendor--is-plain-obj.DeEdtHJQ.js";import"../vendor/vendor--trough.zzWXwSIo.js";import"../vendor/vendor--vfile.Cn6Vy3Ir.js";import"../vendor/vendor--vfile-message.Re42m5o3.js";import"../vendor/vendor--unist-util-stringify-position.CvSG9YTx.js";import"../vendor/vendor--remark-parse.DdoJrvcY.js";import"../vendor/vendor--mdast-util-from-markdown.DI8nvaYJ.js";import"../vendor/vendor--micromark-util-decode-numeric-character-reference.DA7xEauU.js";import"../vendor/vendor--micromark-util-decode-string.BCF2SQ7o.js";import"../vendor/vendor--decode-named-character-reference.C-EXV6yX.js";import"../vendor/vendor--micromark-util-normalize-identifier.CzKtq1sx.js";import"../vendor/vendor--micromark.aJPyxAJv.js";import"../vendor/vendor--micromark-util-combine-extensions.CQDa_SAq.js";import"../vendor/vendor--micromark-util-chunked.3k3e5hER.js";import"../vendor/vendor--micromark-factory-space.CZc9TqN4.js";import"../vendor/vendor--micromark-util-character.DUwsRT9L.js";import"../vendor/vendor--micromark-core-commonmark.yO25BTZZ.js";import"../vendor/vendor--micromark-util-classify-character.x6FlXUUS.js";import"../vendor/vendor--micromark-util-resolve-all.U8fstr8o.js";import"../vendor/vendor--micromark-util-subtokenize.BfHYzAYP.js";import"../vendor/vendor--micromark-factory-destination.pZKs7oL9.js";import"../vendor/vendor--micromark-factory-label.BbusvwMx.js";import"../vendor/vendor--micromark-factory-title.BBtcOUHM.js";import"../vendor/vendor--micromark-factory-whitespace.BhZ6YKME.js";import"../vendor/vendor--micromark-util-html-tag-name.DbKNfynz.js";import"../vendor/vendor--mdast-util-to-string.Ck87fAyN.js";import"../vendor/vendor--remark-rehype.B9Xnklpv.js";import"../vendor/vendor--mdast-util-to-hast.C2F2cLDR.js";import"../vendor/vendor---ungap-structured-clone.DadG6O39.js";import"../vendor/vendor--micromark-util-sanitize-uri.BXHzaaAi.js";import"../vendor/vendor--unist-util-position.CVUg9P9R.js";import"../vendor/vendor--trim-lines.C03Dth7Y.js";import"../vendor/vendor--unist-util-visit.41WSH7so.js";import"../vendor/vendor--unist-util-visit-parents.DAGCrDnu.js";import"../vendor/vendor--unist-util-is.C5Jwnfs7.js";import"../vendor/vendor--hast-util-to-jsx-runtime.BOWXXjuU.js";import"../vendor/vendor--comma-separated-tokens.DIu3lqJt.js";import"../vendor/vendor--property-information.Dc64tFtG.js";import"../vendor/vendor--space-separated-tokens.C97BfSlU.js";import"../vendor/vendor--style-to-js.DQsO4XA8.js";import"../vendor/vendor--style-to-object.DGZeIPGP.js";import"../vendor/vendor--inline-style-parser.BFz9PO4J.js";import"../vendor/vendor--hast-util-whitespace.DlJMGLAz.js";import"../vendor/vendor--estree-util-is-identifier-name.0h9-8Xae.js";import"../vendor/vendor--html-url-attributes.BA_i5Yxb.js";import"../vendor/vendor--react-helmet-async.BMUx00aU.js";import"../vendor/vendor--react-fast-compare.4d-J074I.js";import"../vendor/vendor--invariant.D6mx6rc7.js";import"../vendor/vendor--shallowequal.BwnEDCFe.js";import"../vendor/vendor--web-vitals.C1BoAgs7.js";import"../vendor/vendor--uuid.BuTxD5e6.js";import"../vendor/vendor-react-scheduler.B5Ht9ZB3.js";import"../vendor/vendor--lru-cache.CYB7PIxo.js";import"../vendor/vendor--motion-dom.C5KZPrWP.js";import"../vendor/vendor--motion-utils.DAP8mxSY.js";const Q=()=>"undefined"!=typeof window&&(window.innerWidth<768||/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)),Y={zapout:"#10b981",zaproad:"#f59e0b",zaptrip:"#0ea5e9",default:"#0ea5e9"},J=(e,t,r="en")=>`/${r}/zap-places/${k(t)}?id=${e}`,K=()=>{const{t:k}=N(["navigation","common"]),{i18n:K}=N();K.language;const ee=U(),te=X();m();const re=e.useRef(null),ne=e.useRef(null),se=e.useRef([]),oe=e.useRef([]),ae=e.useRef([]),ie=e.useRef([]),[le,ce]=e.useState(null),{mapData:de,loading:pe,error:me,removeFavoriteFromCache:ue}=g(),{fetchZapoutCheckpoints:xe,fetchZaproadCheckpoints:he,fetchZaptripCheckpoints:ge}=v(),{getOrCreateMap:ve,updateMapStyle:ye,clearCache:fe}=y(),{setMap:be,cleanup:je}=f(),[we,ke]=e.useState(null),[Ne,ze]=e.useState(null),[Le,Ce]=e.useState("mapbox://styles/mapbox/streets-v12"),[_e,Ee]=e.useState("driving"),[Se,$e]=e.useState(!1),[Me,Te]=e.useState(!0),[Pe,Ae]=e.useState(null),[Ie,Ve]=e.useState(!1),Be=e.useRef(null),Re=e.useRef(null),De=e.useRef(null),[Fe,We]=e.useState(!0),[Oe,He]=e.useState(!0),[qe,Ze]=e.useState(!0),[Ue,Xe]=e.useState(!1),{lang:Ge}=G(),[Qe,Ye]=e.useState([]),{pois:Je,addPOIReview:Ke}=u(),et=de.trips,tt=de.favorites;e.useEffect((()=>{const e=()=>{const e=Q();$e(e),Te(!e)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]),e.useEffect((()=>{if(te.state?.selectedTripId&&te.state?.tripType){const e=et.find((e=>e.id===te.state.selectedTripId&&e.type===te.state.tripType));e&&st(e)}}),[et,te.state]),e.useEffect((()=>{if(!re.current)return;const e=Q(),t=ve({container:re.current,style:Le,center:[2.3488,48.8534],zoom:3,pitch:60,bearing:0,showTerrain:Fe,isMobile:e});return ne.current=t,be(t),()=>{je(),fe()}}),[ve,be,je,fe]),e.useEffect((()=>{ne.current&&ye(Le)}),[Le,ye]),e.useEffect((()=>{if(!Se)return;const e=()=>{ne.current&&setTimeout((()=>{ne.current?.resize(),le?.coordinates&&ne.current?.flyTo({center:le.coordinates,zoom:13,duration:500})}),200)};return window.addEventListener("orientationchange",e),window.addEventListener("resize",e),()=>{window.removeEventListener("orientationchange",e),window.removeEventListener("resize",e)}}),[Se,le]);const rt=e=>{Ce(e)};e.useEffect((()=>{if(!ne.current||pe)return;se.current.forEach((e=>e&&e.remove())),se.current=[];const e=Ne?et.filter((e=>e.type===Ne)):et,n=new r.LngLatBounds;let s=!1;e.forEach((e=>{if(e.coordinates)try{const[o,a]=e.coordinates;if(!o||!a||isNaN(o)||isNaN(a))return;const i=document.createElement("div");i.className="map-marker",i.style.width="30px",i.style.height="30px",i.style.borderRadius="50%",i.style.background=Y[e.type]||Y.default,i.style.cursor="pointer",i.style.display="flex",i.style.alignItems="center",i.style.justifyContent="center",i.style.color="white",i.style.fontWeight="bold",i.style.fontSize="14px",i.style.border="2px solid white",i.style.boxShadow="0 2px 4px rgba(0,0,0,0.3)";let l="";"zapout"===e.type?l=h.renderToStaticMarkup(t.jsx(z,{className:"w-5 h-5"})):"zaproad"===e.type?l=h.renderToStaticMarkup(t.jsx(L,{className:"w-5 h-5"})):"zaptrip"===e.type&&(l=h.renderToStaticMarkup(t.jsx(C,{className:"w-5 h-5"}))),i.innerHTML=l,i.onmouseover=()=>{i.style.zIndex="10",i.style.boxShadow="0 4px 8px rgba(0,0,0,0.3)"},i.onmouseout=()=>{i.style.zIndex="1",i.style.boxShadow="0 2px 4px rgba(0,0,0,0.3)"};const c=new r.Marker(i).setLngLat([o,a]).addTo(ne.current);c.getElement().addEventListener("click",(()=>{st(e)})),se.current.push(c),n.extend([o,a]),s=!0}catch(o){}})),s&&ne.current&&ne.current.fitBounds(n,{padding:50,maxZoom:12}),ct()}),[et,pe,Ne]);const nt=()=>{oe.current.forEach((e=>e.remove())),oe.current=[]},st=e=>{if(le?.id===e.id&&le?.type===e.type)return ce(null),lt(),void(Se&&Te(!0));if(ce(e),Se&&Te(!0),lt(),e.coordinates){const[t,r]=e.coordinates;se.current.forEach((n=>{const s=n.getElement();s.style.zIndex="1",s.style.boxShadow="0 2px 4px rgba(0,0,0,0.3)";const o=n.getLngLat();o.lng===t&&o.lat===r&&(s.style.zIndex="10",s.style.boxShadow=`0 0 0 4px ${Y[e.type]}`)})),ne.current?.flyTo({center:[t,r],zoom:13,duration:1500}),at(e)}},ot=e=>{switch(localStorage.setItem("tripDetailsPreviousPage","mapDashboard"),e.type){case"zapout":ee(`/${Ge}/zapout/${e.id}`);break;case"zaproad":ee(`/${Ge}/zaproad/${e.id}`);break;case"zaptrip":ee(`/${Ge}/trips/${e.id}`)}},at=async e=>{try{let t;switch(e.type){case"zapout":t=await xe(e.id,_e);break;case"zaproad":t=await he(e.id,_e);break;case"zaptrip":t=await ge(e.id);break;default:return}if(!t||!t.checkpoints.length)return;nt(),t.routeGeometry&&ne.current&&(it(),ne.current.addSource("cached-route",{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:t.routeGeometry}}}),ne.current.addLayer({id:"cached-route-line",type:"line",source:"cached-route",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":Y[e.type],"line-width":4,"line-opacity":.8}}),ne.current.addLayer({id:"cached-route-glow",type:"line",source:"cached-route",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#ffffff","line-width":7,"line-opacity":.4,"line-blur":2}},"cached-route-line")),t.checkpoints.forEach(((t,n)=>{const s=document.createElement("div");s.style.width=0===n?"32px":"24px",s.style.height=0===n?"32px":"24px",s.style.borderRadius="50%",s.style.background=Y[e.type],s.style.color="white",s.style.fontWeight="bold",s.style.display="flex",s.style.alignItems="center",s.style.justifyContent="center",s.style.fontSize=0===n?"14px":"12px",s.style.border="2px solid white",s.style.boxShadow="0 2px 6px rgba(0,0,0,0.3)",s.textContent=0===n?"ðŸ“":n.toString(),s.style.transition="box-shadow 0.2s ease",s.onmouseover=()=>{s.style.zIndex="10",s.style.boxShadow="0 4px 8px rgba(0,0,0,0.3)"},s.onmouseout=()=>{s.style.zIndex="1",s.style.boxShadow="0 2px 6px rgba(0,0,0,0.3)"};const o=`\n          <div class="p-3 bg-white rounded-lg shadow-lg border border-gray-200">\n            <div class="flex items-center space-x-2 mb-2">\n              <div class="w-4 h-4 bg-${"zapout"===e.type?"emerald":"zaproad"===e.type?"amber":"sky"}-500 rounded-full flex items-center justify-center">\n                <svg width="8" height="8" viewBox="0 0 24 24" fill="white">\n                  <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>\n                </svg>\n              </div>\n              <h3 class="font-semibold text-sm">${t.name}</h3>\n            </div>\n            <p class="text-xs text-gray-600">${t.address}</p>\n          </div>\n        `,a=new r.Popup({offset:25,closeButton:!1,className:"trip-popup"}).setHTML(o),i=new r.Marker(s).setLngLat(t.coordinates).setPopup(a).addTo(ne.current);s.addEventListener("click",(()=>{De.current&&De.current.remove(),De.current=a})),a.on("close",(()=>{De.current===a&&(De.current=null)})),oe.current.push(i)}));const n=new r.LngLatBounds;t.checkpoints.forEach((e=>{n.extend(e.coordinates)})),ne.current?.fitBounds(n,{padding:70,duration:1e3})}catch(t){}},it=()=>{if(ne.current)try{["zaproad-route-line","zaproad-route-glow"].forEach((e=>{ne.current?.getLayer(e)&&ne.current.removeLayer(e)}));["zaproad-route"].forEach((e=>{ne.current?.getSource(e)&&ne.current.removeSource(e)}));const e=ne.current.getSource("route");e&&e.setData({type:"Feature",properties:{},geometry:{type:"LineString",coordinates:[]}})}catch(e){}},lt=()=>{nt(),it(),ie.current.forEach((e=>e.remove())),ie.current=[]};e.useEffect((()=>()=>{Be.current&&Be.current.remove(),Re.current&&Re.current.remove(),se.current.forEach((e=>e.remove())),ae.current.forEach((e=>e.remove())),ie.current.forEach((e=>e.remove())),oe.current.forEach((e=>e.remove()))}),[]);const ct=()=>{ne.current&&(ae.current.forEach((e=>e.remove())),ae.current=[],Oe&&tt.forEach((e=>{if(e.place_lat&&e.place_lng){const t=document.createElement("div");t.className="favorite-marker",t.style.width="24px",t.style.height="24px",t.style.background="#ef4444",t.style.borderRadius="50%",t.style.border="2px solid white",t.style.boxShadow="0 2px 4px rgba(0,0,0,0.3)",t.style.cursor="pointer",t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="center",t.innerHTML='<svg width="12" height="12" viewBox="0 0 24 24" fill="white"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>';const n=new r.Marker(t).setLngLat([e.place_lng,e.place_lat]).addTo(ne.current),s=new r.Popup({offset:25,closeButton:!1,className:"favorite-popup"}).setHTML(`\n            <div class="p-3 bg-white rounded-lg shadow-lg border border-gray-200">\n              <div class="flex items-center space-x-2 mb-2">\n                <div class="w-4 h-4 bg-red-500 rounded-full flex items-center justify-center">\n                  <svg width="8" height="8" viewBox="0 0 24 24" fill="white">\n                    <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>\n                  </svg>\n                </div>\n                <h3 class="font-semibold text-sm">${e.place_name}</h3>\n              </div>\n              <p class="text-xs text-gray-600 mb-2">${e.place_address}</p>\n              ${e.place_rating?`\n                <div class="flex items-center space-x-1 mb-2">\n                  <span class="text-yellow-500 text-xs">â˜…</span>\n                  <span class="text-xs text-gray-600">${e.place_rating.toFixed(1)}</span>\n                </div>\n              `:""}\n              <div class="flex space-x-2">\n                <button onclick="window.open('${J(e.place_id,e.place_name,"en")}', '_blank')" class="text-xs bg-blue-500 text-white px-2 py-1 rounded hover:bg-blue-600 transition-colors">\n                  ${k("favorites.viewDetails")}\n                </button>\n                <button onclick="getFavoriteDirections(${e.id})" class="text-xs bg-green-500 text-white px-2 py-1 rounded hover:bg-green-600 transition-colors flex items-center justify-center space-x-1">\n                  <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"/>\n                  </svg>\n                  <span>${k("pois.directions")}</span>\n                </button>\n              </div>\n            </div>\n          `);n.setPopup(s),ae.current.push(n)}})))},dt=async e=>{try{const{data:{user:t}}=await n.auth.getUser();if(!t)return;const{error:r}=await n.from("favorites").delete().eq("id",e);if(r)throw r;ue(e),b.emit(j.FAVORITE_REMOVED),await w(t.id),d({title:k("favorites.removed"),description:k("favorites.removedMessage")})}catch(t){d({title:k("favorites.error"),description:k("favorites.errorMessage"),variant:"destructive"})}};e.useEffect((()=>(window.removeFavorite=dt,window.getFavoriteDirections=e=>{const t=tt.find((t=>t.id===e));t&&ft(t)},()=>{delete window.removeFavorite,delete window.getFavoriteDirections})),[tt]),e.useEffect((()=>{const e=document.createElement("style");return e.textContent="\n      .favorite-popup .mapboxgl-popup-content,\n      .trip-popup .mapboxgl-popup-content,\n      .poi-popup .mapboxgl-popup-content {\n        background: transparent !important;\n        border: none !important;\n        box-shadow: none !important;\n        padding: 0 !important;\n        margin: 0 !important;\n      }\n      .favorite-popup .mapboxgl-popup-tip,\n      .trip-popup .mapboxgl-popup-tip,\n      .poi-popup .mapboxgl-popup-tip {\n        display: none !important;\n      }\n      \n      /* POI Marker specific styles - simplified for better positioning */\n      .poi-marker {\n        pointer-events: auto !important;\n      }\n      \n      /* Ensure markers don't disappear on hover */\n      .mapboxgl-marker {\n        pointer-events: auto !important;\n      }\n      \n      /* Improve accordion touch handling on mobile */\n      [data-radix-accordion-trigger] {\n        touch-action: manipulation !important;\n        -webkit-tap-highlight-color: transparent !important;\n        user-select: none !important;\n      }\n      \n      /* Ensure accordion content is properly touchable */\n      [data-radix-accordion-content] {\n        touch-action: pan-y !important;\n      }\n      \n      /* Prevent touch events from interfering with accordion on mobile */\n      @media (max-width: 768px) {\n        [data-radix-accordion-item] {\n          touch-action: manipulation !important;\n        }\n        \n        /* Ensure sidebar content is visible above mobile navbar */\n        .sidebar-content {\n          padding-bottom: 6rem !important;\n          margin-bottom: 1rem !important;\n        }\n      }\n    ",document.head.appendChild(e),()=>{document.head.removeChild(e)}}),[]),e.useEffect((()=>{ne.current&&ct()}),[Oe,tt,ct]),e.useEffect((()=>{}),[tt]);const pt=()=>{ne.current&&(ie.current.forEach((e=>e.remove())),ie.current=[],qe&&Je.forEach((e=>{if(e.lat&&e.lng){const t=e=>e.includes("restaurant")||e.includes("food")?"#ef4444":e.includes("hotel")||e.includes("lodging")?"#3b82f6":e.includes("cafe")||e.includes("coffee")?"#8b5cf6":e.includes("bar")||e.includes("nightlife")?"#f59e0b":e.includes("museum")||e.includes("art")?"#10b981":e.includes("park")||e.includes("nature")?"#059669":e.includes("shopping")||e.includes("store")?"#ec4899":e.includes("entertainment")||e.includes("attraction")?"#f97316":"#6b7280",n=(e=>e.includes("restaurant")||e.includes("food")?"ðŸ½ï¸":e.includes("hotel")||e.includes("lodging")?"ðŸ¨":e.includes("cafe")||e.includes("coffee")?"â˜•":e.includes("bar")||e.includes("nightlife")?"ðŸº":e.includes("museum")||e.includes("art")?"ðŸ›ï¸":e.includes("park")||e.includes("nature")?"ðŸŒ³":e.includes("shopping")||e.includes("store")?"ðŸ›ï¸":e.includes("entertainment")||e.includes("attraction")?"ðŸŽ¡":"ðŸ“")(e.categories),s=t(e.categories),o=document.createElement("div");if(o.className="poi-marker",o.setAttribute("data-marker-type","poi"),o.style.width="28px",o.style.height="28px",o.style.background=s,o.style.borderRadius="50%",o.style.border="2px solid white",o.style.boxShadow="0 2px 4px rgba(0,0,0,0.3)",o.style.cursor="pointer",o.style.display="flex",o.style.alignItems="center",o.style.justifyContent="center",o.style.fontSize="12px",o.style.transition="box-shadow 0.2s ease",e.category_image_url){const t=document.createElement("img");t.src=e.category_image_url,t.style.width="20px",t.style.height="20px",t.style.objectFit="cover",t.style.borderRadius="50%",t.style.backgroundColor="white",t.style.padding="2px",t.alt=e.category_name||"POI",t.style.transition="all 0.2s ease",t.onerror=()=>{o.textContent=n},t.onload=()=>{},o.appendChild(t)}else o.textContent=n;if(e.average_rating&&e.average_rating>0){const t=document.createElement("div");t.style.position="absolute",t.style.bottom="-18px",t.style.left="50%",t.style.transform="translateX(-50%)",t.style.background="#ffffff",t.style.border="1px solid #e5e7eb",t.style.borderRadius="8px",t.style.padding="2px 4px",t.style.fontSize="10px",t.style.fontWeight="bold",t.style.color="#f59e0b",t.style.boxShadow="0 1px 2px rgba(0,0,0,0.1)",t.style.whiteSpace="nowrap",t.style.zIndex="2",t.style.transition="all 0.2s ease";let r="";r="out_of_5"===e.rating_type?`${e.average_rating.toFixed(1)}/5â˜…`:"percentage"===e.rating_type?`${e.average_rating.toFixed(0)}%â˜…`:`${e.average_rating.toFixed(1)}/10â˜…`,t.textContent=r,o.appendChild(t)}o.onmouseover=()=>{o.style.zIndex="10",o.style.boxShadow="0 4px 8px rgba(0,0,0,0.3)";const e=o.firstChild;e&&"IMG"===e.tagName&&(e.style.width="24px",e.style.height="24px")},o.onmouseout=()=>{o.style.zIndex="1",o.style.boxShadow="0 2px 4px rgba(0,0,0,0.3)";const e=o.firstChild;e&&"IMG"===e.tagName&&(e.style.width="20px",e.style.height="20px")};const a=new r.Marker(o).setLngLat([e.lng,e.lat]).addTo(ne.current),i=`\n          <div class="p-3 bg-white/95 backdrop-blur-sm rounded-lg shadow-lg border border-gray-200 max-w-xs">\n            <div class="flex items-center space-x-2 mb-2">\n              ${e.category_image_url?`\n                <img src="${e.category_image_url}" alt="${e.category_name||"POI"}" style="width: 32px; height: 32px; object-fit: cover; border-radius: 50%;" />\n              `:`\n                <div class="w-8 h-8 rounded-full flex items-center justify-center text-white text-sm" style="background: ${s}">\n                  ${n}\n                </div>\n              `}\n              <h3 class="font-semibold text-sm text-gray-900 truncate">${e.name}</h3>\n            </div>\n            <p class="text-xs text-gray-600 mb-2 truncate">${e.address}</p>\n            ${e.average_rating&&e.average_rating>0?`\n              <div class="flex items-center space-x-1 mb-2">\n                <span class="text-yellow-500 text-xs">â˜…</span>\n                <span class="text-xs text-gray-600">${e.average_rating.toFixed(1)}/10</span>\n                \n              </div>\n            `:""}\n            ${e.description?`\n              <p class="text-xs text-gray-600 mb-2 line-clamp-2">${e.description}</p>\n            `:""}\n            ${e.category_name?`\n              <div class="flex items-center space-x-1 mb-2">\n                <svg class="w-3 h-3 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>\n                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>\n                </svg>\n                <span class="text-xs text-gray-500">${e.category_name}</span>\n              </div>\n            `:""}\n            <div class="flex space-x-2">\n              ${e.url?`\n                <button class="visit-btn flex-1 text-xs bg-blue-500/90 text-white px-2 py-1 rounded hover:bg-blue-600 transition-colors flex items-center justify-center space-x-1" data-url="${e.url}">\n                  <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/>\n                  </svg>\n                  <span>${k("pois.visit")}</span>\n                </button>\n              `:""}\n              <button class="directions-btn flex-1 text-xs bg-green-500/90 text-white px-2 py-1 rounded hover:bg-green-600 transition-colors flex items-center justify-center space-x-1" data-lat="${e.lat}" data-lng="${e.lng}" data-name="${e.name}">\n                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">\n                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"/>\n                </svg>\n                <span>${k("pois.directions")}</span>\n              </button>\n            </div>\n          </div>\n        `,l=new r.Popup({offset:25,closeButton:!1,className:"poi-popup"}).setHTML(i);a.setPopup(l),a.getElement().addEventListener("click",(()=>{De.current&&De.current.remove(),De.current=l})),l.on("close",(()=>{De.current===l&&(De.current=null)})),l.on("open",(()=>{const e=l.getElement();if(e){const t=e.querySelector(".visit-btn");t&&t.addEventListener("click",(e=>{e.stopPropagation();const r=t.getAttribute("data-url");r&&window.open(r,"_blank")}));const r=e.querySelector(".directions-btn");r&&r.addEventListener("click",(e=>{e.stopPropagation();const t=r.getAttribute("data-lat"),n=r.getAttribute("data-lng"),s=r.getAttribute("data-name");t&&n&&s&&bt(t,n)}))}})),ie.current.push(a)}})))},mt=e=>{const t=Je.find((t=>t.id===e));t&&(ke(t),Xe(!0))};e.useEffect((()=>(window.openPOIReview=mt,()=>{delete window.openPOIReview})),[Je]);e.useEffect((()=>{ne.current&&pt()}),[qe,Je,pt]);const ut=tt.reduce(((e,t)=>{const r=(n=t.place_types)&&Array.isArray(n)?n.includes("restaurant")||n.includes("food")?"restaurant":n.includes("hotel")||n.includes("lodging")?"hotel":n.includes("cafe")||n.includes("coffee")?"cafe":n.includes("bar")||n.includes("nightlife")?"bar":n.includes("museum")||n.includes("art")?"museum":n.includes("park")||n.includes("nature")?"park":n.includes("shopping")||n.includes("store")?"shopping":n.includes("entertainment")||n.includes("attraction")?"entertainment":"other":"other";var n;return e[r]||(e[r]=[]),e[r].push(t),e}),{}),xt=et.reduce(((e,t)=>{const r=t.location||"Unknown Location";return e[r]||(e[r]=[]),e[r].push(t),e}),{}),ht=Object.keys(xt).sort(((e,t)=>"Unknown Location"===e?1:"Unknown Location"===t?-1:e.localeCompare(t))),gt=e=>{switch(e){case"restaurant":return t.jsx(H,{className:"w-4 h-4"});case"hotel":return t.jsx(O,{className:"w-4 h-4"});case"cafe":return t.jsx(W,{className:"w-4 h-4"});case"bar":return t.jsx(F,{className:"w-4 h-4"});case"museum":return t.jsx(D,{className:"w-4 h-4"});case"park":return t.jsx(R,{className:"w-4 h-4"});case"shopping":return t.jsx(B,{className:"w-4 h-4"});case"entertainment":return t.jsx(V,{className:"w-4 h-4"});default:return t.jsx(I,{className:"w-4 h-4"})}},vt=e=>{switch(e){case"restaurant":return"bg-red-500";case"hotel":return"bg-blue-500";case"cafe":return"bg-purple-500";case"bar":return"bg-amber-500";case"museum":return"bg-emerald-500";case"park":return"bg-green-500";case"shopping":return"bg-pink-500";case"entertainment":return"bg-orange-500";default:return"bg-gray-500"}},yt=e=>k(`favorites.categories.${e}`,{defaultValue:k("favorites.categories.other")}),ft=e=>{const t=e.place_address||e.place_name;if(!t)return;const r=encodeURIComponent(t),n=`https://www.google.com/maps/search/?api=1&query=${r}`;if(navigator.userAgent.match(/iPhone|iPad|iPod|Android/i)){const e=`comgooglemaps://?q=${r}`,t=document.createElement("iframe");t.style.display="none",t.src=e;const s=setTimeout((()=>{window.open(n,"_blank")}),1e3);t.onload=()=>{clearTimeout(s)},document.body.appendChild(t),setTimeout((()=>{document.body.removeChild(t)}),2e3)}else window.open(n,"_blank")},bt=(e,t,r)=>{const n=`https://www.google.com/maps/dir/?api=1&destination=${e},${t}&travelmode=driving`;window.open(n,"_blank")};return e.useEffect((()=>(window.openDirections=bt,()=>{delete window.openDirections})),[]),t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"relative w-full h-[calc(100vh-64px)] overflow-hidden",children:[t.jsx("div",{ref:re,className:"absolute inset-0 bg-gray-100",style:{touchAction:"none",background:"#fcfcfc"}}),t.jsx(p,{map:ne,onLocationSelect:e=>{if(!ne.current||!e.center)return;if("database_poi"===e.properties?.source)return void ne.current.flyTo({center:e.center,zoom:e.zoom||15,duration:1500});Be.current&&Be.current.remove();const t=(e=>{const t=e?.properties?.category||e?.type,r=e?.place_type||e?.properties?.place_type,n=((e,t)=>{if(t?.includes("address"))return"ðŸ ";if(t?.includes("poi")){if(!e)return"ðŸ“";switch(e){case"restaurant":case"food":case"cafe":case"coffee":return"ðŸ½ï¸";case"hotel":case"lodging":return"ðŸ¨";case"bar":case"nightlife":return"ðŸº";case"museum":case"art":return"ðŸ›ï¸";case"park":case"nature":return"ðŸŒ³";case"shopping":case"store":return"ðŸ›ï¸";case"entertainment":return"ðŸŽ‰";case"attraction":return"ðŸŽ¡";default:return"ðŸ“"}}return"ðŸ“"})(t,r),s=((e,t)=>{if(t?.includes("address"))return"#6b7280";if(t?.includes("poi"))switch(e){case"restaurant":case"food":return"#ef4444";case"cafe":case"coffee":return"#8b5cf6";case"hotel":case"lodging":return"#3b82f6";case"bar":case"nightlife":return"#f59e0b";case"museum":case"art":return"#10b981";case"park":case"nature":return"#059669";case"shopping":case"store":return"#ec4899";case"entertainment":case"attraction":return"#f97316";default:return"#6b7280"}return"#6b7280"})(t,r),o=document.createElement("div");o.className="pin-marker";const a=document.createElement("div");return a.style.width="40px",a.style.height="40px",a.style.background=s,a.style.borderRadius="50%",a.style.border="3px solid white",a.style.boxShadow="0 2px 4px rgba(0,0,0,0.3)",a.style.display="flex",a.style.alignItems="center",a.style.justifyContent="center",a.style.fontSize="14px",a.style.overflow="hidden",a.style.transition="box-shadow 0.2s ease",a.style.transform="none",a.textContent=n,o.appendChild(a),o.style.fontSize="32px",o.style.transform="translate(-50%, -50%)",o.style.cursor="pointer",o.style.display="flex",o.style.alignItems="center",o.style.justifyContent="center",o})(e);Be.current=new r.Marker({element:t,anchor:"center"}).setLngLat(e.center).addTo(ne.current);t.style.transform="translate(-50%, -50%) translateY(-10px)",setTimeout((()=>{t.style.transform="translate(-50%, -50%)"}),200),ne.current.flyTo({center:e.center,zoom:e.zoom||15,duration:1500})}}),pe&&t.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white/80 z-10",children:t.jsxs("div",{className:"flex flex-col items-center",children:[t.jsx(_,{className:"w-12 h-12 text-blue-500 animate-spin mb-4"}),t.jsx("p",{className:"text-gray-600",children:k("loading")})]})}),me&&t.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white/90 z-10",children:t.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg max-w-md",children:[t.jsx("h3",{className:"text-xl font-semibold text-red-600 mb-2",children:"Error"}),t.jsx("p",{className:"text-gray-700 mb-4",children:me}),t.jsx(s,{onClick:()=>window.location.reload(),className:"w-full",children:"Retry"})]})}),t.jsxs("div",{className:c("absolute z-10 flex flex-col gap-2",Se?"top-32 right-4":"top-4 right-16"),children:[t.jsx("button",{className:c("p-2 rounded-full shadow-md bg-white hover:bg-gray-100 transition-colors","disabled:opacity-50 disabled:cursor-not-allowed"),title:"Find my location",onClick:()=>{Ve(!0),"geolocation"in navigator?navigator.geolocation.getCurrentPosition((e=>{const{latitude:t,longitude:n}=e.coords;Be.current&&Be.current.remove();const s=(()=>{Re.current&&Re.current.remove();const e=document.createElement("div");e.className="location-marker",e.style.width="32px",e.style.height="32px",e.style.position="relative";const t=document.createElement("img");return t.src="/icons/iconloaction.png",t.style.width="100%",t.style.height="100%",t.style.objectFit="contain",e.appendChild(t),Re.current=e,e})();Be.current=new r.Marker({element:s,anchor:"center"}).setLngLat([n,t]).addTo(ne.current),ne.current?.flyTo({center:[n,t],zoom:14,duration:1500}),Ve(!1)}),(e=>{d({title:k("error"),description:"Oops! Couldn't find you. Are you using a teleporter? ðŸš€",variant:"destructive"}),Ve(!1)}),{enableHighAccuracy:!0,timeout:5e3,maximumAge:0}):(d({title:k("error"),description:"Looks like your device doesn't support location services. Time to get a new compass! ðŸ§­",variant:"destructive"}),Ve(!1))},disabled:Ie,children:t.jsx(E,{className:c("w-5 h-5 text-gray-700",Ie&&"animate-spin")})}),t.jsx("button",{className:c("p-2 rounded-full shadow-md bg-white hover:bg-gray-100 transition-colors","mapbox://styles/mapbox/streets-v12"===Le&&"ring-2 ring-blue-500"),title:"Streets view",onClick:()=>rt("mapbox://styles/mapbox/streets-v12"),children:t.jsx(S,{className:"w-5 h-5 text-gray-700"})}),t.jsx("button",{className:c("p-2 rounded-full shadow-md bg-white hover:bg-gray-100 transition-colors","mapbox://styles/mapbox/outdoors-v12"===Le&&"ring-2 ring-green-500"),title:"Nature view",onClick:()=>rt("mapbox://styles/mapbox/outdoors-v12"),children:t.jsx($,{className:"w-5 h-5 text-gray-700"})}),t.jsx("button",{className:c("p-2 rounded-full shadow-md bg-white hover:bg-gray-100 transition-colors","mapbox://styles/mapbox/satellite-streets-v12"===Le&&"ring-2 ring-purple-500"),title:"Satellite view",onClick:()=>rt("mapbox://styles/mapbox/satellite-streets-v12"),children:t.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-gray-700",children:[t.jsx("circle",{cx:"12",cy:"12",r:"10"}),t.jsx("circle",{cx:"12",cy:"12",r:"4"}),t.jsx("line",{x1:"4.93",y1:"4.93",x2:"9.17",y2:"9.17"}),t.jsx("line",{x1:"14.83",y1:"14.83",x2:"19.07",y2:"19.07"}),t.jsx("line",{x1:"14.83",y1:"9.17",x2:"19.07",y2:"4.93"}),t.jsx("line",{x1:"4.93",y1:"19.07",x2:"9.17",y2:"14.83"})]})}),t.jsx("button",{className:c("p-2 rounded-full shadow-md bg-white hover:bg-gray-100 transition-colors",Oe&&"ring-2 ring-red-500"),title:k("favorites.toggle"),onClick:()=>He(!Oe),children:t.jsx(M,{className:c("w-5 h-5",Oe?"text-red-500 fill-red-500":"text-gray-700")})}),t.jsx("button",{className:c("p-2 rounded-full shadow-md bg-white hover:bg-gray-100 transition-colors",qe&&"ring-2 ring-green-500"),title:k("pois.toggle"),onClick:()=>Ze(!qe),children:t.jsx(T,{className:c("w-5 h-5",qe?"text-green-500":"text-gray-700")})})]}),Se&&!Me&&t.jsx("div",{className:"absolute top-1/2 -translate-y-1/2 left-0 z-50",children:t.jsx("button",{onClick:()=>Te(!0),className:"bg-white rounded-r-lg shadow-lg border border-gray-200 p-3 flex items-center justify-center","aria-label":"Open sidebar",children:t.jsx(P,{className:"w-7 h-7 text-gray-700"})})}),"zaproad"===le?.type&&t.jsx("div",{className:c("absolute bottom-4 z-10 bg-white/90 rounded-lg shadow-md p-2",Se?"right-4 left-4 flex justify-center":"right-4"),children:t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsx("p",{className:"text-xs font-medium text-gray-500 mb-1",children:"Route type:"}),t.jsxs("div",{className:"flex gap-1",children:[t.jsx("button",{className:c("px-3 py-1 text-xs rounded-full transition-colors","driving"===_e?"bg-green-600 text-white":"bg-white text-gray-700"),onClick:()=>{Ee("driving"),le&&at(le)},children:"Driving"}),t.jsx("button",{className:c("px-3 py-1 text-xs rounded-full transition-colors","walking"===_e?"bg-green-600 text-white":"bg-white text-gray-700"),onClick:()=>{Ee("walking"),le&&at(le)},children:"Walking"}),t.jsx("button",{className:c("px-3 py-1 text-xs rounded-full transition-colors","cycling"===_e?"bg-green-600 text-white":"bg-white text-gray-700"),onClick:()=>{Ee("cycling"),le&&at(le)},children:"Cycling"})]})]})})]}),t.jsxs("div",{className:c("absolute top-0 left-0 h-full bg-white/90 backdrop-blur-sm shadow-lg z-30 overflow-hidden transition-all duration-300 ease-in-out flex flex-col",Se?Me?"w-full md:w-80 translate-x-0":"w-0 -translate-x-full":"w-80 translate-x-0"),onTouchStart:e=>{if(!Se)return;const t=e.target;t.closest('button[aria-label="Close sidebar"]')||t.closest("[data-radix-accordion-trigger]")||t.closest("[data-radix-accordion-item]")||t.closest('[role="button"]')||t.closest("button")||Ae(e.touches[0].clientX)},onTouchEnd:e=>{if(!Se||null===Pe)return;const t=e.target;if(t.closest('button[aria-label="Close sidebar"]')||t.closest("[data-radix-accordion-trigger]")||t.closest("[data-radix-accordion-item]")||t.closest('[role="button"]')||t.closest("button"))return void Ae(null);e.changedTouches[0].clientX-Pe<-50&&Me&&Te(!1),Ae(null)},children:[t.jsxs("div",{className:"p-4 border-b",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h1",{className:"text-2xl font-bold",children:k("dashboard")}),Se&&Me&&t.jsx("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),Te(!1)},className:"p-3 rounded-full hover:bg-gray-100 active:bg-gray-200 touch-manipulation","aria-label":"Close sidebar",style:{minWidth:"44px",minHeight:"44px"},children:t.jsx(A,{className:"w-6 h-6 text-gray-500"})})]}),t.jsxs("div",{className:c("flex flex-wrap gap-2 mt-5",Se&&"justify-center"),children:[t.jsx("button",{onClick:()=>ze(null),className:c("px-3 py-1 text-xs rounded-full transition-colors",Ne?"bg-gray-100 text-gray-700 hover:bg-gray-200":"bg-gray-800 text-white"),children:"All"}),t.jsxs("button",{onClick:()=>ze("zapout"),className:c("px-3 py-1 text-xs rounded-full transition-colors flex items-center","zapout"===Ne?"bg-emerald-600 text-white":"bg-emerald-100 text-emerald-700 hover:bg-emerald-200"),children:[t.jsx(z,{className:"w-3 h-3 mr-1"}),"Zapout"]}),t.jsxs("button",{onClick:()=>ze("zaproad"),className:c("px-3 py-1 text-xs rounded-full transition-colors flex items-center","zaproad"===Ne?"bg-amber-600 text-white":"bg-amber-100 text-amber-700 hover:bg-amber-200"),children:[t.jsx(L,{className:"w-3 h-3 mr-1"}),"Zaproad"]}),t.jsxs("button",{onClick:()=>ze("zaptrip"),className:c("px-3 py-1 text-xs rounded-full transition-colors flex items-center","zaptrip"===Ne?"bg-sky-600 text-white":"bg-sky-100 text-sky-700 hover:bg-sky-200"),children:[t.jsx(C,{className:"w-3 h-3 mr-1"}),"Zaptrip"]})]})]}),t.jsxs("div",{className:c("flex-1 overflow-y-auto p-2 sidebar-content",Se&&"pb-24"),children:[t.jsx(q,{children:Ne?et.filter((e=>e.type===Ne)).map((e=>t.jsx(Z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,x:-100},transition:{duration:.2},className:c("mb-3 p-3 rounded-lg shadow-sm cursor-pointer transition-all",le?.id===e.id&&le?.type===e.type?"ring-2 bg-white":"bg-white/70 hover:bg-white","zapout"===e.type&&"ring-emerald-500 hover:ring-1","zaproad"===e.type&&"ring-amber-500 hover:ring-1","zaptrip"===e.type&&"ring-sky-500 hover:ring-1"),onClick:()=>st(e),children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsxs("div",{className:c("w-10 h-10 rounded-full flex items-center justify-center text-white","zapout"===e.type&&"bg-emerald-500","zaproad"===e.type&&"bg-amber-500","zaptrip"===e.type&&"bg-sky-500"),children:["zapout"===e.type&&t.jsx(z,{className:"w-5 h-5"}),"zaproad"===e.type&&t.jsx(L,{className:"w-5 h-5"}),"zaptrip"===e.type&&t.jsx(C,{className:"w-5 h-5"})]}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h3",{className:"font-medium text-gray-900 truncate",children:e.title}),t.jsx("p",{className:"text-sm text-gray-500 truncate",children:"zaproad"===e.type&&e.starting_city&&e.end_city?`${e.starting_city} â†’ ${e.end_city}`:e.location||"No location"}),t.jsxs("div",{className:"mt-2 flex justify-between items-center",children:[t.jsx("span",{className:"text-xs text-gray-400",children:new Date(e.created_at).toLocaleDateString()}),t.jsxs("div",{className:"flex gap-1",children:[t.jsx(s,{variant:"outline",size:"sm",className:"text-xs h-7 w-7 p-0",onClick:t=>{t.stopPropagation(),ot(e)},title:"View Details",children:t.jsxs("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),t.jsx(s,{variant:"outline",size:"sm",className:"text-xs h-7 w-7 p-0",onClick:t=>{t.stopPropagation(),st(e)},title:"Show on Map",children:t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})})})]})]})]})]})},`${e.type}-${e.id}`))):t.jsx(o,{type:"multiple",className:"w-full",value:Qe,onValueChange:Ye,children:ht.map((e=>t.jsxs(a,{value:e,className:"border-none",children:[t.jsx(i,{className:"px-3 py-3 hover:no-underline hover:bg-gray-50 rounded-lg transition-colors touch-manipulation min-h-[44px] w-full text-left",style:{minHeight:"44px",WebkitTapHighlightColor:"transparent",touchAction:"manipulation"},children:t.jsxs("div",{className:"flex items-center gap-3 w-full",children:[t.jsx(I,{className:"w-4 h-4 text-gray-500"}),t.jsxs("div",{className:"flex-1 text-left",children:[t.jsx("span",{className:"font-semibold text-gray-700 text-sm",children:e}),t.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(",xt[e].length,")"]})]})]})}),t.jsx(l,{className:"pt-2",style:{touchAction:"pan-y"},children:t.jsx("div",{className:"space-y-3",children:t.jsx(q,{children:xt[e].map((e=>t.jsx(Z.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,x:-100},transition:{duration:.2},className:c("p-3 rounded-lg shadow-sm cursor-pointer transition-all",le?.id===e.id&&le?.type===e.type?"ring-2 bg-white":"bg-white/70 hover:bg-white","zapout"===e.type&&"ring-emerald-500 hover:ring-1","zaproad"===e.type&&"ring-amber-500 hover:ring-1","zaptrip"===e.type&&"ring-sky-500 hover:ring-1"),onClick:()=>st(e),children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsxs("div",{className:c("w-10 h-10 rounded-full flex items-center justify-center text-white","zapout"===e.type&&"bg-emerald-500","zaproad"===e.type&&"bg-amber-500","zaptrip"===e.type&&"bg-sky-500"),children:["zapout"===e.type&&t.jsx(z,{className:"w-5 h-5"}),"zaproad"===e.type&&t.jsx(L,{className:"w-5 h-5"}),"zaptrip"===e.type&&t.jsx(C,{className:"w-5 h-5"})]}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h3",{className:"font-medium text-gray-900 truncate",children:e.title}),t.jsx("p",{className:"text-sm text-gray-500 truncate",children:"zaproad"===e.type&&e.starting_city&&e.end_city?`${e.starting_city} â†’ ${e.end_city}`:e.location||"No location"}),t.jsxs("div",{className:"mt-2 flex justify-between items-center",children:[t.jsx("span",{className:"text-xs text-gray-400",children:new Date(e.created_at).toLocaleDateString()}),t.jsxs("div",{className:"flex gap-1",children:[t.jsx(s,{variant:"outline",size:"sm",className:"text-xs h-7 w-7 p-0",onClick:t=>{t.stopPropagation(),ot(e)},title:"View Details",children:t.jsxs("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),t.jsx(s,{variant:"outline",size:"sm",className:"text-xs h-7 w-7 p-0",onClick:t=>{t.stopPropagation(),st(e)},title:"Show on Map",children:t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})})})]})]})]})]})},`${e.type}-${e.id}`)))})})})]},e)))})}),tt.length>0&&t.jsxs("div",{className:c("mt-6 border-t pt-4",Se&&"mb-8"),children:[t.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.jsx(M,{className:"w-4 h-4 text-red-500"}),t.jsx("h3",{className:"font-medium text-gray-900",children:k("favorites.title")}),t.jsx("span",{className:"text-xs bg-red-100 text-red-600 px-2 py-1 rounded-full",children:tt.length})]}),t.jsx(o,{type:"multiple",className:"w-full",children:Object.entries(ut).map((([e,r])=>t.jsxs(a,{value:e,className:"border-none",children:[t.jsx(i,{className:"px-3 py-3 hover:no-underline hover:bg-gray-50 rounded-lg transition-colors touch-manipulation min-h-[44px] w-full text-left",style:{minHeight:"44px",WebkitTapHighlightColor:"transparent",touchAction:"manipulation"},children:t.jsxs("div",{className:"flex items-center gap-3 w-full",children:[t.jsx("div",{className:c("w-8 h-8 rounded-full flex items-center justify-center text-white",vt(e)),children:gt(e)}),t.jsxs("div",{className:"flex-1 text-left",children:[t.jsx("span",{className:"font-medium text-gray-900",children:yt(e)}),t.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(",r.length,")"]})]})]})}),t.jsx(l,{className:"pt-2",style:{touchAction:"pan-y"},children:t.jsx("div",{className:"space-y-2",children:t.jsx(q,{children:r.map((e=>t.jsx(Z.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,x:-50},transition:{duration:.2},className:"p-3 rounded-lg shadow-sm bg-white/70 hover:bg-white transition-all border border-gray-100 cursor-pointer hover:shadow-md",onClick:()=>(e=>{if(!ne.current||!e.place_lat||!e.place_lng)return;ne.current.flyTo({center:[e.place_lng,e.place_lat],zoom:15,duration:2e3,essential:!0});const t=ae.current.find((t=>{const r=t.getLngLat();return r.lng===e.place_lng&&r.lat===e.place_lat}));t&&(t.getElement().style.transform="scale(1.2)",setTimeout((()=>{t.getElement().style.transform="scale(1)"}),200))})(e),children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:"w-8 h-8 rounded-full bg-red-500 flex items-center justify-center text-white",children:t.jsx(M,{className:"w-4 h-4"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h4",{className:"font-medium text-gray-900 truncate text-sm",children:e.place_name}),t.jsx("p",{className:"text-xs text-gray-500 truncate",children:e.place_address}),e.place_rating&&t.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[t.jsx("span",{className:"text-yellow-500 text-xs",children:"â˜…"}),t.jsx("span",{className:"text-xs text-gray-600",children:e.place_rating.toFixed(1)})]}),t.jsxs("div",{className:"mt-2 flex gap-1",children:[t.jsx(s,{variant:"outline",size:"sm",className:"text-xs h-6 w-6 p-0",onClick:t=>{t.stopPropagation(),window.open(J(e.place_id,e.place_name,"en"),"_blank")},title:k("favorites.viewDetails"),children:t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})}),t.jsx(s,{variant:"outline",size:"sm",className:"text-xs h-6 w-6 p-0 text-green-600 border-green-200 hover:bg-green-50",onClick:t=>{t.stopPropagation(),ft(e)},title:k("pois.directions"),children:t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"})})}),t.jsx(s,{variant:"outline",size:"sm",className:"text-xs h-6 w-6 p-0 text-red-600 border-red-200 hover:bg-red-50",onClick:t=>{t.stopPropagation(),dt(e.id)},title:k("favorites.remove"),children:t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})]})},e.id)))})})})]},e)))})]}),0===et.length&&!pe&&t.jsxs("div",{className:c("flex flex-col items-center justify-center p-6 h-60",Se&&"mb-8"),children:[t.jsx("div",{className:"bg-gray-100 p-4 rounded-full mb-4",children:t.jsx(z,{className:"w-8 h-8 text-gray-400"})}),t.jsx("h3",{className:"text-lg font-medium text-gray-700 mb-1",children:"No trips found"}),t.jsx("p",{className:"text-sm text-gray-500 text-center",children:"Start by creating a new adventure"})]})]})]}),t.jsx(x,{poi:we,isOpen:Ue,onClose:()=>{Xe(!1),ke(null)},onSubmit:async(e,t,r)=>{await Ke(e,t,r)}})]})};export{K as default};
//# sourceMappingURL=page-mapdashboard.CQZ4zyKz.js.map
