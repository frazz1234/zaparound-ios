import{r as e,j as o}from"../vendor/vendor-react-core.D1hcyiwY.js";import{b as r,d as t,R as n}from"../components/components-blog.C3TFiFB1.js";import{S as s}from"../components/components-seo.tsx.Dk-lg3q2.js";import{s as i}from"../components/components-admin.CiIAoamg.js";import{c as d}from"../utils/utils-blogutils.ts.CpQs8y27.js";import{u as a}from"../vendor/vendor--react-i18next.DhHVfoav.js";import{a as m}from"../vendor/vendor--react-router.Gdfmkz0l.js";import"../vendor/vendor--cookie.D-6orQ43.js";import"../components/components-ui.C8hnNhgu.js";import"../hooks/hooks-use-toast.ts.Dg8obzHg.js";import"../vendor/vendor-ui-toast.CyvsGWN1.js";import"../vendor/vendor-react-dom.BnDkh-2X.js";import"../vendor/vendor-react-scheduler.B5Ht9ZB3.js";import"../vendor/vendor-ui-core.CPnW5LH0.js";import"../vendor/vendor--aria-hidden.BHUiN-rI.js";import"../vendor/vendor--react-remove-scroll.DR6iVcCg.js";import"../vendor/vendor--tslib.Bc9CN1Ef.js";import"../vendor/vendor--react-remove-scroll-bar.Dz-JErv0.js";import"../vendor/vendor--react-style-singleton.ER5nEGYx.js";import"../vendor/vendor--get-nonce.BYiZHLe3.js";import"../vendor/vendor--use-sidecar.svB0tWl8.js";import"../vendor/vendor--use-callback-ref.Dt9orvWx.js";import"../vendor/vendor---floating-ui-react-dom.gDT63CuY.js";import"../vendor/vendor---floating-ui-dom.CdGDzP9A.js";import"../vendor/vendor---floating-ui-core.D6mclMLM.js";import"../vendor/vendor---floating-ui-utils.D9HCu73I.js";import"../vendor/vendor-ui-dialog.CY7OxuK6.js";import"../vendor/vendor-ui-utils.CjDQ2U02.js";import"../vendor/vendor--lucide-react.DRw9PYsu.js";import"../vendor/vendor-ui-tooltip.n7I39vTs.js";import"../vendor/vendor--embla-carousel-react.Bc6nB0ya.js";import"../vendor/vendor--embla-carousel-reactive-utils.BIRN7lq8.js";import"../vendor/vendor--embla-carousel.clUl8sxa.js";import"../vendor/vendor--cmdk.q6oiTfmV.js";import"../vendor/vendor--react-day-picker.D6HWAs9M.js";import"../vendor/vendor--date-fns.BbAlDtqN.js";import"../vendor/vendor--react-hook-form.C68mK_Ba.js";import"../utils/utils-cache.ts.BtmNadnX.js";import"../vendor/vendor--lru-cache.CYB7PIxo.js";import"../components/components-optimizedimage.tsx.DVN-Ynzu.js";import"../hooks/hooks-useblogs.ts.B-jKAetY.js";import"../vendor/vendor-query-main.DFU6mXji.js";import"../vendor/vendor---tanstack-query-core.CIZi0Zbo.js";import"../vendor/vendor--lodash.D80NHDHN.js";import"../vendor/vendor--framer-motion.Dpgjd5L1.js";import"../vendor/vendor--motion-dom.C5KZPrWP.js";import"../vendor/vendor--motion-utils.DAP8mxSY.js";import"../vendor/vendor--react-markdown.C_e4o-CH.js";import"../vendor/vendor--devlop.Cl3hj7Sz.js";import"../vendor/vendor--unified.ti5-l0IV.js";import"../vendor/vendor--bail.gCPcOVbC.js";import"../vendor/vendor--extend.BFvm699q.js";import"../vendor/vendor--is-plain-obj.DeEdtHJQ.js";import"../vendor/vendor--trough.zzWXwSIo.js";import"../vendor/vendor--vfile.Cn6Vy3Ir.js";import"../vendor/vendor--vfile-message.Re42m5o3.js";import"../vendor/vendor--unist-util-stringify-position.CvSG9YTx.js";import"../vendor/vendor--remark-parse.DdoJrvcY.js";import"../vendor/vendor--mdast-util-from-markdown.DI8nvaYJ.js";import"../vendor/vendor--micromark-util-decode-numeric-character-reference.DA7xEauU.js";import"../vendor/vendor--micromark-util-decode-string.BCF2SQ7o.js";import"../vendor/vendor--decode-named-character-reference.C-EXV6yX.js";import"../vendor/vendor--micromark-util-normalize-identifier.CzKtq1sx.js";import"../vendor/vendor--micromark.aJPyxAJv.js";import"../vendor/vendor--micromark-util-combine-extensions.CQDa_SAq.js";import"../vendor/vendor--micromark-util-chunked.3k3e5hER.js";import"../vendor/vendor--micromark-factory-space.CZc9TqN4.js";import"../vendor/vendor--micromark-util-character.DUwsRT9L.js";import"../vendor/vendor--micromark-core-commonmark.yO25BTZZ.js";import"../vendor/vendor--micromark-util-classify-character.x6FlXUUS.js";import"../vendor/vendor--micromark-util-resolve-all.U8fstr8o.js";import"../vendor/vendor--micromark-util-subtokenize.BfHYzAYP.js";import"../vendor/vendor--micromark-factory-destination.pZKs7oL9.js";import"../vendor/vendor--micromark-factory-label.BbusvwMx.js";import"../vendor/vendor--micromark-factory-title.BBtcOUHM.js";import"../vendor/vendor--micromark-factory-whitespace.BhZ6YKME.js";import"../vendor/vendor--micromark-util-html-tag-name.DbKNfynz.js";import"../vendor/vendor--mdast-util-to-string.Ck87fAyN.js";import"../vendor/vendor--remark-rehype.B9Xnklpv.js";import"../vendor/vendor--mdast-util-to-hast.C2F2cLDR.js";import"../vendor/vendor---ungap-structured-clone.DadG6O39.js";import"../vendor/vendor--micromark-util-sanitize-uri.BXHzaaAi.js";import"../vendor/vendor--unist-util-position.CVUg9P9R.js";import"../vendor/vendor--trim-lines.C03Dth7Y.js";import"../vendor/vendor--unist-util-visit.41WSH7so.js";import"../vendor/vendor--unist-util-visit-parents.DAGCrDnu.js";import"../vendor/vendor--unist-util-is.C5Jwnfs7.js";import"../vendor/vendor--hast-util-to-jsx-runtime.BOWXXjuU.js";import"../vendor/vendor--comma-separated-tokens.DIu3lqJt.js";import"../vendor/vendor--property-information.Dc64tFtG.js";import"../vendor/vendor--space-separated-tokens.C97BfSlU.js";import"../vendor/vendor--style-to-js.DQsO4XA8.js";import"../vendor/vendor--style-to-object.DGZeIPGP.js";import"../vendor/vendor--inline-style-parser.BFz9PO4J.js";import"../vendor/vendor--hast-util-whitespace.DlJMGLAz.js";import"../vendor/vendor--estree-util-is-identifier-name.0h9-8Xae.js";import"../vendor/vendor--html-url-attributes.BA_i5Yxb.js";import"../vendor/vendor--react-helmet-async.BMUx00aU.js";import"../vendor/vendor--react-fast-compare.4d-J074I.js";import"../vendor/vendor--invariant.D6mx6rc7.js";import"../vendor/vendor--shallowequal.BwnEDCFe.js";import"../vendor/vendor--web-vitals.C1BoAgs7.js";import"../vendor/vendor---hookform-resolvers.CwYzTTZs.js";import"../vendor/vendor--zod.Cebk8UiH.js";import"../vendor/vendor-supabase-client.BJD0U0P8.js";import"../vendor/vendor-supabase-other.BhmW1H_P.js";import"../components/components-mobilenavigation.tsx.DtMtI5i3.js";import"../components/components-languagerouter.tsx.CHVsY7fH.js";import"../vendor/vendor--i18next.CHTa0CEF.js";import"../vendor/vendor--i18next-browser-languagedetector.h4x3AYwK.js";import"../vendor/vendor--i18next-http-backend.DjHzioAf.js";import"../hooks/hooks-useuserrole.ts.BKHSjdY6.js";import"../components/components-languageselector.tsx.x8buceJ0.js";import"../components/components-navigation.CB-8LlfF.js";import"../components/components-theme-toggle.tsx.CfzjOSrj.js";import"../components/components-theme-provider.tsx.Cd7zUHTE.js";import"../vendor/vendor-supabase-realtime.PMyDaGD3.js";import"../vendor/vendor--sonner.ECaEf7Ie.js";import"../hooks/hooks-useadminauth.ts.BJ7uhFTt.js";const c=new class{cache=new Map;DEFAULT_TTL=3e5;set(e,o,r=this.DEFAULT_TTL){this.cache.set(e,{data:o,timestamp:Date.now(),ttl:r})}get(e){const o=this.cache.get(e);return o?Date.now()-o.timestamp>o.ttl?(this.cache.delete(e),null):o.data:null}invalidate(e){e?Array.from(this.cache.keys()).filter((o=>o.includes(e))).forEach((e=>this.cache.delete(e))):this.cache.clear()}has(e){const o=this.cache.get(e);return null!==o&&Date.now()-o.timestamp<=o.ttl}};function l(e,o){const r={operation:o,code:e?.code,message:e?.message,details:e?.details,hint:e?.hint};return"406"===e?.code?{blogs:[],count:0,totalPages:0,error:{type:"CONTENT_NEGOTIATION",message:"API content negotiation issue",...r}}:"PGRST116"===e?.code?{blogs:[],count:0,totalPages:0,error:{type:"NOT_FOUND",message:"No matching records found",...r}}:{blogs:[],count:0,totalPages:0,error:{type:"UNKNOWN",message:"An unexpected error occurred",...r}}}function v(){const{lang:v,blogSlug:p}=m(),{t:u}=a("blog"),j=v||"en",h="en"===j?"en_US":"fr"===j?"fr_FR":"es_ES",[g,f]=e.useState(null),[b,k]=e.useState([]),[x,y]=e.useState(!0),[w,N]=e.useState(!1);return e.useEffect((()=>{(async()=>{if(p)try{const{blogs:e}=await async function(e=1,o=10,r={}){const{includeUnpublished:t=!1,orderBy:n="published_at",orderDirection:s="desc"}=r,d=(e-1)*o,a=d+o-1,m=`blogs-${e}-${o}-${t}-${n}-${s}`,v=c.get(m);if(v)return v;try{let e=i.from("blogs").select("*",{count:"exact"});t||(e=e.eq("is_published",!0)),e=e.order(n,{ascending:"asc"===s}).range(d,a);const{data:r,error:v,count:p}=await e;if(v)return l(v,"getEnhancedBlogs");const u={blogs:r||[],count:p||0,totalPages:Math.ceil((p||0)/o)};return c.set(m,u),u}catch(p){return l(p,"getEnhancedBlogs")}}(1,100,{includeUnpublished:!1,orderBy:"published_at"}),o=e.find((e=>e.slug===p));if(o)f(o);else{let e=null;const{data:o,error:r}=await i.from("blogs").select("*").eq("slug",p).eq("is_published",!0);if(!r&&o&&o.length>0)e=o[0];else{const{data:o,error:r}=await i.from("blogs").select("*").eq("is_published",!0);if(!r&&o){const r=o.find((e=>(e.title_en?d(e.title_en):null)===p));r&&(e=r)}if(!e&&p&&p.length>10){const{data:o,error:r}=await i.from("blogs").select("*").eq("id",p).eq("is_published",!0);!r&&o&&o.length>0&&(e=o[0])}}f(e||null)}}catch(e){f(null)}finally{y(!1)}})()}),[p,j]),e.useEffect((()=>{(async()=>{if(g?.id){N(!0);try{const e=await async function(e,o,r,t=5){const n=`related-${e}-${o}-${r?.join(",")}-${t}`,s=c.get(n);if(s)return s;try{let s=i.from("blogs").select("*").eq("is_published",!0).neq("id",e);o&&(s=s.eq("category",o)),r&&r.length>0&&(s=s.overlaps("activities",r)),s=s.order("published_at",{ascending:!1}).limit(t);const{data:d,error:a}=await s;if(a)return{blogs:[],error:a};const m={blogs:d||[]};return c.set(n,m),m}catch(d){return{blogs:[],error:d}}}(g.id,g.category,g.activities||[],4);k(e)}catch(e){k([])}finally{N(!1)}}})()}),[g]),x?o.jsx("div",{className:"min-h-screen flex items-center justify-center",children:o.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-gray-900"})}):!g||g.notFound?o.jsxs(o.Fragment,{children:[o.jsx(s,{title:"Blog Post Not Found - ZapAround",description:"The blog post you're looking for doesn't exist.",noindex:!0,nofollow:!0,url:`/${j}/blog/${p}`,locale:h}),o.jsx("div",{className:"min-h-screen flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("h1",{className:"text-2xl font-bold mb-4",children:u("error.notFound")}),o.jsx("p",{className:"text-gray-600 mb-6",children:u("error.notFoundDescription")}),o.jsxs("a",{href:`/${j}/blog`,className:"inline-flex items-center px-4 py-2 bg-primary text-white rounded-md hover:bg-primary/90 transition-colors",children:["← ",u("detail.backToList")]})]})})]}):o.jsxs(o.Fragment,{children:[o.jsx(r,{blog:g,locale:h,url:`/${j}/blog/${p}`}),o.jsxs("div",{className:"container mx-auto px-4 py-8",children:[o.jsx(t,{}),g&&o.jsx("div",{className:"mt-16",children:o.jsx(n,{currentBlog:g,relatedBlogs:b,isLoading:w})})]})]})}export{v as default};
//# sourceMappingURL=page-blogpost.MUThbTON.js.map
