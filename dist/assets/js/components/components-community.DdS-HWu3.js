import{r as e,j as s}from"../vendor/vendor-react-core.D1hcyiwY.js";import{B as t,G as a,J as l,ac as i,ad as n,ae as r,V as c,af as o,ag as d,a4 as m,I as u}from"./components-ui.C8hnNhgu.js";import{c as x,g as h,s as p}from"./components-blog.C3TFiFB1.js";import{u as g}from"../vendor/vendor--react-i18next.DhHVfoav.js";import{I as f,w as v,x as j,y as b,X as y,n as N,o as w,z as k,J as _,M as C,s as S,K as L,L as z,N as E,f as M,S as F,O as P,Q as T,V as A}from"../vendor/vendor--lucide-react.DRw9PYsu.js";import{c as R}from"../utils/utils-placeutils.ts.vo-R8UHO.js";import{u as q}from"../vendor/vendor--react-router.Gdfmkz0l.js";import{s as I}from"./components-admin.CiIAoamg.js";import{f as V}from"../vendor/vendor--date-fns.BbAlDtqN.js";import{m as O}from"../vendor/vendor--framer-motion.Dpgjd5L1.js";import{u as U}from"../hooks/hooks-use-toast.ts.Dg8obzHg.js";const B=({onMediaChange:a,maxFiles:l=10,className:i,disabled:n=!1})=>{const{t:r}=g("community"),[c,o]=e.useState([]),[d,m]=e.useState(null),u=e.useRef(null),h=(e,l)=>{const i=d===e.id;return s.jsxs("div",{className:x("relative group overflow-hidden rounded-lg bg-gray-100",1===c.length?"aspect-video":"aspect-square",2===c.length?"aspect-video":"",3===c.length&&0===l?"col-span-2 row-span-2 aspect-video":"",4===c.length?"aspect-square":"",c.length>4&&0===l?"col-span-2 row-span-2 aspect-video":""),children:["image"===e.type?s.jsx("img",{src:e.preview,alt:"Preview",className:"w-full h-full object-cover"}):s.jsx("video",{src:e.preview,className:"w-full h-full object-cover",muted:!0,loop:!0,playsInline:!0,ref:e=>{e&&(i?e.play().catch((()=>{})):e.pause())}}),s.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 transition-all duration-200 flex items-center justify-center",children:"video"===e.type&&s.jsx(t,{variant:"ghost",size:"sm",className:"opacity-0 group-hover:opacity-100 transition-opacity duration-200 bg-white/20 hover:bg-white/30 text-white",onClick:()=>{return s=e.id,void m(d===s?null:s);var s},children:i?s.jsx(j,{className:"h-4 w-4"}):s.jsx(b,{className:"h-4 w-4"})})}),s.jsx(t,{variant:"ghost",size:"sm",className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity duration-200 bg-red-500 hover:bg-red-600 text-white h-6 w-6 p-0",onClick:()=>(e=>{const s=c.filter((s=>s.id!==e));o(s),a(s),d===e&&m(null)})(e.id),children:s.jsx(y,{className:"h-3 w-3"})}),s.jsx("div",{className:"absolute bottom-2 left-2 bg-black/50 text-white text-xs px-2 py-1 rounded",children:"video"===e.type?r("media.video"):r("media.image")})]},e.id)};return s.jsxs("div",{className:x("space-y-4",i),children:[c.length<l&&s.jsxs(t,{type:"button",variant:"outline",className:"flex items-center gap-2",disabled:n,onClick:()=>u.current?.click(),children:[s.jsx(f,{className:"h-4 w-4"}),s.jsx("span",{className:"hidden sm:inline",children:r("media.addPhotosVideos")})]}),s.jsx("input",{ref:u,type:"file",multiple:!0,accept:"image/*,video/*",className:"hidden",onChange:e=>{const s=Array.from(e.target.files||[]);if(c.length+s.length>l)return void alert(r("media.maxFilesExceeded",{max:l}));const t=[];s.forEach((e=>{const s=e.type.startsWith("image/"),a=e.type.startsWith("video/");if(!s&&!a)return void alert(r("media.invalidFileType",{filename:e.name}));const l=a?52428800:10485760;if(e.size>l)return void alert(r(a?"media.fileTooLargeVideo":"media.fileTooLargeImage",{filename:e.name}));const i=Math.random().toString(36).substr(2,9),n=URL.createObjectURL(e);t.push({id:i,file:e,preview:n,type:s?"image":"video"})}));const i=[...c,...t];o(i),a(i)},disabled:n}),c.length>0&&s.jsxs("div",{className:x("grid gap-2",(p=c.length,1===p?"grid-cols-1":2===p?"grid-cols-2":3===p?"grid-cols-3":4===p?"grid-cols-2 grid-rows-2":"grid-cols-3 grid-rows-2")),children:[c.map(((e,s)=>h(e,s))),c.length>5&&s.jsx("div",{className:"relative aspect-square bg-gray-100 rounded-lg flex items-center justify-center",children:s.jsx("div",{className:"absolute inset-0 bg-black/50 rounded-lg flex items-center justify-center",children:s.jsxs("div",{className:"text-white text-center",children:[s.jsx(v,{className:"h-8 w-8 mx-auto mb-2"}),s.jsx("p",{className:"text-sm font-medium",children:r("media.moreFiles",{count:c.length-5})})]})})})]}),c.length>0&&s.jsx("p",{className:"text-sm text-gray-500",children:r("media.filesSelected",{count:c.length,max:l})})]});var p},H=({media:i,className:n,maxPreview:r=5})=>{const[c,o]=e.useState(null),[d,m]=e.useState(null),[u,h]=e.useState({}),p=e.useRef({}),g=e.useRef(null),f=e.useRef(null),v=e.useRef(!1);let C=[];if(Array.isArray(i)?C=i:"string"==typeof i&&""!==i.trim()&&(C=[{id:"legacy-image",url:i,type:"image"}]),!C||0===C.length)return null;const S=()=>{o(null),m(null)},L=e=>{if(null===c)return;const s="prev"===e?(c-1+C.length)%C.length:(c+1)%C.length;o(s),m(null)},z=e=>{m(d===e?null:e)},E=(e,s,t)=>{const a=u[t.id]||("video"===t.type?"landscape":void 0);let l=["relative","group","overflow-hidden","rounded-lg","bg-gray-100","cursor-pointer","w-full","h-full"];return 1===s?l.push("portrait"===a?"aspect-[4/5]":"square"===a?"aspect-square":"aspect-video"):2===s?l.push("portrait"===a?"aspect-[4/5]":"aspect-[4/3]"):3===s?0===e?(l.push("row-span-2"),l.push("portrait"===a?"aspect-[3/4]":"aspect-[4/3]")):l.push("aspect-square"):4===s?l.push("aspect-square"):0===e?(l.push("col-span-2","row-span-2"),l.push("portrait"===a?"aspect-[3/4]":"aspect-video")):l.push("aspect-square"),l.join(" ")},M=(e,a)=>{const l=d===e.id,i="video"===e.type;return s.jsxs("div",{className:E(a,Math.min(C.length,r),e),onClick:()=>(e=>{o(e),m(null)})(a),children:[i?s.jsx("video",{ref:s=>{p.current[e.id]=s},src:e.url,poster:e.thumbnail,className:"w-full h-full object-cover",muted:!0,loop:!0,playsInline:!0,onPlay:()=>m(e.id),onPause:()=>m(null)}):s.jsx("img",{src:e.url,alt:"Media content",className:"w-full h-full object-cover",onLoad:(n=e.id,e=>{const s=e.currentTarget,{naturalWidth:t,naturalHeight:a}=s;if(!t||!a)return;const l=t/a,i=1===l?"square":l>1?"landscape":"portrait";h((e=>e[n]?e:{...e,[n]:i}))})}),s.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 transition-all duration-200 flex items-center justify-center",children:i&&s.jsx(t,{variant:"ghost",size:"sm",className:"opacity-0 group-hover:opacity-100 transition-opacity duration-200 bg-white/20 hover:bg-white/30 text-white",onClick:s=>{s.stopPropagation(),z(e.id)},children:l?s.jsx(j,{className:"h-4 w-4"}):s.jsx(b,{className:"h-4 w-4"})})}),i&&s.jsxs("div",{className:"absolute top-2 left-2 bg-black/50 text-white text-xs px-2 py-1 rounded flex items-center gap-1",children:[s.jsx(b,{className:"h-3 w-3"}),"VIDEO"]}),a===r-1&&C.length>r&&s.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center",children:s.jsxs("div",{className:"text-white text-center",children:[s.jsxs("p",{className:"text-lg font-bold",children:["+",C.length-r]}),s.jsx("p",{className:"text-sm",children:"more"})]})})]},e.id);var n},F=C.slice(0,r);return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:x("grid gap-2 auto-rows-[120px] sm:auto-rows-[160px]",(P=F.length,1===P?"grid-cols-1":2===P?"grid-cols-2":3===P||4===P?"grid-cols-2 grid-rows-2":"grid-cols-3 grid-rows-2"),n),children:F.map(((e,s)=>M(e,s)))}),s.jsx(a,{open:null!==c,onOpenChange:S,children:s.jsx(l,{className:"max-w-none w-screen h-[100dvh] p-0 bg-black sm:bg-[#fcfcfc] border-0 shadow-none rounded-none overflow-hidden",children:s.jsxs("div",{className:"relative w-full h-full flex items-center justify-center bg-black",onTouchStart:e=>{if(C.length<=1)return;const s=e.touches[0];g.current=s.clientX,f.current=s.clientY,v.current=!1},onTouchMove:e=>{if(null===g.current||null===f.current)return;const s=e.touches[0],t=s.clientX-g.current,a=s.clientY-f.current;Math.abs(t)>10&&Math.abs(t)>Math.abs(a)&&(v.current=!0,e.preventDefault())},onTouchEnd:e=>{if(null===g.current||null===f.current)return;const s=e.changedTouches[0],t=s.clientX-g.current,a=s.clientY-f.current;Math.abs(t)>Math.abs(a)&&Math.abs(t)>50&&L(t>0?"prev":"next"),g.current=null,f.current=null,v.current=!1},style:{touchAction:"pan-y"},children:[s.jsx(t,{variant:"ghost",size:"sm",className:"absolute top-4 left-4 z-10 bg-black/60 hover:bg-black/70 text-white",onClick:S,children:s.jsx(y,{className:"h-4 w-4"})}),C.length>1&&s.jsxs(s.Fragment,{children:[s.jsx(t,{variant:"ghost",size:"sm",className:"absolute top-1/2 left-4 z-10 bg-black/60 hover:bg-black/70 text-white transform -translate-y-1/2",onClick:()=>L("prev"),children:s.jsx(N,{className:"h-6 w-6"})}),s.jsx(t,{variant:"ghost",size:"sm",className:"absolute top-1/2 right-4 z-10 bg-black/60 hover:bg-black/70 text-white transform -translate-y-1/2",onClick:()=>L("next"),children:s.jsx(w,{className:"h-6 w-6"})})]}),null!==c&&((e,a)=>{const l=d===e.id,i="video"===e.type;return s.jsxs("div",{className:"relative w-full h-full flex items-center justify-center",children:[i?s.jsx("video",{ref:s=>{p.current[e.id]=s},src:e.url,poster:e.thumbnail,className:"block max-w-[100svw] max-h-[100svh] w-auto h-auto object-contain",controls:!0,autoPlay:l,onPlay:()=>m(e.id),onPause:()=>m(null)}):s.jsx("img",{src:e.url,alt:"Media content",className:"block max-w-[100svw] max-h-[100svh] w-auto h-auto object-contain",draggable:!1}),s.jsxs("div",{className:"absolute top-4 right-4 flex gap-2",children:[s.jsx(t,{variant:"ghost",size:"sm",className:"bg-black/50 hover:bg-black/70 text-white",onClick:()=>{const s=document.createElement("a");s.href=e.url,s.download=`media-${a+1}`,s.click()},children:s.jsx(k,{className:"h-4 w-4"})}),s.jsx(t,{variant:"ghost",size:"sm",className:"bg-black/50 hover:bg-black/70 text-white",onClick:()=>{i?z(e.id):window.open(e.url,"_blank")},children:s.jsx(_,{className:"h-4 w-4"})})]})]},e.id)})(C[c],c),s.jsxs("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 bg-black/50 text-white px-3 py-1 rounded-full text-sm",children:[null!==c?c+1:0," / ",C.length]})]})})})]});var P},D=({location:e,placeId:t,placeLat:a,placeLng:l,placeTypes:i,placeRating:n,placeUserRatingsTotal:r,className:c,place:o})=>{const{t:d}=g("community"),m=q();if(!e)return null;const u=e=>{if(!e||0===e.length)return null;const s={restaurant:"Restaurant",food:"Food",tourist_attraction:"Tourist Attraction",point_of_interest:"Point of Interest",lodging:"Lodging",hotel:"Hotel",shopping_mall:"Shopping Mall",store:"Store",park:"Park",natural_feature:"Natural Feature",museum:"Museum",amusement_park:"Amusement Park",entertainment:"Entertainment"};for(const t of e)if(s[t])return s[t];return null},h=t&&a&&l,p=o&&o.place_id,f=()=>{if(p){const e=R(o.place_id,o.name);m(e,{state:{placeId:o.place_id,name:o.name,lat:o.geometry?.location?.lat,lng:o.geometry?.location?.lng,types:o.types,rating:o.rating,userRatingsTotal:o.user_ratings_total}})}else if(h){const s=R(t,e);m(s,{state:{placeId:t,name:e,lat:a,lng:l,types:i,rating:n,userRatingsTotal:r}})}};return p?s.jsxs("div",{className:"inline-flex items-center space-x-2 bg-blue-50 hover:bg-blue-100 px-3 py-1 rounded-full text-sm text-blue-700 cursor-pointer transition-colors duration-200",onClick:f,children:[s.jsx(C,{className:"h-3 w-3"}),s.jsx("span",{className:"font-medium",children:o.name}),o.rating&&s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(S,{className:"h-3 w-3 text-yellow-500 fill-current"}),s.jsx("span",{className:"text-xs",children:o.rating.toFixed(1)})]})]}):s.jsxs("div",{className:x("flex items-start space-x-2 text-sm text-[#62626a]",c),children:[s.jsx("div",{className:"flex-shrink-0 mt-0.5",children:s.jsx(C,{className:"h-4 w-4"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[h&&s.jsx("span",{className:"text-base",children:(v=i,v&&0!==v.length?v.includes("restaurant")||v.includes("food")?"ðŸ½ï¸":v.includes("tourist_attraction")||v.includes("point_of_interest")?"ðŸ›ï¸":v.includes("lodging")||v.includes("hotel")?"ðŸ¨":v.includes("shopping_mall")||v.includes("store")?"ðŸ›ï¸":v.includes("park")||v.includes("natural_feature")?"ðŸŒ³":v.includes("museum")?"ðŸ›ï¸":v.includes("amusement_park")||v.includes("entertainment")?"ðŸŽ¡":"ðŸ“":"ðŸ“")}),s.jsx("span",{className:"font-medium text-[#030303] truncate",children:e}),h&&s.jsxs("button",{onClick:f,className:"ml-2 px-3 py-1 text-xs bg-[#61936f] text-white rounded-full hover:bg-[#4a7c5a] transition-colors duration-200 flex items-center space-x-1",title:"View place details",children:[s.jsx("span",{children:"View"}),s.jsx(L,{className:"h-3 w-3"})]})]}),h&&s.jsxs("div",{className:"flex items-center space-x-4 mt-1",children:[n&&s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(S,{className:"h-3 w-3 text-yellow-500 fill-current"}),s.jsxs("span",{className:"text-xs",children:[n.toFixed(1),r&&` (${r})`]})]}),u(i)&&s.jsx("span",{className:"text-xs bg-[#fcfcfc] px-2 py-1 rounded-full border border-[#62626a]/20",children:u(i)})]})]})]});var v},K=[{id:"all",label:"All"},{id:"music",label:"Music"},{id:"sports",label:"Sports"},{id:"arts",label:"Arts & Theatre"},{id:"family",label:"Family"},{id:"comedy",label:"Comedy"},{id:"film",label:"Film"},{id:"food",label:"Food & Drink"},{id:"festival",label:"Festivals"},{id:"business",label:"Business"},{id:"other",label:"Other"}];function G({events:t,isLoading:a,loadingText:l,noEventsText:m}){const[u,h]=e.useState("all"),p=e.useMemo((()=>{if(!Array.isArray(t)||0===t.length)return[];const e=t.reduce(((e,s)=>{const t=s.type||"other";return e[t]=(e[t]||0)+1,e}),{});return K.filter((s=>"all"===s.id||e[s.id]>0))}),[t]),g="all"===u?t:t.filter((e=>e.type?.toLowerCase()===u));return a?s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:[1,2,3,4].map((e=>s.jsxs("div",{className:"animate-pulse",children:[s.jsx("div",{className:"rounded-lg bg-[#f4f4f5] h-24 sm:h-32 mb-2"}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("div",{className:"h-3 bg-[#f4f4f5] rounded w-3/4"}),s.jsx("div",{className:"h-2 bg-[#f4f4f5] rounded w-1/2"})]})]},e)))}):Array.isArray(t)&&0!==t.length?s.jsxs("div",{className:"space-y-4",children:[p.length>1&&s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"flex items-center space-x-1.5 overflow-x-auto pb-2 scrollbar-hide -mx-4 px-4",children:p.map((e=>s.jsx("button",{onClick:()=>h(e.id),className:x("px-3 py-1.5 rounded-full text-xs sm:text-sm font-medium transition-all duration-200 whitespace-nowrap flex-shrink-0",u===e.id?"bg-[#61936f] text-white shadow-sm":"bg-white text-[#62626a] hover:bg-gray-50 border border-gray-200"),children:e.label},e.id)))}),s.jsx("div",{className:"absolute right-0 top-0 bottom-0 w-8 bg-gradient-to-l from-white pointer-events-none"})]}),s.jsx("div",{className:"relative -mx-2",children:s.jsxs(i,{opts:{align:"start",loop:!0},className:"w-full",children:[s.jsx(n,{className:"-ml-2",children:g.map((e=>s.jsx(r,{className:"pl-2 basis-1/2 sm:basis-1/3 md:basis-1/4",children:s.jsx("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"block group",children:s.jsx("div",{className:"relative rounded-lg overflow-hidden",children:s.jsxs("div",{className:"relative aspect-[16/9] sm:aspect-[4/3] overflow-hidden",children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 to-black/10 z-10 opacity-60 group-hover:opacity-80 transition-opacity"}),s.jsx("img",{src:e.imageUrl||"/placeholder-event.jpg",alt:e.name,className:"absolute inset-0 w-full h-full object-cover transform group-hover:scale-105 transition duration-500"}),s.jsxs("div",{className:"absolute inset-0 z-20 p-1.5 sm:p-2 flex flex-col justify-between",children:[s.jsx("div",{className:"flex justify-between items-start",children:s.jsx(c,{className:"bg-white/90 text-[#030303] hover:bg-white text-[10px] sm:text-xs",children:V(new Date(e.startDate),"MMM d")})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xs sm:text-sm text-white font-medium mb-0.5 line-clamp-2 group-hover:text-[#61936f] transition-colors",children:e.name}),e.venue&&s.jsxs("div",{className:"flex items-center text-white/80 text-[10px] sm:text-xs",children:[s.jsx(C,{className:"w-2.5 h-2.5 mr-0.5 flex-shrink-0"}),s.jsxs("span",{className:"truncate",children:[e.venue.address.city,", ",e.venue.address.region]})]})]})]})]})})})},e.id)))}),s.jsxs("div",{className:"hidden md:block",children:[s.jsx(o,{className:"absolute -left-2 top-1/2 -translate-y-1/2 h-6 w-6 rounded-full bg-white/80 border-none text-[#030303] hover:bg-white shadow-md"}),s.jsx(d,{className:"absolute -right-2 top-1/2 -translate-y-1/2 h-6 w-6 rounded-full bg-white/80 border-none text-[#030303] hover:bg-white shadow-md"})]})]})})]}):s.jsx("div",{className:"text-center py-6 text-[#62626a]",children:s.jsx("p",{children:m})})}function J(){const{t:a}=g("community"),[l,i]=e.useState(null),[n,r]=e.useState(!0),[c,o]=e.useState(null),[d,u]=e.useState([]),[x,f]=e.useState(!1),[v,j]=e.useState(30),b=async(e,s)=>{f(!0);try{const{data:t,error:a}=await I.functions.invoke("eventbrite-events",{body:{latitude:e,longitude:s,radius:v}});if(a)throw a;u(t.events)}catch(t){}finally{f(!1)}},y=()=>{r(!0),o(null),u([]);const e=h();if(e)return i(e.data),b(e.data.coordinates.latitude,e.data.coordinates.longitude),void r(!1);"geolocation"in navigator?navigator.geolocation.getCurrentPosition((e=>{(async(e,s)=>{try{const{data:t,error:a}=await I.functions.invoke("geocode",{body:{latitude:e,longitude:s}});if(a)throw a;if(!t)throw new Error("Location not found");{const a={city:t.city,region:t.region,country:t.country,formatted:t.formatted,coordinates:{latitude:e,longitude:s}};i(a),p(a),b(e,s)}}catch(t){o(a("locationError"))}finally{r(!1)}})(e.coords.latitude,e.coords.longitude)}),(e=>{o(a("locationPermissionError")),r(!1)}),{enableHighAccuracy:!0,timeout:5e3,maximumAge:0}):(o(a("locationNotSupported")),r(!1))};return e.useEffect((()=>{l?.coordinates&&b(l.coordinates.latitude,l.coordinates.longitude)}),[v]),e.useEffect((()=>{y()}),[]),s.jsxs(O.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},className:"w-full space-y-6",children:[s.jsxs("div",{className:"flex flex-col space-y-4 sm:hidden",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[n?s.jsxs("div",{className:"flex items-center space-x-2 text-[#030303]",children:[s.jsx(z,{className:"h-5 w-5 animate-spin"}),s.jsx("span",{className:"text-sm",children:a("detectingLocation")})]}):c?s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("p",{className:"text-red-500 text-sm",children:c}),s.jsxs(t,{variant:"ghost",size:"sm",onClick:y,className:"text-[#62626a] hover:text-[#030303]",children:[s.jsx(C,{className:"h-4 w-4 mr-1"}),a("retryLocation")]})]}):l?s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(C,{className:"h-5 w-5 text-[#61936f]"}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-[#030303] font-medium leading-snug",children:a("yourLocation")}),s.jsx("p",{className:"text-sm text-[#62626a] truncate max-w-[200px]",children:l.formatted})]})]}):null,l&&s.jsx(t,{variant:"ghost",size:"sm",onClick:y,className:"text-[#62626a] hover:text-[#030303] ml-auto",children:a("updateLocation")})]})}),l&&s.jsxs("div",{className:"flex items-center space-x-3 px-1",children:[s.jsx(E,{className:"h-4 w-4 text-[#62626a]"}),s.jsx("div",{className:"flex-1 w-24",children:s.jsx(m,{value:[v],onValueChange:e=>j(e[0]),min:1,max:50,step:1,className:"[&_.bg-primary]:bg-[#61936f]"})}),s.jsxs("span",{className:"text-sm font-medium text-[#62626a] min-w-[3ch]",children:[v,s.jsx("span",{className:"text-[#62626a]/60 ml-0.5",children:"km"})]})]})]}),s.jsxs("div",{className:"hidden sm:flex items-center justify-between",children:[s.jsx("div",{className:"flex items-center space-x-3",children:n?s.jsxs("div",{className:"flex items-center space-x-2 text-[#030303]",children:[s.jsx(z,{className:"h-5 w-5 animate-spin"}),s.jsx("span",{className:"text-sm",children:a("detectingLocation")})]}):c?s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("p",{className:"text-red-500 text-sm",children:c}),s.jsxs(t,{variant:"ghost",size:"sm",onClick:y,className:"text-[#62626a] hover:text-[#030303]",children:[s.jsx(C,{className:"h-4 w-4 mr-1"}),a("retryLocation")]})]}):l?s.jsxs(s.Fragment,{children:[s.jsx(C,{className:"h-5 w-5 text-[#61936f]"}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-[#030303] font-medium",children:a("yourLocation")}),s.jsx("p",{className:"text-sm text-[#62626a]",children:l.formatted})]}),s.jsx(t,{variant:"ghost",size:"sm",onClick:y,className:"text-[#62626a] hover:text-[#030303] ml-2",children:a("updateLocation")})]}):null}),l&&s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("div",{className:"flex items-center space-x-2 text-[#62626a]",children:[s.jsx(E,{className:"h-4 w-4"}),s.jsxs("span",{className:"text-sm font-medium",children:[v,"km"]})]}),s.jsx("div",{className:"w-24",children:s.jsx(m,{value:[v],onValueChange:e=>j(e[0]),min:1,max:50,step:1,className:"[&_.bg-primary]:bg-[#61936f]"})})]})]}),l&&s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(M,{className:"h-5 w-5 text-[#61936f]"}),s.jsx("h2",{className:"text-lg font-medium text-[#030303]",children:a("nearbyEvents")})]}),s.jsx(G,{events:d,isLoading:x,loadingText:a("loadingEvents"),noEventsText:a("noEventsFound")})]})]})}const W=({value:a,onChange:l,placeholder:i,className:n,disabled:r=!1,currentLocation:c})=>{const{t:o,i18n:d}=g("community"),{toast:m}=U(),[h,p]=e.useState([]),[f,v]=e.useState(!1),[j,b]=e.useState(!1),[N,w]=e.useState(!1),[k,_]=e.useState(null),[S,L]=e.useState(a),[M,P]=e.useState(c||null),T=e.useRef(null),A=e.useRef(null),R=e.useRef(null);e.useEffect((()=>{L(a)}),[a]),e.useEffect((()=>{c&&P(c)}),[c]),e.useEffect((()=>{const e=e=>{A.current&&!A.current.contains(e.target)&&v(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}),[]);const q=e.useCallback((async e=>{if(!e.trim()||e.length<2)return p([]),void v(!1);b(!0);try{const{data:s,error:t}=await I.functions.invoke("google-places-search",{body:{action:"autocomplete",query:e.trim(),location:M,radius:5e4,language:d.language}});if(t)return;"OK"===s.status&&s.predictions?(p(s.predictions),v(!0)):(p([]),v(!1))}catch(s){}finally{b(!1)}}),[M,d.language]),V=e=>e.includes("restaurant")||e.includes("food")?"ðŸ½ï¸":e.includes("tourist_attraction")||e.includes("point_of_interest")?"ðŸ›ï¸":e.includes("lodging")||e.includes("hotel")?"ðŸ¨":e.includes("shopping_mall")||e.includes("store")?"ðŸ›ï¸":e.includes("park")||e.includes("natural_feature")?"ðŸŒ³":e.includes("museum")?"ðŸ›ï¸":e.includes("amusement_park")||e.includes("entertainment")?"ðŸŽ¡":"ðŸ“";return s.jsxs("div",{ref:A,className:x("relative",n),children:[s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx(C,{className:"h-4 w-4 text-[#62626a]"})}),s.jsx(u,{ref:R,type:"text",value:S,onChange:e=>{const s=e.target.value;L(s),l(s),T.current&&clearTimeout(T.current),T.current=setTimeout((()=>{q(s)}),300)},placeholder:i||o("searchLocation"),disabled:r,className:"pl-10 pr-20",onFocus:()=>{h.length>0&&v(!0)}}),s.jsxs("div",{className:"absolute inset-y-0 right-0 flex items-center pr-2 space-x-1",children:[s.jsx(t,{type:"button",variant:"ghost",size:"sm",onClick:async()=>{const e=await(async()=>{if(!navigator.geolocation)return m({title:"Location Not Supported",description:"Geolocation is not supported by your browser.",variant:"destructive"}),null;w(!0);try{const e=await new Promise(((e,s)=>{navigator.geolocation.getCurrentPosition(e,s,{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})})),s={lat:e.coords.latitude,lng:e.coords.longitude};return P(s),s}catch(e){return m({title:"Location Error",description:"Unable to get your current location. Please check your location permissions.",variant:"destructive"}),null}finally{w(!1)}})();if(e){b(!0);try{const{data:s,error:t}=await I.functions.invoke("google-places-search",{body:{action:"search",query:"nearby places",location:e,radius:5e3,types:"point_of_interest,tourist_attraction,restaurant,store,lodging",language:d.language}});if(t)return void m({title:"Search Error",description:"Unable to find nearby places.",variant:"destructive"});if("OK"===s.status&&s.results){const e=s.results.slice(0,8).map((e=>({place_id:e.place_id,description:e.name,structured_formatting:{main_text:e.name,secondary_text:e.formatted_address||e.vicinity||""},types:e.types||[]})));p(e),v(!0)}else p([]),v(!1),m({title:"No Places Found",description:"No places found near your current location.",variant:"destructive"})}catch(s){m({title:"Search Error",description:"Unable to search for nearby places.",variant:"destructive"})}finally{b(!1)}}},disabled:N||r,className:"h-8 w-8 p-0 text-[#62626a] hover:text-[#030303] hover:bg-gray-100",title:"Find nearby places",children:N?s.jsx(z,{className:"h-4 w-4 animate-spin"}):s.jsx(E,{className:"h-4 w-4"})}),j?s.jsx(z,{className:"h-4 w-4 animate-spin text-[#62626a]"}):S?s.jsx(t,{type:"button",variant:"ghost",size:"sm",onClick:()=>{L(""),_(null),p([]),v(!1),l("")},className:"h-6 w-6 p-0 text-[#62626a] hover:text-[#030303]",children:s.jsx(y,{className:"h-4 w-4"})}):s.jsx(F,{className:"h-4 w-4 text-[#62626a]"})]})]}),f&&h.length>0&&s.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg overflow-y-auto max-h-60",style:{maxHeight:"240px",minHeight:"48px"},children:h.map(((e,t)=>s.jsx("button",{type:"button",onClick:()=>(async e=>{b(!0);try{const{data:s,error:t}=await I.functions.invoke("google-places-search",{body:{action:"details",placeId:e.place_id,fields:"place_id,name,formatted_address,geometry,types,rating,user_ratings_total,opening_hours",language:d.language}});if(t)return;if("OK"===s.status&&s.result){const e=s.result;_(e),L(e.name),l(e.name,e)}}catch(s){}finally{b(!1),v(!1)}})(e),className:x("w-full px-4 py-3 text-left hover:bg-gray-50 focus:bg-gray-50 focus:outline-none transition-colors","active:bg-gray-100 touch-manipulation min-h-[48px]",0===t?"rounded-t-lg":"",t===h.length-1?"rounded-b-lg":""),children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx("span",{className:"text-lg flex-shrink-0",children:V(e.types)}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("div",{className:"font-medium text-[#030303] break-words",children:e.structured_formatting.main_text}),s.jsx("div",{className:"text-sm text-[#62626a] break-words",children:e.structured_formatting.secondary_text})]})]})},e.place_id)))}),k&&s.jsx("div",{className:"mt-2 p-3 bg-[#fcfcfc] border border-[#62626a]/20 rounded-lg",children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx("span",{className:"text-lg",children:V(k.types)})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("div",{className:"font-medium text-[#030303]",children:k.name}),s.jsx("div",{className:"text-sm text-[#62626a]",children:k.formatted_address}),k.rating&&s.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("span",{className:"text-yellow-500",children:"â˜…"}),s.jsx("span",{className:"text-sm text-[#62626a] ml-1",children:k.rating.toFixed(1)})]}),k.user_ratings_total&&s.jsxs("span",{className:"text-xs text-[#62626a]",children:["(",k.user_ratings_total," reviews)"]})]}),k.opening_hours&&s.jsx("div",{className:"mt-1",children:s.jsx("span",{className:x("text-xs px-2 py-1 rounded-full",k.opening_hours.open_now?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:k.opening_hours.open_now?o("openNow"):o("closed")})})]})]})})]})};function X({onConnectClick:e,onSignupClick:a,className:l}){const{t:i}=g("community");return s.jsxs(O.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:x("absolute inset-0 bg-white/80 backdrop-blur-md rounded-xl z-10","flex flex-col items-center justify-center p-2 sm:p-6","border border-gray-200/50",l),children:[s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/60 to-white/40 rounded-xl"}),s.jsxs("div",{className:"relative z-20 text-center space-y-2 sm:space-y-4",children:[s.jsx(O.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.1},className:"mx-auto w-10 h-10 sm:w-16 sm:h-16 bg-gradient-to-br from-[#61936f] to-[#4a7c59] rounded-full flex items-center justify-center shadow-lg",children:s.jsx(P,{className:"w-5 h-5 sm:w-8 sm:h-8 text-white"})}),s.jsx(O.h3,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},className:"text-base sm:text-xl font-bold text-gray-800",children:i("postBlur.title","Connect to Create Posts")}),s.jsx(O.p,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.3},className:"text-xs sm:text-base text-gray-600 max-w-[200px] sm:max-w-sm mx-auto px-1 sm:px-2",children:i("postBlur.description","Join our community to share your travel stories, connect with fellow travelers, and create amazing posts.")}),s.jsxs(O.div,{initial:{y:20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.4},className:"flex flex-col sm:flex-row gap-1.5 sm:gap-3 w-full max-w-[180px] sm:max-w-xs mx-auto",children:[s.jsxs(t,{onClick:e,size:"sm",className:"flex-1 bg-gradient-to-r from-[#61936f] to-[#4a7c59] hover:from-[#4a7c59] hover:to-[#3d6b4a] text-white font-medium shadow-lg hover:shadow-xl transition-all duration-300 text-xs sm:text-base py-1.5 sm:py-2",children:[s.jsx(T,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1.5 sm:mr-2"}),i("postBlur.connect","Connect")]}),s.jsxs(t,{onClick:a,variant:"outline",size:"sm",className:"flex-1 border-[#61936f] text-[#61936f] hover:bg-[#61936f] hover:text-white font-medium shadow-lg hover:shadow-xl transition-all duration-300 text-xs sm:text-base py-1.5 sm:py-2",children:[s.jsx(A,{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1.5 sm:mr-2"}),i("postBlur.signup","Sign Up")]})]})]})]})}export{G as E,W as G,J as L,B as M,X as P,D as a,H as b};
//# sourceMappingURL=components-community.DdS-HWu3.js.map
