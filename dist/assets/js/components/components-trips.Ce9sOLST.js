import{r as e,j as t}from"../vendor/vendor-react-core.D1hcyiwY.js";import{I as s,B as a,C as i,m as n}from"./components-ui.C8hnNhgu.js";import{c as r}from"./components-blog.C3TFiFB1.js";import{u as o}from"../vendor/vendor--react-i18next.DhHVfoav.js";import{S as c,L as l,bb as d,M as m,af as u,al as x,ab as p,aq as h,$ as f,f as y,U as g,h as j,bc as v,m as N,bd as b,be as w,D as _,at as C}from"../vendor/vendor--lucide-react.DRw9PYsu.js";import{A as k,m as z}from"../vendor/vendor--framer-motion.Dpgjd5L1.js";import{p as J,e as O,a as I,b as T,i as $,f as A}from"../vendor/vendor--date-fns.BbAlDtqN.js";const E=({value:i,onChange:n,onSelect:f,disabled:y,className:g,placeholder:j})=>{const{t:v}=o("common"),[N,b]=e.useState([]),[w,_]=e.useState(!1),[C,J]=e.useState(i),[O,I]=e.useState(!1),[T,$]=e.useState(!1),A=e.useRef(null),E=e.useRef(null),M=e.useRef(!1),P=e.useRef(null),[R,S]=e.useState(null);e.useEffect((()=>(P.current&&clearTimeout(P.current),P.current=window.setTimeout((async()=>{if(M.current||!w||i.length<2)return M.current=!1,void b([]);if(i!==C)try{$(!0);const e=(new Date).getTime(),t=`https://api.mapbox.com/geocoding/v5/mapbox.places/${encodeURIComponent(i)}.json?access_token=pk.eyJ1IjoibWlzdGVyZnJhenoiLCJhIjoiY203M2ZnM3BoMDhpMTJqcTNiYWpkamIzNyJ9.2SlcuEPIL2yCJw5TIPunVQ&types=place,address,poi,neighborhood,locality,postcode,country,region&limit=15&cacheBuster=${e}`,s=await fetch(t),a=await s.json(),n=a.features.map((e=>({place_name:e.place_name,center:e.center,isExactAddress:e.place_type?.includes("address"),isCity:e.place_type?.includes("place"),isCountry:e.place_type?.includes("country"),isRegion:e.place_type?.includes("region"),type:e.place_type?.[0]||"unknown"}))).sort(((e,t)=>e.isExactAddress&&!t.isExactAddress?-1:!e.isExactAddress&&t.isExactAddress?1:e.isCity&&!t.isCity?-1:!e.isCity&&t.isCity?1:e.isRegion&&!t.isRegion?-1:!e.isRegion&&t.isRegion?1:e.isCountry&&!t.isCountry?-1:!e.isCountry&&t.isCountry?1:0));b(n)}catch(e){b([])}finally{$(!1)}else _(!1)}),200),()=>{P.current&&clearTimeout(P.current)})),[i,C,w]),e.useEffect((()=>{const e=e=>{A.current&&!A.current.contains(e.target)&&_(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[]);const q=e=>{M.current=!0,J(e.place_name),_(!1),b([]),n(e.place_name,e.center),f?.(e.place_name,e.center)};return t.jsxs("div",{className:"relative w-full",ref:A,children:[t.jsxs("div",{className:r("relative flex items-center transition-all group","rounded-lg shadow-sm hover:shadow-md focus-within:shadow-md focus-within:ring-2 focus-within:ring-[#61936f]/40",y?"opacity-60":""),children:[t.jsx("div",{className:"absolute left-3 text-gray-400 group-focus-within:text-[#61936f]",children:t.jsx(c,{className:"h-5 w-5"})}),t.jsx(s,{ref:E,id:"location",value:i,onChange:e=>{const t=e.target.value;n(t,[0,0]),t!==C&&(J(""),t.length>=2&&_(!0))},onFocus:()=>{!y&&i.length>=2&&_(!0)},onKeyDown:e=>{"Escape"===e.key&&_(!1)},placeholder:j||v("form.destinationPlaceholder"),className:r("pl-10 pr-10 h-12 rounded-lg border-[#e2e2e2]","text-[15px] placeholder:text-gray-400","focus:border-[#61936f] focus-visible:ring-0 focus-visible:border-[#61936f]","transition-all rounded-r-none",g),required:!0,disabled:y,inputMode:"text",type:"search",enterKeyHint:"search"}),t.jsx("div",{className:"absolute right-[3.25rem] flex items-center",children:T&&t.jsx(l,{className:"h-4 w-4 animate-spin text-[#61936f]"})}),t.jsx(a,{type:"button",variant:"outline",size:"icon",onClick:()=>{y||(I(!0),"geolocation"in navigator?navigator.geolocation.getCurrentPosition((async e=>{try{const t=await fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${e.coords.longitude},${e.coords.latitude}.json?access_token=pk.eyJ1IjoibWlzdGVyZnJhenoiLCJhIjoiY203M2ZnM3BoMDhpMTJqcTNiYWpkamIzNyJ9.2SlcuEPIL2yCJw5TIPunVQ&types=place`),s=await t.json(),a=await fetch(`https://api.mapbox.com/geocoding/v5/mapbox.places/${e.coords.longitude},${e.coords.latitude}.json?access_token=pk.eyJ1IjoibWlzdGVyZnJhenoiLCJhIjoiY203M2ZnM3BoMDhpMTJqcTNiYWpkamIzNyJ9.2SlcuEPIL2yCJw5TIPunVQ&types=address`),i=await a.json();if(s.features&&s.features[0]&&i.features&&i.features[0]){const t=s.features[0].place_name,a=i.features[0].place_name;b([{place_name:t,center:[e.coords.longitude,e.coords.latitude],isCity:!0,type:"place"}]),_(!0),J(t),n(t,[e.coords.longitude,e.coords.latitude]),S({place_name:a,center:[e.coords.longitude,e.coords.latitude],type:"address"})}}catch(t){}finally{I(!1)}}),(e=>{I(!1)})):I(!1))},disabled:y||O,className:r("h-12 min-w-12 rounded-l-none border-l-0 border-[#e2e2e2]","hover:bg-[#61936f]/10 hover:text-[#61936f] hover:border-[#61936f]","focus:border-[#61936f] focus:text-[#61936f]",O&&"text-[#61936f]"),"aria-label":v("common.useCurrentLocation")||"Use current location",title:v("common.useCurrentLocation")||"Use current location",children:O?t.jsx(l,{className:"h-5 w-5 animate-spin"}):t.jsx(d,{className:"h-5 w-5"})})]}),R&&t.jsx("div",{className:"mt-1.5 p-2 bg-gray-50 rounded-lg border border-gray-200",children:t.jsxs("div",{className:"flex items-start gap-1.5",children:[t.jsx(m,{className:"h-3.5 w-3.5 text-[#61936f] mt-0.5 flex-shrink-0"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"text-xs text-gray-600",children:v("useExactAddress")}),t.jsx("div",{className:"mt-0.5 text-xs font-medium text-gray-900",children:R.place_name}),t.jsx("button",{onClick:()=>{R&&(q(R),S(null))},className:"mt-1 text-xs text-[#61936f] hover:text-[#4a7a5a] font-medium",children:v("exactAddress")})]})]})}),t.jsx(k,{children:w&&N.length>0&&t.jsx(z.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.15},className:r("absolute z-[9999] bg-white rounded-lg shadow-lg border border-gray-200 overflow-y-auto","backdrop-blur-sm","w-full","mt-1"),style:{maxHeight:"300px"},children:N.map(((e,s)=>t.jsxs(z.button,{initial:{opacity:0,y:5},animate:{opacity:1,y:0},transition:{duration:.1,delay:.03*s},type:"button",className:r("w-full text-left px-4 py-3 text-sm flex items-center gap-2","hover:bg-gray-50 focus:outline-none focus:bg-gray-50","transition-colors","touch-action-manipulation","active:bg-gray-100","min-h-[48px]"),onClick:()=>q(e),children:[e.isCountry?t.jsx(u,{className:"h-4 w-4 flex-shrink-0 text-blue-600"}):e.isRegion?t.jsx(x,{className:"h-4 w-4 flex-shrink-0 text-purple-600"}):e.isCity?t.jsx(p,{className:"h-4 w-4 flex-shrink-0 text-[#61936f]"}):e.isExactAddress?t.jsx(h,{className:"h-4 w-4 flex-shrink-0 text-orange-600"}):t.jsx(m,{className:"h-4 w-4 flex-shrink-0 text-gray-600"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"font-medium text-gray-900",children:e.place_name}),t.jsxs("div",{className:"text-xs text-gray-500 mt-0.5",children:[e.isExactAddress&&v("exactAddress"),e.isCountry&&v("country"),e.isRegion&&v("region"),e.isCity&&v("city")]})]})]},s)))})})]})};function M({zapOutData:e,onClick:s}){const{t:a,i18n:c}=o("trip");return t.jsxs(i,{className:r("relative group transition-all duration-200",s&&"cursor-pointer hover:shadow-lg"),onClick:s,children:[s&&t.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/5 transition-colors duration-200 pointer-events-none"}),t.jsxs(n,{className:"p-6",children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsx("h3",{className:"text-lg font-semibold",children:a("types.zapOut.details.title")}),s&&t.jsx(f,{className:"w-5 h-5 text-muted-foreground opacity-0 group-hover:opacity-100 transition-opacity duration-200"})]}),t.jsxs("div",{className:"space-y-4",children:[e.date&&t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(y,{className:"w-5 h-5 text-muted-foreground mt-0.5"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:a("types.zapOut.when")}),t.jsx("p",{className:"text-base",children:(e=>{if(!e)return"";try{const t=J(e);let s=O;if("fr"===c.language?s=I:"es"===c.language&&(s=T),$(t))return A(t,"PPP",{locale:s});const a=new Date(e);return $(a)?A(a,"PPP",{locale:s}):""}catch(t){return""}})(e.date)})]})]}),(e.adults||e.kids)&&t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(g,{className:"w-5 h-5 text-muted-foreground mt-0.5"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:a("types.zapOut.personDateTitle")}),t.jsx("p",{className:"text-base",children:(()=>{const t=e.adults||0,s=e.kids||0;if(0===t+s)return"";let i="";return t>0&&(i+=`${t} ${a("form.adults")}`),s>0&&(i&&(i+=", "),i+=`${s} ${a("form.kids")}`),i})()})]})]}),t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(j,{className:"w-5 h-5 text-muted-foreground mt-0.5"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:a("types.zapOut.details.timeOfActivities")}),t.jsx("p",{className:"text-base",children:e.activity_times&&e.activity_times.length>0?e.activity_times.map((e=>{const t=`types.zapOut.details.${e}`,s=a(t);return s===t?e:s})).join(", "):a("types.zapOut.details.noActivityTimes")})]})]}),t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(v,{className:"w-5 h-5 text-muted-foreground mt-0.5"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:a("types.zapOut.details.activityTypes")}),t.jsx("p",{className:"text-base",children:e.activity_types&&e.activity_types.length>0?e.activity_types.map((e=>{const t=`types.zapOut.details.${e}`,s=a(t);return s===t?e:s})).join(", "):a("types.zapOut.details.noActivityTypes")})]})]}),e.requested_activities&&e.requested_activities.length>0&&t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(N,{className:"w-5 h-5 text-muted-foreground mt-0.5"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:a("types.zapOut.details.requestedActivities")}),t.jsx("p",{className:"text-base",children:(l=e.requested_activities,l&&0!==l.length?l.join(", "):a("types.zapOut.details.noRequestedActivities"))})]})]}),e.group_composition&&t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(b,{className:"w-5 h-5 text-muted-foreground mt-0.5"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:a("types.zapOut.details.groupComposition")}),t.jsx("p",{className:"text-base",children:e.group_composition})]})]}),e.accessibility_needs&&t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(w,{className:"w-5 h-5 text-muted-foreground mt-0.5"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:a("types.zapOut.details.accessibilityNeeds")}),t.jsx("p",{className:"text-base",children:e.accessibility_needs})]})]}),t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(_,{className:"w-5 h-5 text-muted-foreground mt-0.5"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:a("types.zapOut.details.budget")}),t.jsx("p",{className:"text-base",children:e.min_budget&&e.max_budget?`${e.min_budget} ${e.currency||"USD"} - ${e.max_budget} ${e.currency||"USD"}`:a("types.zapOut.details.noBudgetSpecified")})]})]}),e.special_requirements&&t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(C,{className:"w-5 h-5 text-muted-foreground mt-0.5"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:a("types.zapOut.details.specialRequirements")}),t.jsx("p",{className:"text-base",children:e.special_requirements})]})]})]})]})]});var l}export{E as L,M as Z};
//# sourceMappingURL=components-trips.Ce9sOLST.js.map
