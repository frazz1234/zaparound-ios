import{r as e,j as a}from"../vendor/vendor-react-core.D1hcyiwY.js";import{s}from"./components-admin.CiIAoamg.js";import{G as i,J as t,K as r,M as o,ab as l,L as n,I as m,B as c}from"./components-ui.C8hnNhgu.js";import{u as d}from"../hooks/hooks-use-toast.ts.Dg8obzHg.js";import{u as g}from"../vendor/vendor--react-i18next.DhHVfoav.js";import{j as p,L as h,v as u}from"../vendor/vendor--lucide-react.DRw9PYsu.js";function j({isOpen:j,onClose:x,bookingData:f}){const{t:v,i18n:b}=g("zapbooking"),{toast:D}=d(),[k,y]=e.useState(""),[N,E]=e.useState(!1),w=async e=>{if(e.preventDefault(),!k.trim())return void D({title:v("error"),description:v("emailDialog.pleaseEnterValidEmail"),variant:"destructive"});if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(k)){E(!0);try{const{data:e,error:a}=await s.functions.invoke("send-booking-email",{body:{bookingReference:f.booking_reference,recipientEmail:k.trim(),bookingData:f,language:b.language}});if(a)throw a;D({title:v("emailDialog.success"),description:v("emailDialog.bookingDetailsSent")}),y(""),x()}catch(a){D({title:v("error"),description:a.message||v("emailDialog.failedToSend"),variant:"destructive"})}finally{E(!1)}}else D({title:v("error"),description:v("emailDialog.pleaseEnterValidEmail"),variant:"destructive"})};return a.jsx(i,{open:j,onOpenChange:x,children:a.jsxs(t,{className:"sm:max-w-md",children:[a.jsxs(r,{children:[a.jsxs(o,{className:"flex items-center",children:[a.jsx(p,{className:"w-5 h-5 mr-2"}),v("emailDialog.title")]}),a.jsxs(l,{children:[v("emailDialog.description")," ",f?.booking_reference,"."]})]}),a.jsxs("form",{onSubmit:w,className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(n,{htmlFor:"email",children:v("emailDialog.emailAddress")}),a.jsx(m,{id:"email",type:"email",placeholder:v("emailDialog.emailPlaceholder"),value:k,onChange:e=>y(e.target.value),onKeyPress:e=>{"Enter"!==e.key||N||w(e)},disabled:N,autoFocus:!0})]}),a.jsxs("div",{className:"flex justify-end space-x-2",children:[a.jsx(c,{type:"button",variant:"outline",onClick:x,disabled:N,children:v("emailDialog.cancel")}),a.jsx(c,{type:"submit",disabled:N||!k.trim(),className:"bg-[#61936f] hover:bg-[#4a7c5a] text-white",children:N?a.jsxs(a.Fragment,{children:[a.jsx(h,{className:"w-4 h-4 mr-2 animate-spin"}),v("emailDialog.sending")]}):a.jsxs(a.Fragment,{children:[a.jsx(u,{className:"w-4 h-4 mr-2"}),v("emailDialog.sendEmail")]})})]})]})]})})}export{j as E};
//# sourceMappingURL=components-bookings.q58dYAlO.js.map
