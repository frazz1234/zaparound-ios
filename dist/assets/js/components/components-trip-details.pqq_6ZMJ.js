import{j as e,r as s}from"../vendor/vendor-react-core.D1hcyiwY.js";import{C as a,m as t,p as r,q as l,r as n,s as i,t as c,I as d,z as o,W as m,k as x,l as h,G as p,J as u,K as f,M as j,ab as g,B as N}from"./components-ui.C8hnNhgu.js";import{u as b}from"../vendor/vendor--react-i18next.DhHVfoav.js";import{f as v,M as y,e as w,D as T,a2 as k,ar as C,au as z,ba as E,U as _,n as S,o as D,k as $,l as O}from"../vendor/vendor--lucide-react.DRw9PYsu.js";import{p as P,e as R,a as A,b as M,i as W,f as L}from"../vendor/vendor--date-fns.BbAlDtqN.js";import{M as Z}from"../vendor/vendor--react-markdown.C_e4o-CH.js";import{r as B}from"../vendor/vendor--remark-gfm.CpBcol-m.js";import{u as q}from"../hooks/hooks-useoptimizedqueries.ts.PW6zh7FL.js";import{Z as I}from"./components-trips.Ce9sOLST.js";import{u as V}from"../vendor/vendor--react-router.Gdfmkz0l.js";import{s as F}from"./components-admin.CiIAoamg.js";import{c as J}from"./components-blog.C3TFiFB1.js";import{E as Y}from"./components-community.DdS-HWu3.js";function U({startDate:s,endDate:o,location:m,category:x,activityTypes:h=[],budget:p,isEditing:u,isZapOutTrip:f=!1,isZapRoadTrip:j=!1,hideBudget:g=!1,onCategoryChange:N,onBudgetChange:k}){const{t:C}=b("trip"),z=e=>{if(!e)return"";try{const{i18n:s}=b(),a=P(e);let t=R;if("fr"===s.language?t=A:"es"===s.language&&(t=M),W(a))return L(a,"PPP",{locale:t});const r=new Date(e);return W(r)?L(r,"PPP",{locale:t}):""}catch(s){return""}},E=z(s),_=z(o),S=f?E:E&&_?`${E} - ${_}`:E||_;return e.jsx(a,{children:e.jsx(t,{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[S&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(v,{className:"w-5 h-5 text-muted-foreground mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:C(f?"types.zapOut.when":"form.date")}),e.jsx("p",{className:"text-base",children:S})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(y,{className:"w-5 h-5 text-muted-foreground mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:C("form.destination")}),e.jsx("p",{className:"text-base",children:m||C("details.locationNotSpecified")})]})]}),!j&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(w,{className:"w-5 h-5 text-muted-foreground mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:C(f?"types.zapOut.details.activityTypes":"details.category")}),u&&!f?e.jsxs(r,{value:x||"",onValueChange:N,children:[e.jsx(l,{children:e.jsx(n,{placeholder:C("details.selectCategory")})}),e.jsxs(i,{children:[e.jsx(c,{value:"leisure",className:"cursor-pointer hover:bg-accent transition-colors duration-200",children:C("categories.leisure")}),e.jsx(c,{value:"business",className:"cursor-pointer hover:bg-accent transition-colors duration-200",children:C("categories.business")}),e.jsx(c,{value:"family",className:"cursor-pointer hover:bg-accent transition-colors duration-200",children:C("categories.family")}),e.jsx(c,{value:"adventure",className:"cursor-pointer hover:bg-accent transition-colors duration-200",children:C("categories.adventure")}),e.jsx(c,{value:"city",className:"cursor-pointer hover:bg-accent transition-colors duration-200",children:C("categories.city")}),e.jsx(c,{value:"beach",className:"cursor-pointer hover:bg-accent transition-colors duration-200",children:C("categories.beach")}),e.jsx(c,{value:"nature",className:"cursor-pointer hover:bg-accent transition-colors duration-200",children:C("categories.nature")}),e.jsx(c,{value:"culture",className:"cursor-pointer hover:bg-accent transition-colors duration-200",children:C("categories.culture")})]})]}):e.jsx("p",{className:"text-base",children:f?(D=h,D&&0!==D.length?D.map((e=>C(`types.zapOut.details.${e}`))).join(", "):C("types.zapOut.details.noActivitiesSelected")):C(x?`categories.${x}`:"details.selectCategory")})]})]}),!g&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(T,{className:"w-5 h-5 text-muted-foreground mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:C("details.budget")}),u?e.jsx(d,{type:"number",value:p||"",onChange:e=>k(e.target.value?Number(e.target.value):null),placeholder:C("details.enterBudget")}):e.jsx("p",{className:"text-base",children:p?`$${p}`:C("types.zapOut.details.noBudgetSpecified")})]})]})]})})});var D}const G=["plane","train","bus","car"];function X({details:s,isEditing:a,onChange:t}){const{t:d}=b("trip");return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center text-gray-500",children:[e.jsx(k,{className:"mr-2 h-5 w-5"}),e.jsx("span",{children:d("details.transportationMode","Transportation")})]}),a?e.jsxs("div",{className:"space-y-2",children:[e.jsxs(r,{value:s.mode||"",onValueChange:e=>t({...s,mode:e}),children:[e.jsx(l,{children:e.jsx(n,{placeholder:d("details.transportationMode","Mode of transport")})}),e.jsx(i,{children:G.map((s=>e.jsx(c,{value:s,children:d(`transport.${s}`)},s)))})]}),e.jsx(o,{placeholder:d("details.transportationDetails","Additional transportation details"),value:s.details||"",onChange:e=>t({...s,details:e.target.value})})]}):e.jsxs("div",{className:"text-gray-600",children:[e.jsx("p",{className:"font-medium",children:(e=>{if(!e)return d("details.transportationMode","No mode specified");const s=e.toLowerCase();return G.includes(s)?d(`transport.${s}`):e})(s.mode)}),e.jsx("p",{className:"text-sm",children:s.details})]})]})}const H=["hotel","airbnb","hostel","camping","resort","bnb"];function Q({details:s,isEditing:a,onChange:t}){const{t:d}=b("trip");return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center text-gray-500",children:[e.jsx(C,{className:"mr-2 h-5 w-5"}),e.jsx("span",{children:d("details.accommodationType","Accommodation")})]}),a?e.jsxs("div",{className:"space-y-2",children:[e.jsxs(r,{value:s.type||"",onValueChange:e=>t({...s,type:e}),children:[e.jsx(l,{children:e.jsx(n,{placeholder:d("details.accommodationType","Accommodation type")})}),e.jsx(i,{children:H.map((s=>e.jsx(c,{value:s,children:d(`accommodation.${s}`)},s)))})]}),e.jsx(o,{placeholder:d("details.accommodationDetails","Additional accommodation details"),value:s.details||"",onChange:e=>t({...s,details:e.target.value})})]}):e.jsxs("div",{className:"text-gray-600",children:[e.jsx("p",{className:"font-medium",children:(e=>{if(!e)return d("details.accommodationType","No type specified");const s=e.toLowerCase();return H.includes(s)?d(`accommodation.${s}`):e})(s.type)}),e.jsx("p",{className:"text-sm",children:s.details})]})]})}function K({content:r,isLoading:l=!1,tripType:n}){const{t:i,i18n:c}=b("trip"),{startTrip:d,days:o,endTrip:x}=function(e){const s=e.match(/\[START_TRIP\]([\s\S]*?)\[\/START_TRIP\]/i),a=e.match(/\[END_TRIP\]([\s\S]*?)\[\/END_TRIP\]/i),t=[...e.matchAll(/\[DAY (\d+)\]([\s\S]*?)\[\/DAY\]/gi)],r=s?s[1].trim():null,l=a?a[1].trim():null;return{startTrip:r,days:t.map((e=>({title:`Day ${e[1]}`,body:e[2].trim()}))),endTrip:l}}(r||""),h=[];d&&h.push("startTrip"),o.forEach(((e,s)=>h.push(`day-${s}`))),x&&h.push("endTrip");const[p,u]=s.useState({});if(s.useEffect((()=>{const e={};h.forEach((s=>{e[s]=!1})),d&&(e.startTrip=!0),u(e)}),[r]),l)return e.jsxs("div",{className:"mt-8 p-6 bg-[#fcfcfc] rounded-xl",children:[e.jsx("h2",{className:"text-xl font-semibold text-[#030303] mb-4"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(m,{className:"h-5 w-full"}),e.jsx(m,{className:"h-5 w-5/6"}),e.jsx(m,{className:"h-5 w-4/5"}),e.jsx(m,{className:"h-5 w-full"}),e.jsx(m,{className:"h-5 w-3/4"})]})]});if(!r)return null;const f=e=>{u((s=>({...s,[e]:!s[e]})))},j=e=>!1!==p[e],g={p:({children:s})=>e.jsx("p",{className:"mb-4 leading-relaxed text-[#030303] break-words",children:s}),strong:({children:s})=>e.jsx("strong",{className:"font-bold text-[#1d1d1e] break-words",children:s}),em:({children:s})=>e.jsx("em",{className:"italic text-[#62626a] break-words",children:s}),h1:({children:s})=>e.jsx("h1",{className:"text-2xl font-bold text-[#1d1d1e] mt-6 mb-4 break-words",children:s}),h2:({children:s})=>e.jsx("h2",{className:"text-xl font-bold text-[#1d1d1e] mt-5 mb-3 break-words",children:s}),h3:({children:s})=>e.jsx("h3",{className:"text-lg font-bold text-[#1d1d1e] mt-4 mb-2 break-words",children:s}),ul:({children:s})=>e.jsx("ul",{className:"list-disc pl-6 mb-4 space-y-2 text-[#030303] break-words",children:s}),ol:({children:s})=>e.jsx("ol",{className:"list-decimal pl-6 mb-4 space-y-2 text-[#030303] break-words",children:s}),li:({children:s})=>e.jsx("li",{className:"text-[#62626a] break-words",children:s}),code:({children:s,className:a})=>!a?e.jsx("code",{className:"px-1.5 py-0.5 bg-[#f3f3f3] rounded text-sm font-mono text-[#1d1d1e] break-words",children:s}):e.jsx("code",{className:"block bg-[#f3f3f3] p-4 rounded-lg overflow-x-auto font-mono text-sm text-[#1d1d1e] break-words",children:s}),pre:({children:s})=>e.jsx("pre",{className:"mb-4 overflow-x-auto break-words",children:s}),a:({children:s,href:a})=>e.jsx("a",{href:a,className:"text-[#61936f] hover:text-[#1d1d1e] underline transition-colors break-words",target:"_blank",rel:"noopener noreferrer",children:s}),blockquote:({children:s})=>e.jsx("blockquote",{className:"border-l-4 border-[#61936f] pl-4 italic text-[#62626a] mb-4 bg-[#f3f3f3] rounded break-words",children:s}),hr:()=>e.jsx("hr",{className:"my-8 border-t border-[#e5e5e5]"})};return d||o.length>0||x?e.jsxs("div",{className:"mt-8 flex flex-col items-center relative w-full max-w-full overflow-hidden px-0",style:{minWidth:0},children:[d&&e.jsxs("div",{className:"w-full flex items-stretch relative mb-8",style:{minWidth:0},children:[e.jsx("div",{className:"flex flex-col items-center mr-2 sm:mr-4 flex-shrink-0",children:e.jsx("div",{className:"w-4 h-4 sm:w-5 sm:h-5 rounded-full bg-[#61936f] border-4 border-[#fcfcfc] shadow-lg z-10 mt-2"})}),e.jsxs(a,{className:"flex-1 bg-[#fcfcfc] border-[#e5e5e5] shadow-lg min-w-0 overflow-hidden",style:{minWidth:0},children:[e.jsxs("button",{className:"w-full flex items-center justify-between px-3 sm:px-4 md:px-6 py-3 sm:py-4 focus:outline-none focus:ring-2 focus:ring-[#61936f] group",onClick:()=>f("startTrip"),"aria-expanded":j("startTrip"),"aria-controls":"startTrip-content",type:"button",children:[e.jsx("span",{className:"text-base sm:text-lg md:text-xl font-bold text-[#1d1d1e] truncate pr-2",children:i("aiContent.zapTripStart","The beginning Of your Adventure")}),e.jsx(z,{className:"ml-2 h-4 w-4 sm:h-5 sm:w-5 text-[#61936f] transition-transform duration-200 flex-shrink-0 "+(j("startTrip")?"rotate-180":""),"aria-hidden":"true"})]}),e.jsx("div",{id:"startTrip-content",className:"overflow-hidden transition-all duration-300 "+(j("startTrip")?"max-h-[5000px] opacity-100":"max-h-0 opacity-0"),"aria-hidden":!j("startTrip"),children:e.jsx(t,{className:"px-3 sm:px-4 md:px-6",children:e.jsx("article",{className:"prose prose-sm max-w-none text-[#030303] overflow-hidden",children:e.jsx(Z,{remarkPlugins:[B],components:g,children:d})})})})]})]}),o.map(((s,r)=>e.jsxs("div",{className:"w-full flex items-stretch relative mb-8 last:mb-0",style:{minWidth:0},children:[e.jsxs("div",{className:"flex flex-col items-center mr-2 sm:mr-4 flex-shrink-0",children:[e.jsx("div",{className:"w-4 h-4 sm:w-5 sm:h-5 rounded-full bg-[#61936f] border-4 border-[#fcfcfc] shadow-lg z-10 mt-2"}),r<o.length-1&&e.jsx("div",{className:"w-1 bg-[#61936f] flex-1 min-h-[40px]",style:{minHeight:60}})]}),e.jsxs(a,{className:"flex-1 bg-[#fcfcfc] border-[#e5e5e5] shadow-lg min-w-0 overflow-hidden",style:{minWidth:0},children:[e.jsxs("button",{className:"w-full flex items-center justify-between px-3 sm:px-4 md:px-6 py-3 sm:py-4 focus:outline-none focus:ring-2 focus:ring-[#61936f] group",onClick:()=>f(`day-${r}`),"aria-expanded":j(`day-${r}`),"aria-controls":`day-${r}-content`,type:"button",children:[e.jsx("span",{className:"text-base sm:text-lg md:text-xl font-bold text-[#1d1d1e] truncate pr-2",children:"ZapOut"===n?i("aiContent.zapTripAdventure",{day:r+1,defaultValue:`Adventure ${r+1}`}):i("aiContent.zapTripDay",{day:r+1,defaultValue:`Day ${r+1}`})}),e.jsx(z,{className:"ml-2 h-4 w-4 sm:h-5 sm:w-5 text-[#61936f] transition-transform duration-200 flex-shrink-0 "+(j(`day-${r}`)?"rotate-180":""),"aria-hidden":"true"})]}),e.jsx("div",{id:`day-${r}-content`,className:"overflow-hidden transition-all duration-300 "+(j(`day-${r}`)?"max-h-[5000px] opacity-100":"max-h-0 opacity-0"),"aria-hidden":!j(`day-${r}`),children:e.jsx(t,{className:"px-3 sm:px-4 md:px-6",children:e.jsx("article",{className:"prose prose-sm max-w-none text-[#030303] overflow-hidden",children:e.jsx(Z,{remarkPlugins:[B],components:g,children:s.body})})})})]})]},r))),x&&e.jsxs("div",{className:"w-full flex items-stretch relative mb-8",style:{minWidth:0},children:[e.jsx("div",{className:"flex flex-col items-center mr-2 sm:mr-4 flex-shrink-0",children:e.jsx("div",{className:"w-4 h-4 sm:w-5 sm:h-5 rounded-full bg-[#61936f] border-4 border-[#fcfcfc] shadow-lg z-10 mt-2"})}),e.jsxs(a,{className:"flex-1 bg-[#fcfcfc] border-[#e5e5e5] shadow-lg min-w-0 overflow-hidden",style:{minWidth:0},children:[e.jsxs("button",{className:"w-full flex items-center justify-between px-3 sm:px-4 md:px-6 py-3 sm:py-4 focus:outline-none focus:ring-2 focus:ring-[#61936f] group",onClick:()=>f("endTrip"),"aria-expanded":j("endTrip"),"aria-controls":"endTrip-content",type:"button",children:[e.jsx("span",{className:"text-base sm:text-lg md:text-xl font-bold text-[#1d1d1e] truncate pr-2",children:i("aiContent.zapTripEnd","Our Tips and more !")}),e.jsx(z,{className:"ml-2 h-4 w-4 sm:h-5 sm:w-5 text-[#61936f] transition-transform duration-200 flex-shrink-0 "+(j("endTrip")?"rotate-180":""),"aria-hidden":"true"})]}),e.jsx("div",{id:"endTrip-content",className:"overflow-hidden transition-all duration-300 "+(j("endTrip")?"max-h-[5000px] opacity-100":"max-h-0 opacity-0"),"aria-hidden":!j("endTrip"),children:e.jsx(t,{className:"px-3 sm:px-4 md:px-6",children:e.jsx("article",{className:"prose prose-sm max-w-none text-[#030303] overflow-hidden",children:e.jsx(Z,{remarkPlugins:[B],components:g,children:x})})})})]})]})]}):e.jsx("div",{className:"mt-8",children:e.jsx(a,{className:"bg-[#fcfcfc] border-[#e5e5e5] shadow-lg",children:e.jsx(t,{children:e.jsx("article",{className:"prose prose-sm max-w-none text-[#030303]",children:e.jsx(Z,{remarkPlugins:[B],components:g,children:r})})})})})}function ee({notes:s,isEditing:r,onChange:l,label:n}){const{t:i}=b("trip"),c=n||i("details.notes");return e.jsx(a,{className:"mt-8",children:e.jsx(t,{className:"pt-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(E,{className:"w-5 h-5 text-muted-foreground mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-2",children:c}),r?e.jsx(o,{value:s||"",onChange:e=>l(e.target.value),placeholder:i("details.notesPlaceholder"),className:"min-h-[150px]"}):e.jsx("div",{className:"prose prose-sm max-w-none",children:s?e.jsx("p",{className:"whitespace-pre-wrap",children:s}):e.jsx("p",{className:"text-muted-foreground italic",children:i("details.noNotes")})})]})]})})})}function se({tripId:s,isDirectZapOut:r=!1,notes:l,isEditingNotes:n=!1,onNotesChange:i}){const{t:c}=b("trip"),d=V(),{useZapOutData:o}=q(),{data:x,isLoading:h,error:p}=o(s,{enabled:!!s,meta:{onError:e=>{"Not authenticated"===e.message?d("/login"):"Unauthorized"===e.message&&d("/dashboard")}}});return h?e.jsx(a,{children:e.jsxs(t,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:c("types.zapOut.details.title")}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(m,{className:"h-4 w-full"}),e.jsx(m,{className:"h-4 w-3/4"}),e.jsx(m,{className:"h-4 w-5/6"})]})]})}):p||!x?e.jsx(a,{children:e.jsxs(t,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:c("types.zapOut.details.title")}),e.jsx("p",{className:"text-muted-foreground",children:c("types.zapOut.details.noDataAvailable")})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(I,{zapOutData:x}),i&&e.jsx(ee,{notes:l,isEditing:n,onChange:i,label:c("types.zapOut.details.notes")})]})}function ae({tripId:r,isDirectZapRoad:l=!1,notes:n,isEditingNotes:i=!1,onNotesChange:c}){const[d,o]=s.useState(null),{t:m,i18n:p}=b("trip");if(s.useEffect((()=>{(async()=>{try{const{data:e,error:s}=await F.from("zaproad_data").select("*").eq("trip_id",r).single();if(s)throw s;o(e)}catch(e){}})()}),[r]),!d)return e.jsx("div",{children:"Loading..."});const u=e=>{try{const s=P(e);let a=R;if("fr"===p.language?a=A:"es"===p.language&&(a=M),W(s))return L(s,"PPP",{locale:a});const t=new Date(e);return W(t)?L(t,"PPP",{locale:a}):""}catch(s){return""}};return e.jsx("div",{className:"space-y-6",children:e.jsxs(a,{children:[e.jsx(x,{children:e.jsx(h,{children:m("types.zapRoad.roadTripDetails")})}),e.jsxs(t,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(y,{className:"w-5 h-5 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:m("types.zapRoad.route")}),e.jsxs("p",{className:"text-sm text-gray-600",children:["From ",d.starting_city," to ",d.end_city,d.stopover_cities&&JSON.parse(d.stopover_cities).length>0&&e.jsxs("span",{children:[" via ",JSON.parse(d.stopover_cities).map((e=>e.name)).join(", ")]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(_,{className:"w-5 h-5 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:m("types.zapRoad.numberOfPeople")}),e.jsx("p",{className:"text-sm text-gray-600",children:d.number_of_people})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(k,{className:"w-5 h-5 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:m("types.zapRoad.vehicleType")}),e.jsx("p",{className:"text-sm text-gray-600",children:d.has_electric_car?m("types.zapRoad.electricCar"):m("types.zapRoad.regularCar")})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(v,{className:"w-5 h-5 text-gray-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:m("types.zapRoad.dates")}),e.jsxs("p",{className:"text-sm text-gray-600",children:[u(d.start_date)," - ",u(d.end_date)]})]})]}),d.special_requirements&&e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:m("types.zapRoad.specialRequirements")}),e.jsx("p",{className:"text-sm text-gray-600",children:d.special_requirements})]})]})]})})}function te({location:r}){const{t:l}=b("recommendations"),[n,i]=s.useState([]),[c,d]=s.useState([]),[o,m]=s.useState(0),[x,h]=s.useState(!0),[g,N]=s.useState(null),[v,y]=s.useState("all"),[w,T]=s.useState(["all"]),[k,C]=s.useState(null),[z,E]=s.useState(!1),[_,$]=s.useState((()=>{const e=window.innerWidth;return e>=1024?"lg":e>=768?"md":"sm"})),O="lg"===_?3:"md"===_?2:1;s.useEffect((()=>{const e=()=>{const e=window.innerWidth,s=e>=1024?"lg":e>=768?"md":"sm";s!==_&&($(s),m(0))};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[_]),s.useEffect((()=>{R()}),[r]),s.useEffect((()=>{P()}),[v,n]),s.useEffect((()=>{const e=new Set(["all"]);n.forEach((s=>{s.type&&e.add(s.type.toLowerCase())})),T(Array.from(e))}),[n]);const P=()=>{d("all"===v?n:n.filter((e=>e.type.toLowerCase()===v.toLowerCase()))),m(0)},R=async()=>{try{h(!0),N(null);const{data:e,error:s}=await F.from("event_suggestion").select("*").eq("location",r).order("priority",{ascending:!0});if(s)throw s;const a=e.reduce(((e,s)=>{const a=e.get(s.priority)||[];return a.push(s),e.set(s.priority,a),e}),new Map),t=[];a.forEach((e=>{for(let s=e.length-1;s>0;s--){const a=Math.floor(Math.random()*(s+1));[e[s],e[a]]=[e[a],e[s]]}t.push(...e)})),i(t),d(t),m(0)}catch(e){N(l("errors.fetchFailed"))}finally{h(!1)}},A=e=>{switch(e.toLowerCase()){case"hotel":return"bg-blue-100 text-blue-800";case"restaurant":return"bg-orange-100 text-orange-800";case"bar":return"bg-purple-100 text-purple-800";case"event":return"bg-green-100 text-green-800";case"activity":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},M=[...w];return x?e.jsx(a,{children:e.jsx(t,{className:"p-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[1,2,3].map((s=>e.jsxs("div",{className:"animate-pulse "+(2===s&&"sm"===_||3===s&&"lg"!==_?"hidden":2===s?"hidden md:block":""),children:[e.jsx("div",{className:"h-48 bg-gray-200 rounded-lg mb-4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"})]},s)))})})}):g?e.jsx(a,{children:e.jsx(t,{className:"p-6",children:e.jsx("div",{className:"text-red-500",children:g})})}):0===n.length?null:e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[e.jsx("div",{className:"p-4",children:e.jsx("h2",{className:"text-xl font-bold text-[#030303]",children:l("zaparound.recommendations")})}),e.jsx("div",{className:"p-4",children:e.jsx(a,{children:e.jsxs(t,{className:"p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4"}),w.length>0&&e.jsx("div",{className:"flex gap-2 mb-4",children:M.map((s=>e.jsx("button",{onClick:()=>y(s),className:"px-3 py-1 rounded-full text-xs font-medium transition-colors "+(v===s?"bg-[#1d1d1e] text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:l("all"===s?"types.all":`types.${s}`)},s)))}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:J("grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 transition-transform duration-300 ease-in-out"),style:{transform:`translateX(-${o*(100/O)}%)`},children:c.slice(o*O,(o+1)*O).map((s=>{return e.jsxs("div",{className:"relative group cursor-pointer w-full",onClick:()=>C(s),children:[e.jsx("div",{className:"aspect-[16/10] overflow-hidden rounded-lg",children:e.jsx("img",{src:s.url_placeholder_image||s.image_url,alt:s.title,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-110",onError:e=>{e.target.src="/placeholder-image.jpg"}})}),e.jsxs("div",{className:"mt-2",children:[e.jsx("h3",{className:"font-semibold text-lg",children:s.title}),e.jsx("p",{className:"text-sm text-gray-600",children:s.business_name}),e.jsx("div",{className:"flex items-center gap-2 mt-1",children:e.jsx("span",{className:`inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${A(s.type)}`,children:(a=s.type,a.charAt(0).toUpperCase()+a.slice(1).toLowerCase())})})]})]},s.id);var a}))}),c.length>O&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>{z||0===o||(E(!0),m((e=>e-1)),setTimeout((()=>E(!1)),300))},disabled:z||0===o,className:"absolute left-0 top-1/2 -translate-y-1/2 -translate-x-4 bg-white/80 backdrop-blur-sm p-2 rounded-full shadow-lg hover:bg-white disabled:opacity-50 disabled:cursor-not-allowed z-10",children:e.jsx(S,{className:"h-6 w-6"})}),e.jsx("button",{onClick:()=>{z||o>=Math.ceil(c.length/O)-1||(E(!0),m((e=>e+1)),setTimeout((()=>E(!1)),300))},disabled:z||o>=Math.ceil(c.length/O)-1,className:"absolute right-0 top-1/2 -translate-y-1/2 translate-x-4 bg-white/80 backdrop-blur-sm p-2 rounded-full shadow-lg hover:bg-white disabled:opacity-50 disabled:cursor-not-allowed z-10",children:e.jsx(D,{className:"h-6 w-6"})})]})]})]})})})]}),e.jsx(p,{open:!!k,onOpenChange:e=>!e&&C(null),children:e.jsxs(u,{className:"sm:max-w-2xl",children:[e.jsx(f,{children:e.jsx(j,{children:k?.title})}),e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"aspect-[16/10] overflow-hidden rounded-lg mb-4",children:e.jsx("img",{src:k?.url_placeholder_image||k?.image_url,alt:k?.title,className:"w-full h-full object-cover",onError:e=>{e.target.src="/placeholder-image.jpg"}})}),e.jsxs("p",{className:"text-gray-600 mb-2",children:[k?.business_name," • ",k?.location]}),e.jsx("p",{className:"text-gray-800",children:k?.content||k?.description}),k?.url_link&&e.jsxs("a",{href:k.url_link,target:"_blank",rel:"noopener noreferrer",className:"inline-block mt-4 text-blue-600 hover:text-blue-800",children:[l("learnMore")," →"]})]})]})})]})}function re({city:r,coordinates:l}){const{t:n}=b("trip"),[i,c]=s.useState([]),[d,o]=s.useState(!0),[m,x]=s.useState(null);s.useEffect((()=>{h()}),[r,l]);const h=async()=>{try{o(!0),x(null);const{data:e,error:s}=await F.functions.invoke("events-api-search",{body:{city:r,...l&&{latitude:l[1],longitude:l[0]}}});if(s)throw s;c(e.events||[])}catch(e){if(e instanceof Error&&e.message.includes("429"))return null;x(n("errors.fetchFailed"))}finally{o(!1)}};return d?e.jsx(a,{children:e.jsx(t,{className:"p-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[1,2,3].map((s=>e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-48 bg-gray-200 rounded-lg mb-4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]},s)))})})}):m?e.jsx(a,{children:e.jsx(t,{className:"p-6",children:e.jsx("div",{className:"text-red-500",children:m})})}):0===i.length?null:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[e.jsx("div",{className:"p-4",children:e.jsx("h2",{className:"text-xl font-bold text-[#030303]",children:n("events.nearbyEvents")})}),e.jsx("div",{className:"p-4",children:e.jsx(Y,{events:i,isLoading:d,loadingText:n("events.loading"),noEventsText:n("events.noEvents")})})]})}const le=({open:a,onOpenChange:t,shareUrl:r})=>{const{t:l}=b("trip"),[n,i]=s.useState(!1);return e.jsx(p,{open:a,onOpenChange:t,children:e.jsxs(u,{className:"max-w-md bg-[#fcfcfc] text-[#030303]",children:[e.jsxs(f,{children:[e.jsx(j,{className:"text-[#1d1d1e]",children:l("share.modalTitle")}),e.jsx(g,{className:"mb-4 text-[#62626a]",children:l("share.modalDescription")})]}),e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("img",{src:"https://media1.giphy.com/media/v1.Y2lkPTc5MGI3NjExYTB2emJubXp6NXliZHByeTJzcDZ3ODRremM4eWVmdWhycGliN2gwcSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/as1VjJtNpvD7kxbuBM/giphy.gif",alt:l("share.imageAlt"),className:"w-32 h-32 object-contain",style:{background:"#61936f",borderRadius:"1rem"}})}),e.jsx("div",{className:"mb-2",children:e.jsxs(N,{type:"button",size:"lg",variant:"outline",className:"w-full border-[#61936f] text-[#61936f] hover:bg-[#e6f4ec] flex items-center justify-center",onClick:async()=>{try{await navigator.clipboard.writeText(r),i(!0),setTimeout((()=>i(!1)),2e3)}catch{i(!1)}},"aria-label":l("share.copyButton"),children:[n?e.jsx($,{className:"w-5 h-5 mr-2"}):e.jsx(O,{className:"w-5 h-5 mr-2"}),l(n?"share.copied":"share.copyButton")]})})]})})};export{te as E,re as T,se as a,ae as b,U as c,X as d,Q as e,le as f,K as g};
//# sourceMappingURL=components-trip-details.pqq_6ZMJ.js.map
