import{s as t}from"../components/components-admin.CiIAoamg.js";import{p as e,s as a}from"./utils-webhook.ts.CrLxl67R.js";async function o(o,i,r){let s=r;if(!r||0===Object.keys(r).length)try{const{data:e,error:a}=await t.from("profiles").select("*").eq("id",i.id).single();!a&&e&&(s=e)}catch(p){}s={...s,email:i.email};const n={user_id:i.id,title:o.title,description:o.description,location:o.location,coordinates:JSON.stringify(o.coordinates),start_date:o.startDate?.toISOString(),end_date:o.endDate?.toISOString(),category:o.category,budget:parseFloat(o.budget),currency:o.currency||"USD",transportation_details:{mode:o.transportationMode,details:o.transportationDetails},accommodation_details:{type:o.accommodationType,details:o.accommodationDetails},notes:o.notes||"",adults:o.adults,kids:o.kids,trip_type:o.tripType,profile_data:s,interests:o.interests||[],has_pets:o.hasPets||!1,departure_location:o.departureLocation||"",departure_coordinates:o.departureCoordinates?JSON.stringify(o.departureCoordinates):null},{data:d,error:c}=await t.from("trips").insert(n).select();if(c)throw c;if(d&&d.length>0){const t=e({...d[0],email:i.email,trip_type:"zaptrip"});await a(t)}return d}export{o as c};
//# sourceMappingURL=utils-tripcreation.ts.VnA1EOFJ.js.map
