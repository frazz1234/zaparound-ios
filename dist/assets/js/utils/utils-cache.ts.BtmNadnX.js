import{L as e}from"../vendor/vendor--lru-cache.CYB7PIxo.js";new e({max:500,ttl:3e5,updateAgeOnGet:!0});const t=new e({max:100,ttl:9e5,updateAgeOnGet:!0}),a=new e({max:200,ttl:18e5,updateAgeOnGet:!0}),s=new e({max:300,ttl:6e5,updateAgeOnGet:!0}),r=new e({max:50,ttl:12e4,updateAgeOnGet:!0});const i=new class{listeners=new Map;subscribe(e,t){return this.listeners.has(e)||this.listeners.set(e,new Set),this.listeners.get(e).add(t),()=>{const a=this.listeners.get(e);a&&(a.delete(t),0===a.size&&this.listeners.delete(e))}}emit(e){const t=this.listeners.get(e);t&&t.forEach((e=>{try{e()}catch(t){}}))}},n={TRIP_CREATED:"trip_created",TRIP_UPDATED:"trip_updated",TRIP_DELETED:"trip_deleted",FAVORITE_ADDED:"favorite_added",FAVORITE_REMOVED:"favorite_removed",FAVORITE_UPDATED:"favorite_updated",MAP_DATA_INVALIDATED:"map_data_invalidated",CHECKPOINTS_INVALIDATED:"checkpoints_invalidated",FAVORITES_INVALIDATED:"favorites_invalidated",HOMEPAGE_TRIP_CREATION_STARTED:"homepage_trip_creation_started",HOMEPAGE_TRIP_CREATION_COMPLETED:"homepage_trip_creation_completed"};async function o(e,t,a,s={}){const{force:r=!1,ttl:i}=s;if(!r){const a=e.get(t);if(void 0!==a)return a}const n=await a();return e.set(t,n,{ttl:i}),n}const c=async e=>{try{[`map-data-${e}`,`trips-${e}`].forEach((e=>{s.delete(e)}));Array.from(s.keys()).forEach((e=>{e.includes("-checkpoints-")&&s.delete(e)})),i.emit(n.TRIP_CREATED),i.emit(n.MAP_DATA_INVALIDATED),i.emit(n.CHECKPOINTS_INVALIDATED)}catch(t){}},A=async e=>{try{[`map-data-${e}`,`favorites-${e}`].forEach((e=>{s.delete(e)})),i.emit(n.FAVORITES_INVALIDATED),i.emit(n.MAP_DATA_INVALIDATED)}catch(t){}},E=(e,t)=>{const a=`homepage-create-trip-${e}`,s={...t,timestamp:Date.now(),userId:e};return r.set(a,s),i.emit(n.HOMEPAGE_TRIP_CREATION_STARTED),a},_=e=>{const t=`homepage-create-trip-${e}`,a=r.has(t);return r.delete(t),a&&i.emit(n.HOMEPAGE_TRIP_CREATION_COMPLETED),a},d=e=>{const t=`homepage-create-trip-${e}`,a=r.has(t);let s=!1;try{const t=sessionStorage.getItem("homepage-create-trip-temp");if(s=!!t,s&&!1===a){const a=JSON.parse(t);return E(e,{...a,transferredFromTemp:!0}),sessionStorage.removeItem("homepage-create-trip-temp"),!0}}catch(i){}return a||s};export{n as C,A as a,a as b,i as c,o as g,d as h,c as i,_ as r,E as s,s as t,t as u};
//# sourceMappingURL=utils-cache.ts.BtmNadnX.js.map
